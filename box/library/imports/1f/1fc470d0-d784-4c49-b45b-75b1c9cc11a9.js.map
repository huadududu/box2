{"version":3,"sources":["../../../../../assets/src/controller/assets/src/controller/GameMenuController.js"],"names":["GameMenuView","require","UIBottomFactory","AcceleratorConfig","ToolConfig","EfficiencyConfig","LevelConfig","ParticleSystemCenter","SkeletonDataCenter","Global","cc","Class","extends","Component","properties","node","Node","bottomlist","scrollView","ScrollView","level","Label","gold","gem","TopProgressBar","ProgressBar","radioButton","default","type","Toggle","levelupBtn","Button","thisCheck","visible","BoxController","onLoad","config","itemList","addUIBottom","undefined","startpos","width","i","length","j","create","eventcallback","bind","position","p","addChild","push","initInfo","setGoldNum","setLevel","setGem","hard","exp","setProgress","num","string","value","pro","progress","interactable","changeHammerSpine","data","updateDate","name","updateButtom","scrollEvent","sender","event","thispos","getScrollOffset","num1","num2","x","setCheckToggle","radioButtonClicked","toggle","index","indexOf","scrollToOffset","isChecked","onClickLevel","upgradView","active","addlevel","myinfo","needexp","needgold","rewardcoin","saveLevel","saveExp","saveGold","id","getComponent","setBtnState"],"mappings":"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","file":"GameMenuController.js","sourceRoot":"../../../../../assets/src/controller","sourcesContent":["/*\n * Created by Ren on 2018/6/6.\n */\nlet GameMenuView = require('GameMenuView');\nlet UIBottomFactory = require(\"UIBottomFactory\");\nlet AcceleratorConfig = require(\"AcceleratorConfig\");\nlet ToolConfig = require(\"ToolConfig\");\nlet EfficiencyConfig = require(\"EfficiencyConfig\");\nlet LevelConfig = require(\"LevelConfig\");\nlet ParticleSystemCenter = require(\"ParticleSystemCenter\");\nlet SkeletonDataCenter = require(\"SkeletonDataCenter\");\nlet Global = require('Global');\n\ncc.Class({\n    extends:cc.Component,\n    properties:{\n        node:cc.Node,\n        bottomlist:cc.Node,\n        scrollView: cc.ScrollView,\n        level: cc.Label,\n        gold:cc.Label,\n        gem:cc.Label,\n        TopProgressBar:cc.ProgressBar,\n        radioButton:{\n            default:[],\n            type:cc.Toggle\n        },\n        levelupBtn:cc.Button,\n        thisCheck:{\n            visible:false,\n            default:0\n        },\n\n        BoxController: require(\"BoxController\")\n\n    },\n    onLoad:function(){\n\n        this.config=[AcceleratorConfig,ToolConfig,EfficiencyConfig];\n        this.itemList=[];\n    },\n    addUIBottom:function(){\n        if(this.config == undefined)\n        {\n            this.config=[AcceleratorConfig,ToolConfig,EfficiencyConfig];\n        }\n        this.itemList=[];\n        let startpos = -this.bottomlist.width/2;\n        for(var i = 0;i < this.config.length;i++){\n            for(var j = 1; this.config[i][j] != undefined;j++){\n                let node = UIBottomFactory.create(i,this.config[i][j],this.eventcallback.bind(this));\n                node.position = cc.p(startpos+75,0);\n                this.bottomlist.addChild(node);\n                this.itemList.push(node);\n                startpos+=156;\n            }\n        }\n    },\n    initInfo:function() {\n        this.setGoldNum(Global.gold);\n        this.setLevel(Global.level);\n        this.setGem(Global.gem);\n        let hard = Global.hard;\n\n        let exp = LevelConfig[Global.level].exp;\n        this.setProgress(Global.exp/exp);\n\n    },\n    //设置金币\n    setGoldNum: function (num) {\n        this.gold.string = num;\n    },\n    setLevel: function (level) {\n        this.level.string = \"level:\"+level;\n    },\n    setGem: function (value){\n        this.gem.string = value;\n    },\n    setProgress: function (value){\n        let pro = this.TopProgressBar.progress;\n        if (pro  == 1.0 && value ==1)\n            return;\n        this.levelupBtn.interactable = value>=1;\n        this.TopProgressBar.progress = value;\n    },\n\n    changeHammerSpine:function(data){\n        this.BoxController.changeHammerSpine(data);\n    },\n    updateDate:function (data){\n        for( var name in data) {\n            if (name == 'exp') {\n                let exp = LevelConfig[Global.level].exp;\n                let pro = data.exp / exp;\n                if (pro > 1)\n                    pro = 1;\n\n                this.setProgress(pro);\n            }\n            if (name == \"level\") {\n\n                this.setLevel(data.level);\n            }\n            if (name == \"gold\") {\n                this.setGoldNum(data.gold);\n            }\n        }\n        if (name == \"level\" || name == \"gold\" ){\n            this.updateButtom();\n        }\n    },\n    scrollEvent: function(sender, event) {\n        let thispos= sender.getScrollOffset();\n        // switch(event) {\n        //     case 2: //left\n        //        // this.lblScrollEvent.string = \"Scroll to Left\";\n        //        break;\n        //     case 3: ////right\n        //        // this.lblScrollEvent.string = \"Scroll to Right\"; \n        //        break;\n        //    }\n        let num1= 2*156;\n        let num2 = 8*156;\n        if(-thispos.x <num1){\n            this.setCheckToggle(0);\n        }else if(-thispos.x < num2){\n            this.setCheckToggle(1);\n\n        }else{\n            this.setCheckToggle(2);\n        }\n    },\n\n    radioButtonClicked: function(toggle) {\n        var index = this.radioButton.indexOf(toggle);\n        // var title = \"RadioButton\";\n        switch(index) {\n            case 0:\n                // title += \"1\";\n                this.scrollView.scrollToOffset(cc.p(0 , 0), 0.2);\n                break;\n            case 1:\n                let num1= 2*156;\n                this.scrollView.scrollToOffset(cc.p( num1, 0), 0.2);\n                // title += \"2\";\n                break;\n            case 2:\n                let num2= 8*156;\n                this.scrollView.scrollToOffset(cc.p( num2, 0), 0.2);\n                // title += \"3\";\n                break;\n            default:\n                break;\n        }\n    },\n\n    setCheckToggle: function(num) {\n        if( this.thisCheck == num )\n            return;\n        this.thisCheck= num;\n        for( let i=0;i < this.radioButton.length;i++)\n        {\n            if(i == num){\n                this.radioButton[i].isChecked = true;\n            }\n            else{\n                this.radioButton[i].isChecked = false;\n            }\n        }\n    },\n\n\n    //点击升级按钮\n    onClickLevel:function(){\n        if(this.TopProgressBar.progress >=1){\n            this.BoxController.upgradView.active = true;\n        }\n    },\n    addlevel:function(){\n            let myinfo ={};\n            let level =Global.level+1;\n            let needexp = LevelConfig[ level].exp;\n            let needgold = LevelConfig[ level].rewardcoin;\n            myinfo.level = level;\n            Global.saveLevel( level);\n            myinfo.exp =Global.exp-needexp;\n            Global.saveExp( myinfo.exp);\n            myinfo.gold = Global.gold+needgold;\n            Global.saveGold(myinfo.gold);\n            this.updateDate(myinfo);\n\n    },\n    eventcallback: function(type, id) {\n\n        this.BoxController.eventcallback(type,id);\n\n\n    },\n    updateButtom:function(){\n        for(let i=0;i<this.itemList.length;i++){\n            let node = this.itemList[i].getComponent(\"UIBottom\");\n            node.setBtnState();\n        }\n    }\n});"]}