{"version":3,"sources":["../../../../../assets/src/controller/assets/src/controller/BoxController.js"],"names":["StageConfig","require","BlockConfig","CycleConfig","ToolConfig","AttributeConfig","AcceleratorConfig","EfficiencyConfig","BoxConfig","RewardConfig","GameType","GameUtils","GameState","BlockBigFactory","BlockSmallFactory","RewardItemFactory","UILeadFactory","SpriteFrameCenter","ParticleSystemCenter","SkeletonDataCenter","GameConfig","Global","GameHeight","GameCenterY","BaseGame","cc","Class","extends","Component","properties","gameNode","Node","camera","Camera","BlockBig","Prefab","BlockSmall","MarginsBig","MarginsSmall","RewardItem","UIBottom","uilead","inviteUI","inviteItem","Sky","Bgbz","Underground","motionStreak","MotionStreak","boxSpine","sp","Skeleton","btnbox","Button","GameMenu","treasure","upgradView","openbox","type","visible","default","blockWidth","blockBlank","moveNum","margins","curMaxLine","canTouch","previousPt","Hatting","HattingPos","accelerHammer","accelerGold","efficeGold","startClock","gameState","init","onLoad","winsize","winSize","BaseHeight","height","BaseWidth","width","hammerStart","hammerEnd","boxLeadNode","rowNum","startCameraY","blockLeadNode","blockPosNode","preLoadAtlas","initdata","bind","GameMenuController","find","getComponent","initInfo","blocks","marginlist","hammers","rewardItem","startPos","setCompleteListener","animationName1","trackEntry","animation","name","log","trackIndex","addItems","firstblock","firstOpen","start","timescale","hammer","initEfficienyInfo","i","undefined","node","nodehammer","addComponent","info","addSkeletonData","addChild","id","active","j","animationName","checkCanHammer","smCallback","attribute","conf1","timeScale","att","parseFloat","time","update","restart","hard","saveHard","deleteBoxLead","destroy","hatting","floorNum","layer","length","blockwidth","size","count","blank","addBlocks","cameraStartPosY","changeBlockLead","playHammers","initTreasure","addUIBottom","playHammerSpine","hammerpos","setAnimation","setSmPosition","stopHammerSpine","addHammer","conf","changeHammerSpine","data","skeletonData","startLine","x","startRow","y","position","console","realwidth","maxline","maxrow","totoalRowNum","range","geScreenRange","line","canclick","curline","checkCanDestroy","push","num","randomInt","row","location","getEffByBlock","getPngId","max","cameraPosY","getPositionY","min","maxPosY","canshowy","Math","floor","cameraY","gameY","realx","realy","hamX","hamY","p","isValid","destroyBlock","resetMarginList","resetBlockList","lineinfo","addLines","getPngName","cycleID","topline","top","pngname","thisNum","factory","curX","curY","lineArray","left","createMargins","right","endpos","create","thisID","indexOf","cycleArry","split","getnum","parseInt","neednumber","texiao","addParticleForNode","removeFromParent","destroyUpdate","cameraCentPosY","bool","myinfo","exp","gold","updateDate","saveExp","saveGold","maxLineNum","move","oldY","newY","moveY","action1","moveTo","runAction","ralmovelength","action2","posbottom","totoal","skyposy","bzYbottom","other","movePos","setPositionY","playBoxSpine","stopBoxSpine","BoxID","box","BoxConf","normalSprite","getFrameFromAtlas","icon","pressedSprite","hoverSprite","disabledSprite","addSkeletonDataWait","boxID","rewardID","reward","itemdata","random","z","gem","str","rewardarry","createRewardItem","golds","gems","saveGem","locationX","locationY","action","callFunc","setFinish","sequence","onClickTreasure","event","maxlinenum","touchEndPoint","getLocation","updateTouch","end","addBoxLead","ratation","point","touchStartCallBack","location1","touchState","convertToNodeSpace","setPositionX","reset","touchCancelCallBack","isTouching","touchEndCallBack","touchMoveCallBack","multMoveCallBack","location01","location02","distance","pSub","origin","eventcallback","string","isFBInstantGame","FBP","self","RewardedVideoAsync","accleleratorChange","updateButtom","accleleratorrRecover","toolChange","efficiencyAdd","changeHammerSpeed","speedHammer","speedGold","speed","coin","changeGoldSpeed","checkCanAdd","saveHammer","addAdTime","mess","costtype","cost","next","confArry","unlock","openAdTimes","needlvl","level","inviteFriends","addFriendCallBack","friendId","freindsInfo","FBP1","chooseAsync","friendID","oldFriend","efficiencyChange","addgold","timestamp","Date","parse","efficiency","jumptime","attr","btnType","skipID","saveEfficiency","nowtime","paseTime","timestart","useTime","timeleft","outlineTime","offlinetime","addeff","onClickBtnaddGem","onClickBtnsubGem","onClickBtnaddGold","onClickBtnsubGold","onClickBtnaddExp"],"mappings":";;;;;;AAAA;;;;AAIA;AACA,IAAIA,cAAcC,QAAQ,aAAR,CAAlB;AACA,IAAIC,cAAcD,QAAQ,YAAR,CAAlB;AACA,IAAIE,cAAcF,QAAQ,aAAR,CAAlB;AACA,IAAIG,aAAaH,QAAQ,YAAR,CAAjB;AACA,IAAII,kBAAkBJ,QAAQ,iBAAR,CAAtB;AACA,IAAIK,oBAAoBL,QAAQ,mBAAR,CAAxB;AACA,IAAIM,mBAAmBN,QAAQ,kBAAR,CAAvB;AACA,IAAIO,YAAYP,QAAQ,WAAR,CAAhB;AACA,IAAIQ,eAAeR,QAAQ,cAAR,CAAnB;;AAGA,IAAIS,WAAWT,QAAQ,UAAR,CAAf;AACA,IAAIU,YAAYV,QAAQ,WAAR,CAAhB;AACA,IAAIW,YAAYX,QAAQ,WAAR,CAAhB;AACA,IAAIY,kBAAkBZ,QAAQ,iBAAR,CAAtB;AACA,IAAIa,oBAAoBb,QAAQ,mBAAR,CAAxB;AACA,IAAIc,oBAAoBd,QAAQ,mBAAR,CAAxB;AACA,IAAIe,gBAAgBf,QAAQ,eAAR,CAApB;;AAEA,IAAIgB,oBAAoBhB,QAAQ,mBAAR,CAAxB;AACA,IAAIiB,uBAAuBjB,QAAQ,sBAAR,CAA3B;AACA,IAAIkB,qBAAqBlB,QAAQ,oBAAR,CAAzB;AACA,IAAImB,aAAanB,QAAQ,YAAR,CAAjB;AACA;;AAEA,IAAIoB,SAASpB,QAAQ,QAAR,CAAb;;AAEA,IAAMqB,aAAa,GAAnB;AACA,IAAMC,cAAc,CAApB;AACA,IAAMC,WAAWF,aAAW,CAA5B;;AAEAG,GAAGC,KAAH,CAAS;AACLC,aAASF,GAAGG,SADP;;AAGLC,gBAAY;AACRC,kBAAUL,GAAGM,IADL;AAERC,gBAAQP,GAAGQ,MAFH;AAGRC,kBAAUT,GAAGU,MAHL;AAIRC,oBAAYX,GAAGU,MAJP;AAKRE,oBAAYZ,GAAGU,MALP;AAMRG,sBAAcb,GAAGU,MANT;AAORI,oBAAYd,GAAGU,MAPP;AAQRK,kBAAUf,GAAGU,MARL;AASRM,gBAAQhB,GAAGU,MATH;AAURO,kBAASjB,GAAGU,MAVJ;AAWRQ,oBAAWlB,GAAGU,MAXN;AAYRS,aAAKnB,GAAGM,IAZA;AAaRc,cAAMpB,GAAGM,IAbD;AAcRe,qBAAarB,GAAGM,IAdR;AAeRgB,sBAActB,GAAGuB,YAfT;AAgBR;AACAC,kBAAUC,GAAGC,QAjBL;AAkBRC,gBAAQ3B,GAAG4B,MAlBH;AAmBRC,kBAAU7B,GAAGM,IAnBL;AAoBRwB,kBAAU9B,GAAG4B,MApBL;AAqBRG,oBAAY/B,GAAGM,IArBP;AAsBR0B,iBAAShC,GAAGM,IAtBJ;AAuBR2B,cAAM;AACFC,qBAAS,KADP;AAEFC,qBAAS;AAFP,SAvBE;AA2BRC,oBAAY,GA3BJ;AA4BRC,oBAAY;AACRH,qBAAS,KADD;AAERC,qBAAS;AAFD,SA5BJ;AAgCRG,iBAAS;AACLJ,qBAAS,KADJ;AAELC,qBAAS;AAFJ,SAhCD;AAoCRI,iBAAS;AACLL,qBAAS,KADJ;AAELC,qBAAS;AAFJ,SApCD;AAwCRK,oBAAY;AACRN,qBAAS,KADD;AAERC,qBAAS;AAFD,SAxCJ;AA4CRM,kBAAU;AACNP,qBAAS,KADH;AAENC,qBAAS;AAFH,SA5CF;AAgDRO,oBAAY;AACRR,qBAAS,KADD;AAERC,qBAAS;AAFD,SAhDJ;AAoDRQ,iBAAS;AACLT,qBAAS,KADJ;AAELC,qBAAS;AAFJ,SApDD;AAwDRS,oBAAY;AACRV,qBAAS,KADD;AAERC,qBAAS;AAFD,SAxDJ;AA4DRU,uBAAe;AACXX,qBAAS,KADE;AAEXC,qBAAS;AAFE,SA5DP;AAgERW,qBAAa;AACTZ,qBAAS,KADA;AAETC,qBAAS;AAFA,SAhEL;AAoERY,oBAAY,CApEJ;AAqERC,oBAAW,CArEH;AAsERC,mBAAW9D,UAAU+D,IAtEb,CAsEkB;AAtElB,KAHP;;AA6ELC,YAAQ,kBAAY;AAAA;;AAChB,aAAKC,OAAL,GAAepD,GAAGqD,OAAlB;AACA,aAAKC,UAAL,GAAkB,KAAKF,OAAL,CAAaG,MAAb,GAAsB,CAAxC;AACA,aAAKC,SAAL,GAAiB,KAAKJ,OAAL,CAAaK,KAAb,GAAqB,CAAtC;AACA,aAAKC,WAAL,GAAmB,CAAnB,CAJgB,CAIK;AACrB,aAAKC,SAAL,GAAiB,EAAjB,CALgB,CAKI;AACpB,aAAKC,WAAL,GAAmB,IAAnB,CANgB,CAMQ;AACxB,aAAKC,MAAL,GAAc,CAAd;AACA,aAAKC,YAAL,GAAkB,CAAlB;AACA,aAAKC,aAAL,GAAqB,IAArB;AACA,aAAKC,YAAL,GAAoB,IAApB;;AAEAxE,0BAAkByE,YAAlB,CAA+B,SAA/B,EAA0C,KAAKC,QAAL,CAAcC,IAAd,CAAmB,IAAnB,CAA1C;AACA,aAAKC,kBAAL,GAA0BpE,GAAGqE,IAAH,CAAQ,iBAAR,EAA2BC,YAA3B,CAAwC,oBAAxC,CAA1B;AACA1E,eAAO2E,QAAP;AACA,aAAKC,MAAL,GAAc,EAAd;AACA,aAAKC,UAAL,GAAkB,EAAlB;AACA,aAAKC,OAAL,GAAe,EAAf;AACA,aAAKC,UAAL,GAAkB,EAAlB;AACA,aAAK9B,aAAL,GAAqB,CAArB;AACA,aAAKC,WAAL,GAAmB,CAAnB;AACA,aAAK8B,QAAL,GAAgB,CAAC/E,UAAD,GAAc,CAA9B;AACA,aAAK2B,QAAL,CAAcqD,mBAAd,CAAkC,sBAAc;AAC5C,gBAAIC,iBAAiBC,WAAWC,SAAX,GAAuBD,WAAWC,SAAX,CAAqBC,IAA5C,GAAmD,EAAxE;AACAjF,eAAGkF,GAAH,CAAO,2CAAP,EAAoDH,WAAWI,UAA/D,EAA2EL,cAA3E;AACA;AACA,kBAAKM,QAAL;AAEH,SAND;AAOA,aAAKC,UAAL,GAAiB,IAAjB;AACA,aAAKC,SAAL,GAAiB,IAAjB;AACH,KA5GI;AA6GLC,WAAO,iBAAY;AAAA;;AACf,aAAKnB,kBAAL,CAAwBG,QAAxB;AACA,aAAKG,OAAL,GAAe,EAAf;AACA,YAAIc,YAAY,CAAhB;AACA,YAAIC,SAAS7F,OAAO6F,MAApB;AACA,aAAKC,iBAAL,GALe,CAKU;;AALV;AAOX,gBAAID,OAAOE,CAAP,KAAaC,SAAjB,EACI;AACJ,gBAAIC,OAAO,IAAI7F,GAAGM,IAAP,EAAX;AACA,gBAAIwF,aAAaD,KAAKE,YAAL,CAAkBtE,GAAGC,QAArB,CAAjB;AACA,gBAAIsE,OAAOrH,WAAWgH,CAAX,CAAX;AACA,gBAAIX,YAAYgB,KAAKhB,SAArB;AACAtF,+BAAmBuG,eAAnB,CAAmCjB,SAAnC,EAA8Cc,UAA9C;AACA,mBAAKjE,QAAL,CAAcqE,QAAd,CAAuBL,IAAvB;AACA,mBAAKnB,OAAL,CAAae,OAAOE,CAAP,EAAUQ,EAAvB,IAA6BL,UAA7B;AACAA,uBAAWD,IAAX,CAAgBO,MAAhB,GAAyB,KAAzB;AACA,gBAAIC,IAAEV,CAAN;AACAG,uBAAWjB,mBAAX,CAA+B,sBAAc;AACzC,oBAAIyB,gBAAgBvB,WAAWC,SAAX,GAAuBD,WAAWC,SAAX,CAAqBC,IAA5C,GAAmD,EAAvE;AACAjF,mBAAGkF,GAAH,CAAO,2CAAP,EAAoDH,WAAWI,UAA/D,EAA2EmB,aAA3E;AACAR,2BAAWD,IAAX,CAAgBO,MAAhB,GAAyB,KAAzB;AACA,oBAAI,OAAKG,cAAL,CAAoBF,CAApB,CAAJ,EAA4B;AACxB,2BAAKG,UAAL,CAAgBH,CAAhB;AACH;AACJ,aAPD;AAQA,gBAAII,YAAY7G,OAAO6F,MAAP,CAAcE,CAAd,EAAiBc,SAAjC;AACA,gBAAIC,QAAQ9H,gBAAgB6H,SAAhB,CAAZ;AACAX,uBAAWa,SAAX,GAAuB,OAAOD,MAAME,GAAb,GAAmBC,WAAWH,MAAMI,IAAjB,CAAnB,GAA4C,OAAKjE,aAAxE;AA5BW;;AAMf,aAAK,IAAI8C,IAAI,KAAKjC,WAAlB,EAA+BiC,KAAK,KAAKhC,SAAzC,EAAoDgC,GAApD,EAAyD;AAAA;;AAAA,qCAEjD;AAqBP;AAEJ,KA5II;AA6ILoB,YAAQ,kBAAY;AAChB;AACH,KA/II;AAgJLC,aAAS,mBAAY;;AAEjB,YAAIzI,YAAYqB,OAAOqH,IAAP,GAAY,CAAxB,KAA8B,IAA9B,IAAsC1I,YAAYqB,OAAOqH,IAAP,GAAY,CAAxB,KAA8BrB,SAAxE,EAAmF;AAC/EhG,mBAAOqH,IAAP;AACArH,mBAAOsH,QAAP,CAAgBtH,OAAOqH,IAAvB;AACH;AACD,aAAKE,aAAL;AACA,aAAK3F,QAAL,CAAcqE,IAAd,CAAmBO,MAAnB,GAA4B,KAA5B;AACA,aAAK,IAAIT,IAAI,CAAb,EAAgBA,IAAI,CAApB,EAAuBA,GAAvB,EAA4B;AACxB;AACA,iBAAKhB,UAAL,CAAgBgB,CAAhB,EAAmByB,OAAnB;AACA;AACA;AACA;AACH;AACD,aAAKzC,UAAL,GAAkB,EAAlB;AACA;AACA,aAAKT,QAAL;AACA,aAAKjB,SAAL,GAAiB9D,UAAUkI,OAA3B;AACH,KAnKI;AAoKLnD,cAAU,oBAAY;AAClB,YAAIoD,WAAW/I,YAAYqB,OAAOqH,IAAnB,EAAyBM,KAAxC;AACA,aAAK,IAAI5B,IAAI,CAAb,EAAgBA,IAAIlH,YAAY+I,MAAhC,EAAwC7B,GAAxC,EAA6C;AACzC,gBAAIlH,YAAYkH,CAAZ,EAAe8B,UAAf,IAA6BlJ,YAAYqB,OAAOqH,IAAnB,EAAyBS,IAA1D,EAAgE;AAC5D,qBAAKzF,IAAL,GAAYxD,YAAYkH,CAAZ,EAAe1D,IAA3B;AACA;AACH;AACJ;;AAED,aAAK4B,MAAL,GAAcpF,YAAY,KAAKwD,IAAjB,EAAuB0F,KAArC;AACA,aAAKvF,UAAL,GAAkB3D,YAAY,KAAKwD,IAAjB,EAAuBwF,UAAzC;AACA,aAAKpF,UAAL,GAAkB5D,YAAY,KAAKwD,IAAjB,EAAuB2F,KAAzC;AACA,aAAKrF,OAAL,GAAe9D,YAAY,KAAKwD,IAAjB,EAAuBM,OAAtC;;AAEA,aAAKsF,SAAL;AACA,aAAKC,eAAL;AACA,aAAKC,eAAL;AACA,aAAKpG,MAAL,CAAYkE,IAAZ,CAAiBO,MAAjB,GAA0B,IAA1B;AACA,aAAK4B,WAAL;AACA,aAAKC,YAAL;AACA,YAAI,KAAK3C,SAAT,EAAoB;AAChB,iBAAKlB,kBAAL,CAAwB8D,WAAxB;AACA,iBAAK5C,SAAL,GAAiB,KAAjB;AACH;AAGJ,KA9LI;AA+LL;AACA6C,qBAAiB,yBAAUC,SAAV,EAAqB;;AAElC,aAAK1D,OAAL,CAAa0D,SAAb,EAAwBvC,IAAxB,CAA6BO,MAA7B,GAAsC,IAAtC;AACA,aAAK1B,OAAL,CAAa0D,SAAb,EAAwBC,YAAxB,CAAqC,CAArC,EAAwC,cAAxC,EAAwD,IAAxD;AACH,KApMI;AAqMLL,iBAAa,uBAAY;AACrB,aAAK,IAAIrC,IAAI,KAAKjC,WAAlB,EAA+BiC,KAAK,KAAKhC,SAAzC,EAAoDgC,GAApD,EAAyD;AACrD,gBAAI,KAAKjB,OAAL,CAAaiB,CAAb,KAAmBC,SAAvB,EAAkC;AAC9B,qBAAK0C,aAAL,CAAmB3C,CAAnB;AACH;AACJ;AACJ,KA3MI;AA4ML4C,qBAAiB,yBAAUH,SAAV,EAAqB;AAClC,aAAK1D,OAAL,CAAa0D,SAAb,EAAwBvC,IAAxB,CAA6BO,MAA7B,GAAsC,KAAtC;AACH,KA9MI;AA+MLoC,eAAW,mBAAUrC,EAAV,EAAc;AAAA;;AACrB,YAAIN,OAAO,IAAI7F,GAAGM,IAAP,EAAX;AACA,YAAImF,SAASI,KAAKE,YAAL,CAAkBtE,GAAGC,QAArB,CAAb;AACA,YAAIsE,OAAOrH,WAAWwH,EAAX,CAAX;AACA,YAAInB,YAAYgB,KAAKhB,SAArB;AACA,YAAIyD,OAAO7J,gBAAgBoH,KAAKS,SAArB,CAAX;;AAEA/G,2BAAmBuG,eAAnB,CAAmCjB,SAAnC,EAA8CS,MAA9C;AACA,aAAK5D,QAAL,CAAcqE,QAAd,CAAuBL,IAAvB;AACA,aAAKnB,OAAL,CAAayB,EAAb,IAAmBV,MAAnB;AACAA,eAAOI,IAAP,CAAYO,MAAZ,GAAqB,KAArB;AACAX,eAAOZ,mBAAP,CAA2B,sBAAc;AACrC,gBAAIyB,gBAAgBvB,WAAWC,SAAX,GAAuBD,WAAWC,SAAX,CAAqBC,IAA5C,GAAmD,EAAvE;AACAjF,eAAGkF,GAAH,CAAO,2CAAP,EAAoDH,WAAWI,UAA/D,EAA2EmB,aAA3E;AACAb,mBAAOI,IAAP,CAAYO,MAAZ,GAAqB,KAArB;AACA,gBAAI,OAAKG,cAAL,CAAoBJ,EAApB,CAAJ,EAA6B;AACrB,uBAAKK,UAAL,CAAgBL,EAAhB;AACP;AACJ,SAPD;AAQA,YAAIX,YAAY,OAAOiD,KAAK7B,GAAZ,GAAkBC,WAAW4B,KAAK3B,IAAhB,CAAlB,GAA0C,KAAKjE,aAA/D;AACA4C,eAAOkB,SAAP,GAAmBnB,SAAnB;AACH,KApOI;AAqOLkD,uBAAmB,2BAAUC,IAAV,EAAgB;AAC/B,aAAKlD,MAAL,CAAYmD,YAAZ,GAA2BD,IAA3B;AACH,KAvOI;;AA0OLpC,oBAAgB,wBAAUJ,EAAV,EAAc;AAC1B,YAAIV,SAAS7F,OAAO6F,MAApB;AACA,YAAIA,OAAOU,EAAP,KAAcP,SAAd,IAA2BH,OAAOU,EAAP,EAAWM,SAAX,IAAwB,CAAC,CAAxD,EACI,OAAO,IAAP;AACJ,eAAO,KAAP;AACH,KA/OI;AAgPL6B,mBAAe,uBAAUF,SAAV,EAAqB;AAChC,YAAG,KAAKpE,YAAL,IAAoB,IAAvB,EAA4B;AACxB,gBAAI,KAAKpB,UAAL,IAAmB,IAAvB,EAA6B;AACzB,qBAAKA,UAAL,GAAkB,EAAlB;AACH;AACD,gBAAIiG,YAAY,KAAK7E,YAAL,CAAkB8E,CAAlC;AACA,gBAAIC,WAAW,KAAK/E,YAAL,CAAkBgF,CAAjC;AACA,iBAAKpG,UAAL,CAAgBwF,SAAhB,IAA6B,KAAKpE,YAAlC;AACA,gBAAIiF,WAAW,KAAKb,SAAL,CAAeS,SAAf,EAAyBE,QAAzB,CAAf;AACAG,oBAAQhE,GAAR,CAAY,SAAZ,EAAsB,KAAKtC,UAAL,CAAgBwF,SAAhB,CAAtB;AACA,iBAAK1D,OAAL,CAAa0D,SAAb,EAAwBvC,IAAxB,CAA6BoD,QAA7B,GAAwCA,QAAxC;AACA,iBAAKvE,OAAL,CAAa0D,SAAb,EAAwBvC,IAAxB,CAA6BO,MAA7B,GAAsC,IAAtC;AACA,iBAAK+B,eAAL,CAAqBC,SAArB;AACA,iBAAKpE,YAAL,GAAoB,IAApB;AACA;AACH;AACD,YAAImF,YAAY,KAAK/G,UAAL,GAAkB,KAAKC,UAAvC;AACA,YAAI+G,UAAU,KAAK5G,UAAnB;AACA,YAAI6G,SAAS,KAAKC,YAAL,CAAkB,CAAlB,CAAb;AACA,YAAIF,WAAW,CAAX,IAAgBC,UAAU,CAA9B,EAAiC;AAC7B,iBAAKzG,UAAL,GAAkB,IAAlB;AACA;AACA,iBAAK8B,OAAL,CAAa0D,SAAb,EAAwBvC,IAAxB,CAA6BO,MAA7B,GAAsC,KAAtC;AACA;AACH;;AAED,YAAImD,QAAQ,KAAKC,aAAL,EAAZ;AACA,YAAIC,OAAO,KAAKjH,UAAhB;AACA,YAAI6B,OAAO,KAAX;AACA,YAAIqF,WAAW,EAAf;AACA,YAAIC,UAAUF,IAAd;AACA,eAAOE,WAAW,CAAlB,EAAqBA,SAArB,EAAgC;AAC5B,iBAAK,IAAIhE,IAAI,CAAb,EAAgBA,IAAI,KAAK9B,MAAzB,EAAiC8B,GAAjC,EAAsC;AAAC;AACnC,oBAAI,KAAKnB,MAAL,CAAYmF,OAAZ,KAAwB,KAAKC,eAAL,CAAqBD,OAArB,EAA8BhE,CAA9B,CAA5B,EAA8D;AAC1D,wBAAItB,QAAO,KAAX;AACA,yBAAK,IAAIgC,IAAI,KAAK3C,WAAlB,EAA+B2C,KAAK,KAAK1C,SAAzC,EAAoD0C,GAApD,EAAyD;AACrD,4BAAI,KAAKzD,UAAL,IAAmB,KAAKA,UAAL,CAAgByD,CAAhB,CAAvB,EAA2C;AACvC,gCAAI,KAAKzD,UAAL,CAAgByD,CAAhB,EAAmByC,CAAnB,IAAwBa,OAAxB,IAAmChE,KAAK,KAAK/C,UAAL,CAAgByD,CAAhB,EAAmB2C,CAA/D,EAAkE;AAC9D3E,wCAAO,IAAP;AACA;AACH;AACJ;AACJ;AACD,wBAAI,CAACA,KAAL,EAAW;AACPqF,iCAASG,IAAT,CAAclE,CAAd;AACH;AACJ;AACJ;AACD,gBAAI+D,SAASlC,MAAT,GAAkB,CAAtB,EACI;AACP;AACD,YAAIkC,SAASlC,MAAT,IAAmB,CAAvB,EAA0B;AACtB,iBAAK5E,UAAL,CAAgBwF,SAAhB,IAA6B,IAA7B;AACA;AACH;AACD,YAAI0B,MAAM5K,UAAU6K,SAAV,CAAoB,CAApB,EAAuBL,SAASlC,MAAT,GAAkB,CAAzC,CAAV;AACA,YAAIwC,MAAMN,SAASI,GAAT,CAAV;AACA,YAAIG,WAAW,KAAK7B,SAAL,CAAeuB,OAAf,EAAwBK,GAAxB,CAAf;AACA,YAAI,KAAKpH,UAAL,IAAmB,IAAvB,EAA6B;AACzB,iBAAKA,UAAL,GAAkB,EAAlB;AACH;AACD,aAAKA,UAAL,CAAgBwF,SAAhB,IAA6B,EAACU,GAAGa,OAAJ,EAAaX,GAAGgB,GAAhB,EAA7B;AACAd,gBAAQhE,GAAR,CAAY,SAAZ,EAAsB,KAAKtC,UAAL,CAAgBwF,SAAhB,CAAtB;AACA,aAAK1D,OAAL,CAAa0D,SAAb,EAAwBvC,IAAxB,CAA6BoD,QAA7B,GAAwCgB,QAAxC;AACA,aAAKvF,OAAL,CAAa0D,SAAb,EAAwBvC,IAAxB,CAA6BO,MAA7B,GAAsC,IAAtC;AACA,aAAK+B,eAAL,CAAqBC,SAArB;AACH,KAlTI;AAmTL;AACA8B,iBApTK,yBAoTST,IApTT,EAoTeO,GApTf,EAoToB;;AAErB,YAAI/H,OAAO,KAAKA,IAAL,IAAa,CAAb,GAAiB,UAAjB,GAA8B,YAAzC;AACA,YAAI4D,OAAO,KAAKrB,MAAL,CAAYiF,IAAZ,EAAkBO,GAAlB,EAAuB1F,YAAvB,CAAoCrC,IAApC,CAAX;AACA,eAAO4D,KAAKsE,QAAL,EAAP;AACH,KAzTI;;AA0TLX,mBAAe,yBAAY;AACvB,YAAIY,MAAM,KAAK5H,UAAf;AACA,YAAI6H,aAAa,KAAK9J,MAAL,CAAYsF,IAAZ,CAAiByE,YAAjB,EAAjB;AACA,YAAIC,MAAM,CAAV;AACA,YAAIpB,YAAY,KAAK/G,UAAL,GAAkB,KAAKC,UAAvC;AACA,YAAIgI,cAAc,KAAK/G,UAAvB,EAAmC;AAC/BiH,kBAAM,CAAN;AACH,SAFD,MAEO;AACH,gBAAIC,UAAUJ,MAAMjB,SAApB;AACA,gBAAIsB,WAAW,CAACD,UAAUH,UAAV,GAAuB,KAAK/G,UAA7B,IAA2C6F,SAA1D;AACAoB,kBAAMG,KAAKC,KAAL,CAAWP,MAAMK,QAAjB,CAAN;AACH;AACD,eAAO,EAACL,KAAKA,GAAN,EAAWG,KAAKA,GAAhB,EAAP;AACH,KAvUI;AAwUL;AACAnC,eAAW,mBAAUqB,IAAV,EAAgBO,GAAhB,EAAqB;AAC5B,YAAIY,UAAU,KAAKrK,MAAL,CAAYsF,IAAZ,CAAiByE,YAAjB,EAAd;AACA,YAAIO,QAAQ,KAAKxK,QAAL,CAAc2I,CAA1B;AACA,YAAIG,YAAY,KAAK/G,UAAL,GAAkB,KAAKC,UAAvC;AACA,YAAIyI,QAAQd,MAAMb,SAAN,GAAkB,KAAK5G,OAAvB,GAAiC,KAAKF,UAAlD;AACA,YAAI0I,QAAQtB,OAAON,SAAP,GAAmByB,OAA/B;AACA,YAAII,OAAOF,QAAQ,KAAKtH,SAAb,GAAyB,EAAzB,GAA8B,KAAKpB,UAA9C;AACA,YAAI6I,OAAOF,QAAQ,EAAnB;AACA,eAAO/K,GAAGkL,CAAH,CAAKF,IAAL,EAAWC,IAAX,CAAP;AAEH,KAnVI;AAoVLzE,gBAAY,oBAAU4B,SAAV,EAAqB;AAC7B,YAAI,KAAKxF,UAAL,IAAmB,IAAnB,IAA2B,KAAKA,UAAL,CAAgBwF,SAAhB,KAA8B,IAA7D,EAAmE;;AAE/D,gBAAIY,IAAI,KAAKpG,UAAL,CAAgBwF,SAAhB,EAA2BY,CAAnC;AACA,gBAAIF,IAAI,KAAKlG,UAAL,CAAgBwF,SAAhB,EAA2BU,CAAnC;AACAI,oBAAQhE,GAAR,CAAY,SAAZ,EAAsB4D,CAAtB,EAAwBE,CAAxB;AACA,gBAAIhJ,GAAGmL,OAAH,CAAW,KAAK3G,MAAL,CAAYsE,CAAZ,EAAeE,CAAf,CAAX,CAAJ,EAAmC;AAC/B,qBAAKoC,YAAL,CAAkBtC,CAAlB,EAAqBE,CAArB;AACH;AACD;AACA,iBAAKV,aAAL,CAAmBF,SAAnB;AAGH;AACJ,KAlWI;AAmWL;AACA;AACAiD,qBAAiB,2BAAY;AACzB,YAAI,KAAK5G,UAAL,CAAgB+C,MAAhB,GAAyB,CAA7B,EAAgC;AAC5B,iBAAK,IAAI7B,IAAI,CAAb,EAAgBA,IAAI,KAAKlB,UAAL,CAAgB+C,MAApC,EAA4C7B,GAA5C,EAAiD;AAC7C,oBAAIE,OAAO,KAAKpB,UAAL,CAAgBkB,CAAhB,CAAX;AACA,oBAAI3F,GAAGmL,OAAH,CAAWtF,IAAX,CAAJ,EAAsB;AAClBA,yBAAKuB,OAAL;AACH;AACJ;AACJ;AACD,aAAK3C,UAAL,GAAkB,EAAlB;AACH,KA/WI;AAgXL6G,oBAAgB,0BAAY;AACxB,YAAI,KAAK9G,MAAL,CAAYgD,MAAZ,GAAqB,CAAzB,EAA4B;AACxB,iBAAK,IAAI7B,IAAI,CAAb,EAAgBA,IAAI,KAAKnB,MAAL,CAAYgD,MAAhC,EAAwC7B,GAAxC,EAA6C;AACzC,qBAAK,IAAIU,KAAI,CAAb,EAAgBA,KAAI,KAAK7B,MAAL,CAAYmB,CAAZ,EAAe6B,MAAnC,EAA2CnB,IAA3C,EAAgD;AAC5C,wBAAIR,OAAO,KAAKrB,MAAL,CAAYmB,CAAZ,EAAeU,EAAf,CAAX;AACA,wBAAIrG,GAAGmL,OAAH,CAAWtF,IAAX,CAAJ,EAAsB;AAClBA,6BAAKuB,OAAL;AACH;AACJ;AACJ;AACJ;AACD,aAAK5C,MAAL,GAAc,EAAd;AACH,KA5XI;AA6XLqD,eAAW,qBAAY;;AAEnB,aAAKyD,cAAL;AACA,aAAKD,eAAL;AACA,YAAI/D,WAAW/I,YAAYqB,OAAOqH,IAAnB,EAAyBM,KAAxC;AACA,aAAK,IAAI5B,IAAI,CAAb,EAAgBA,IAAI2B,WAAW,CAA/B,EAAkC3B,GAAlC,EAAuC;;AAEnC,gBAAI4F,WAAW,KAAKC,QAAL,CAAc,KAAKC,UAAL,CAAgBlN,YAAYqB,OAAOqH,IAAnB,EAAyByE,OAAzC,EAAkD/F,CAAlD,CAAd,EAAoEA,CAApE,CAAf;;AAEA,iBAAKnB,MAAL,CAAYqF,IAAZ,CAAiB0B,QAAjB;AACAA,uBAAW,EAAX;AACH;AACD,YAAII,UAAU,KAAKH,QAAL,CAAcjN,YAAYqB,OAAOqH,IAAnB,EAAyB2E,GAAvC,EAA4CjG,CAA5C,CAAd;AACA,aAAKnB,MAAL,CAAYqF,IAAZ,CAAiB8B,OAAjB;AACH,KA3YI;AA4YLH,cAAU,kBAAUK,OAAV,EAAmBC,OAAnB,EAA4B;;AAElC,YAAIrD,OAAOhK,YAAY,KAAKwD,IAAjB,CAAX;AACA,YAAI0F,QAAQc,KAAKd,KAAjB;AACA,YAAIoE,UAAU,KAAK9J,IAAL,IAAa,CAAb,GAAiB7C,eAAjB,GAAmCC,iBAAjD;AACA,YAAI2M,OAAOvD,KAAKlG,OAAL,GAAekG,KAAKb,KAApB,GAA4B,KAAKpE,SAA5C;AACA,YAAIyI,OAAOH,WAAW,KAAK1J,UAAL,GAAkBqG,KAAKb,KAAlC,IAA2C,KAAKhD,QAA3D;AACA,YAAIsH,YAAY,EAAhB;AACA,YAAIC,OAAOJ,QAAQK,aAAR,CAAsBP,OAAtB,CAAX;;AAEAM,aAAKlD,QAAL,GAAgBjJ,GAAGkL,CAAH,CAAKzC,KAAKlG,OAAL,GAAe,CAAf,GAAmB,KAAKiB,SAA7B,EAAwCyI,OAAO,KAAK7J,UAAL,GAAkB,CAAjE,CAAhB;AACA,aAAK/B,QAAL,CAAc6F,QAAd,CAAuBiG,IAAvB;AACA,aAAK1H,UAAL,CAAgBoF,IAAhB,CAAqBsC,IAArB;AACA,YAAIE,QAAQN,QAAQK,aAAR,CAAsBP,OAAtB,CAAZ;AACA,YAAIS,SAAS,KAAK9I,SAAL,GAAiBiF,KAAKlG,OAAL,GAAe,CAA7C;AACA8J,cAAMpD,QAAN,GAAiBjJ,GAAGkL,CAAH,CAAKoB,MAAL,EAAaL,OAAO,KAAK7J,UAAL,GAAkB,CAAtC,CAAjB;AACA,aAAK/B,QAAL,CAAc6F,QAAd,CAAuBmG,KAAvB;AACA,aAAK5H,UAAL,CAAgBoF,IAAhB,CAAqBwC,KAArB;;AAEA,aAAK,IAAI1G,IAAI,CAAb,EAAgBA,IAAIgC,KAApB,EAA2BhC,GAA3B,EAAgC;AAC5B,gBAAIE,OAAOkG,QAAQQ,MAAR,CAAeV,OAAf,CAAX;AACAhG,iBAAKoD,QAAL,GAAgBjJ,GAAGkL,CAAH,CAAKc,OAAO,KAAK5J,UAAL,GAAkB,CAA9B,EAAiC6J,OAAO,KAAK7J,UAAL,GAAkB,CAA1D,CAAhB;AACA4J,oBAAQ,KAAK5J,UAAL,GAAkBqG,KAAKb,KAA/B;AACA,iBAAKvH,QAAL,CAAc6F,QAAd,CAAuBL,IAAvB;AACAqG,sBAAUrC,IAAV,CAAehE,IAAf;AACH;;AAED,eAAOqG,SAAP;AACH,KAxaI;;AA0aL;AACAT,cA3aK,sBA2aMC,OA3aN,EA2aeI,OA3af,EA2awB;AACzB,YAAIU,eAAJ;AACA,YAAId,QAAQe,OAAR,CAAgB,GAAhB,KAAwB,CAAC,CAA7B,EAAgC;AAC5B,gBAAIC,YAAYhB,QAAQiB,KAAR,CAAc,GAAd,CAAhB;AACA,gBAAIC,SAAS1N,UAAU6K,SAAV,CAAoB,CAApB,EAAuB2C,UAAUlF,MAAV,GAAmB,CAA1C,CAAb;AACAgF,qBAASE,UAAUE,MAAV,CAAT;AACH,SAJD,MAIO;AACHJ,qBAASK,SAASnB,OAAT,CAAT;AACH;AACD,YAAIoB,aAAa,CAAjB;AACA,aAAK,IAAInH,IAAI,CAAb,EAAgBA,KAAK,EAArB,EAAyBA,GAAzB,EAA8B;AAC1B,gBAAIjH,YAAY8N,MAAZ,EAAoB,QAAQ7G,CAA5B,KAAkC,CAAtC,EAAyC;AACrCA,oBAAI,CAAJ;AACA;AACH;AACDmH,0BAAcpO,YAAY8N,MAAZ,EAAoB,QAAQ7G,CAA5B,CAAd;AACA,gBAAImH,cAAchB,OAAlB,EAA2B;AACvB,uBAAOpN,YAAY8N,MAAZ,EAAoB,UAAU7G,CAA9B,CAAP;AACH;AACD,gBAAIA,KAAK,EAAT,EAAa;AACTA,oBAAI,CAAJ;AACH;AACJ;AACJ,KAlcI;;AAmcL;AACAyF,kBAAc,sBAAU3B,IAAV,EAAgBO,GAAhB,EAAqB;;AAE/B,YAAI,CAAC,KAAKxF,MAAL,CAAYiF,IAAZ,CAAL,EACI;AACJ,YAAI5D,OAAO,KAAKrB,MAAL,CAAYiF,IAAZ,EAAkBO,GAAlB,CAAX;;AAEA,YAAInE,QAAQ,IAAZ,EAAkB;AACd,gBAAIoE,WAAW,KAAK7B,SAAL,CAAeqB,IAAf,EAAqBO,GAArB,CAAf;AACA,gBAAI+C,SAAS,KAAK7C,aAAL,CAAmBT,IAAnB,EAAyBO,GAAzB,CAAb;AACCd,oBAAQhE,GAAR,CAAY,aAAZ,EAA2BuE,IAA3B,EAAiC,GAAjC,EAAsCO,GAAtC,EAA2CC,QAA3C;AACDxK,iCAAqBuN,kBAArB,CAAwCD,SAAS,QAAjD,EAA2D,KAAK3I,kBAAL,CAAwByB,IAAnF,EAAyFoE,QAAzF;AACApE,iBAAKoH,gBAAL,CAAsB,IAAtB;AACA,iBAAKzI,MAAL,CAAYiF,IAAZ,EAAkBO,GAAlB,IAAyB,IAAzB;AACA,iBAAKkD,aAAL;AACA,iBAAKC,cAAL;AACH;AACD,aAAK9H,UAAL,GAAkB,KAAlB;AACA,aAAKrC,UAAL;AACA,aAAK+E,eAAL;AAGH,KAzdI;AA0dLA,qBAAgB,2BAAU;AACtB,YAAIqF,OAAO,KAAKpK,UAAL,GAAgB,CAA3B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA,YAAGpD,OAAOqH,IAAP,IAAe,CAAf,IAAoBmG,IAAvB,EAA4B;AACxB,gBAAG,CAAC,KAAKrJ,aAAT,EAAuB;AACnB,oBAAI8B,OAAOtG,cAAcgN,MAAd,EAAX;AACA,qBAAKxI,aAAL,GAAoB8B,IAApB;AACA,qBAAKxF,QAAL,CAAc6F,QAAd,CAAuBL,IAAvB;AACH;AACD,gBAAImE,MAAK,IAAE,KAAKhH,UAAhB;AACA,gBAAIyG,OAAO,CAAX;;AAEA,gBAAIR,WAAW,KAAKb,SAAL,CAAeqB,IAAf,EAAoBO,GAApB,CAAf;AACAf,qBAASD,CAAT,GAAaC,SAASD,CAAT,GAAW,GAAxB;AACA,iBAAKjF,aAAL,CAAmBkF,QAAnB,GAA8BA,QAA9B;AACA,iBAAKjF,YAAL,GAAoB,EAAC8E,GAAGW,IAAJ,EAAST,GAAEgB,GAAX,EAApB;AACH,SAbD,MAaM;AACF,gBAAI,KAAKjG,aAAT,EAAwB;AACpB,qBAAKA,aAAL,CAAmBkJ,gBAAnB,CAAoC,IAApC;AACA,qBAAKlJ,aAAL,GAAqB,IAArB;AACA,qBAAKC,YAAL,GAAoB,IAApB;AACH;AAEJ;AAEJ,KA7fI;AA8fL4F,qBAAiB,yBAAUH,IAAV,EAAgBO,GAAhB,EAAqB;AAClC,YAAI,CAAC,KAAKxF,MAAL,CAAYiF,IAAZ,CAAD,IAAsB,CAAC,KAAKjF,MAAL,CAAYiF,IAAZ,EAAkBO,GAAlB,CAA3B,EACI,OAAO,KAAP;AACJ,YAAI1C,WAAW/I,YAAYqB,OAAOqH,IAAnB,EAAyBM,KAAxC;AACA,YAAIkC,QAAQnC,WAAW,CAAvB,EACI,OAAO,IAAP;AACJ,YAAIzB,aAAJ;AACAA,eAAO,KAAKrB,MAAL,CAAYiF,OAAO,CAAnB,EAAsBO,GAAtB,CAAP;AACA,YAAI,CAAChK,GAAGmL,OAAH,CAAWtF,IAAX,CAAL,EAAuB;AACnB,mBAAO,IAAP;AACH;AACD,YAAI4D,OAAO,CAAX,EAAc;AACV5D,mBAAO,KAAKrB,MAAL,CAAYiF,OAAO,CAAnB,EAAsBO,GAAtB,CAAP;AACA,gBAAI,CAAChK,GAAGmL,OAAH,CAAWtF,IAAX,CAAL,EAAuB;AACnB,uBAAO,IAAP;AACH;AACJ;AACD,YAAImE,MAAM,CAAN,IAAWA,MAAM,KAAKnG,MAAL,GAAc,CAAnC,EAAsC;AAClCgC,mBAAO,KAAKrB,MAAL,CAAYiF,IAAZ,EAAkBO,MAAM,CAAxB,CAAP;AACA,gBAAI,CAAChK,GAAGmL,OAAH,CAAWtF,IAAX,CAAL,EAAuB;AACnB,uBAAO,IAAP;AACH;AACDA,mBAAO,KAAKrB,MAAL,CAAYiF,IAAZ,EAAkBO,MAAM,CAAxB,CAAP;AACA,gBAAI,CAAChK,GAAGmL,OAAH,CAAWtF,IAAX,CAAL,EAAuB;AACnB,uBAAO,IAAP;AACH;AACJ,SATD,MASO,IAAImE,OAAO,CAAX,EAAc;AACjBnE,mBAAO,KAAKrB,MAAL,CAAYiF,IAAZ,EAAkBO,MAAM,CAAxB,CAAP;AACA,gBAAI,CAAChK,GAAGmL,OAAH,CAAWtF,IAAX,CAAL,EAAuB;AACnB,uBAAO,IAAP;AACH;AACJ,SALM,MAKA,IAAImE,OAAO,KAAKnG,MAAL,GAAc,CAAzB,EAA4B;AAC/BgC,mBAAO,KAAKrB,MAAL,CAAYiF,IAAZ,EAAkBO,MAAM,CAAxB,CAAP;AACA,gBAAI,CAAChK,GAAGmL,OAAH,CAAWtF,IAAX,CAAL,EAAuB;AACnB,uBAAO,IAAP;AACH;AACJ;AACD,eAAO,KAAP;AACH,KApiBI;AAqiBLqH,mBAAe,yBAAY;;AAEvB,YAAIG,SAAS,EAAb;AACAA,eAAOC,GAAP,GAAa1N,OAAO0N,GAAP,GAAa,CAA1B;AACAD,eAAOE,IAAP,GAAc3N,OAAO2N,IAAP,GAAc,IAAK,KAAKzK,WAAxB,GAAuC,KAAKC,UAA1D;AACA,aAAKqB,kBAAL,CAAwBoJ,UAAxB,CAAmCH,MAAnC;AACAzN,eAAO6N,OAAP,CAAeJ,OAAOC,GAAtB;AACA1N,eAAO8N,QAAP,CAAgBL,OAAOE,IAAvB;AAEH,KA9iBI;AA+iBLI,gBAAY,sBAAY;AACpB,YAAIvD,MAAM,CAAV;AACA,YAAI9C,WAAW/I,YAAYqB,OAAOqH,IAAnB,EAAyBM,KAAxC;AACA,aAAK,IAAI5B,IAAI,CAAb,EAAgBA,IAAI2B,QAApB,EAA8B3B,GAA9B,EAAmC;AAC/B,iBAAK,IAAIU,IAAI,CAAb,EAAgBA,IAAI,KAAKxC,MAAzB,EAAiCwC,GAAjC,EAAsC;AAClC,oBAAI,KAAK7B,MAAL,IAAe,KAAKA,MAAL,CAAYmB,CAAZ,CAAf,IAAiC,KAAKnB,MAAL,CAAYmB,CAAZ,EAAeU,CAAf,CAArC,EAAwD;AACpD,wBAAIR,OAAO,KAAKrB,MAAL,CAAYmB,CAAZ,EAAeU,CAAf,CAAX;AACA,wBAAI,CAACrG,GAAGmL,OAAH,CAAWtF,IAAX,CAAL,EACI;AACJ,wBAAIF,IAAIyE,GAAR,EAAa;AACTA,8BAAMzE,CAAN;AACH;AACD;AACH;AACJ;AACJ;AACD,eAAOyE,GAAP;AACH,KAhkBI;;AAkkBLd,kBAAc,sBAAUG,IAAV,EAAgB;AAAC;AAC3B,YAAIW,MAAM,CAAV;AACA,aAAK,IAAI/D,IAAI,CAAb,EAAgBA,IAAI,KAAKxC,MAAzB,EAAiCwC,GAAjC,EAAsC;AAClC,gBAAIR,OAAO,KAAKrB,MAAL,CAAYiF,IAAZ,EAAkBpD,CAAlB,CAAX;AACA,gBAAI,CAACrG,GAAGmL,OAAH,CAAWtF,IAAX,CAAL,EACI;AACJuE;AACH;AACD,eAAOA,GAAP;AACH,KA3kBI;AA4kBL;AACA;;AAEA+C,oBAAgB,0BAAY;;AAExB,YAAI/D,UAAU,KAAKuE,UAAL,EAAd;AACA,YAAI,KAAKnL,UAAL,IAAmB4G,OAAvB,EAAgC;AAC5B;AACH;AACD,YAAIwE,OAAO,KAAKpL,UAAL,GAAkB4G,OAA7B;AACA,aAAK5G,UAAL,GAAkB4G,OAAlB;AACA,YAAIyE,OAAO,KAAKtN,MAAL,CAAYsF,IAAZ,CAAiByE,YAAjB,EAAX;AACA,YAAIuD,QAAQ,CAAZ,EAAe;AACX;AACH;AACD,YAAIC,OAAOD,OAAO,KAAKzL,UAAL,GAAkBwL,IAApC;AACA,YAAIG,QAAQ,CAAZ;AACA,YAAID,QAAQ,CAAZ,EAAe;AACXC,oBAAQD,IAAR;AACH,SAFD,MAEO;AACHC,oBAAQ,CAAR;AACH;AACD,YAAI9D,WAAWjK,GAAGkL,CAAH,CAAK,CAAL,EAAQ6C,KAAR,CAAf;AACA,YAAIC,UAAUhO,GAAGiO,MAAH,CAAU,GAAV,EAAehE,QAAf,CAAd;AACA,aAAK1J,MAAL,CAAYsF,IAAZ,CAAiBqI,SAAjB,CAA2BF,OAA3B;AACA,YAAIG,gBAAgBN,OAAOC,IAA3B;AACA,aAAK,IAAInI,IAAI,KAAKjC,WAAlB,EAA+BiC,IAAI,KAAKhC,SAAxC,EAAmDgC,GAAnD,EAAwD;AACpD,gBAAG,KAAKjB,OAAL,CAAaiB,CAAb,KAAmBC,SAAtB,EAAgC;AAC5B,oBAAIqE,YAAS,KAAKvF,OAAL,CAAaiB,CAAb,EAAgBE,IAAhB,CAAqBoD,QAAlC;AACA,oBAAImF,UAAUpO,GAAGiO,MAAH,CAAU,GAAV,EAAc,EAACnF,GAAEmB,UAASnB,CAAZ,EAAcE,GAAEiB,UAASjB,CAAT,GAAWmF,aAA3B,EAAd,CAAd;AACA,qBAAKzJ,OAAL,CAAaiB,CAAb,EAAgBE,IAAhB,CAAqBqI,SAArB,CAA+BE,OAA/B;AACH;AACJ;AACJ,KA7mBI;;AA+mBLtG,qBAAiB,2BAAY;AACzB,YAAIR,WAAW/I,YAAYqB,OAAOqH,IAAnB,EAAyBM,KAAxC;AACA,YAAIhE,SAAS+D,YAAY,KAAKlF,UAAL,GAAkB,KAAKC,UAAnC,CAAb;AACA;AACA,aAAKhB,WAAL,CAAiBkC,MAAjB,GAA0BA,MAA1B;AACA,YAAI8K,YAAY,CAAC9K,SAAS1D,UAAV,IAAwB,CAAxC;AACA,aAAKwB,WAAL,CAAiB2H,CAAjB,GAAqBqF,SAArB;AACA;AACA,YAAIC,SAAS,KAAKlN,IAAL,CAAUmC,MAAV,GAAmBA,MAAnB,GAA4B,EAAzC;AACA,YAAIgL,gBAAJ;AACA,YAAIC,kBAAJ;AACA,YAAIC,QAAQ5O,aAAayO,MAAzB;AACAE,oBAAY,CAACF,SAAS/K,MAAT,GAAkB1D,UAAnB,IAAiC,CAAjC,GAAqC,EAAjD;AACA,aAAKuB,IAAL,CAAU4H,CAAV,GAAcwF,SAAd;AACA,YAAIE,UAAU,CAAd;AACA,YAAID,QAAQ,CAAZ,EAAe;AACX,iBAAKtN,GAAL,CAASiF,MAAT,GAAkB,IAAlB;AACA,iBAAKjF,GAAL,CAASoC,MAAT,GAAkBkL,QAAQ,EAA1B;AACAF,sBAAU,CAAC1O,aAAa4O,KAAd,IAAuB,CAAjC;AACA,iBAAKtN,GAAL,CAAS6H,CAAT,GAAauF,OAAb;AACA;AACAG,sBAAU,CAAV;AACH,SAPD,MAOO;AACH,iBAAKvN,GAAL,CAASiF,MAAT,GAAkB,KAAlB;AACA;AACAsI,sBAAU,CAACD,KAAX;AACH;AACD,aAAKlO,MAAL,CAAYsF,IAAZ,CAAiB8I,YAAjB,CAA8BD,OAA9B;AACA,aAAK5K,YAAL,GAAoB4K,OAApB;AACA,aAAKlM,UAAL,GAAkB8E,WAAW,CAA7B;AACH,KA7oBI;AA8oBL;AACA;AACAsH,kBAAc,wBAAY;AACtB,aAAKpN,QAAL,CAAcqE,IAAd,CAAmBO,MAAnB,GAA4B,IAA5B;AACA,aAAK5E,QAAL,CAAc6G,YAAd,CAA2B,CAA3B,EAA8B,cAA9B,EAA8C,KAA9C;AACH,KAnpBI;AAopBLwG,kBAAc,wBAAY;AACtB,aAAKrN,QAAL,CAAcqE,IAAd,CAAmBO,MAAnB,GAA4B,KAA5B;AACH,KAtpBI;AAupBL6B,kBAAc,wBAAY;AACtB,YAAI6G,QAAQvQ,YAAYqB,OAAOqH,IAAnB,EAAyB8H,GAArC;AACA,YAAIC,UAAUjQ,UAAU+P,KAAV,CAAd;AACA,aAAKhN,QAAL,CAAcmN,YAAd,GAA6BzP,kBAAkB0P,iBAAlB,CAAoC,SAApC,EAA+CF,QAAQG,IAAR,GAAe,MAA9D,CAA7B;AACA,aAAKrN,QAAL,CAAcsN,aAAd,GAA8B5P,kBAAkB0P,iBAAlB,CAAoC,SAApC,EAA+CF,QAAQG,IAAR,GAAe,MAA9D,CAA9B;AACA,aAAKrN,QAAL,CAAcuN,WAAd,GAA4B7P,kBAAkB0P,iBAAlB,CAAoC,SAApC,EAA+CF,QAAQG,IAAR,GAAe,MAA9D,CAA5B;AACA,aAAKrN,QAAL,CAAcwN,cAAd,GAA+B9P,kBAAkB0P,iBAAlB,CAAoC,SAApC,EAA+CF,QAAQG,IAAR,GAAe,MAA9D,CAA/B;AACA,YAAInK,YAAYgK,QAAQhK,SAAxB;AACAtF,2BAAmB6P,mBAAnB,CAAuCvK,SAAvC,EAAkD,KAAKxD,QAAvD;AACA,aAAKM,QAAL,CAAc+D,IAAd,CAAmBmD,CAAnB,GAAuB,CAACnJ,UAAD,GAAc,CAAd,GAAkB,KAAKuC,UAAvB,GAAoC,EAApC,GAAyC,EAAhE;AACA,aAAKZ,QAAL,CAAcqE,IAAd,CAAmBmD,CAAnB,GAAuB,CAACnJ,UAAD,GAAc,CAAd,GAAkB,KAAKuC,UAAvB,GAAoC,EAApC,GAAyC,EAAzC,GAA4C,GAAnE;AACA;AACA;AACA;AAEH,KAtqBI;AAuqBLgD,cAAU,oBAAY;;AAElB,YAAI6B,OAAOrH,OAAOqH,IAAlB;AACA,YAAIuI,QAAQjR,YAAY0I,IAAZ,EAAkB8H,GAA9B;AACA,YAAIU,WAAW1Q,UAAUyQ,KAAV,EAAiBE,MAAhC;AACA,YAAIjH,OAAOzJ,aAAayQ,QAAb,CAAX;AACA,YAAI3F,MAAMrB,KAAKqB,GAAf;AACA,YAAI6F,WAAW,EAAf;AACA,YAAIrB,SAAS,CAAb;AACA,YAAIoB,SAAS,EAAb;AACA,YAAItF,MAAM,CAAV;AACA,aAAK,IAAIzE,IAAI,CAAb,EAAgBA,IAAI,CAApB,EAAuBA,GAAvB,EAA4B;AACxB,gBAAI8C,KAAK,SAAS9C,CAAd,KAAoB,CAAxB,EAA2B;AACvB2I,yBAAS7F,KAAK,SAAS9C,CAAd,CAAT;AACA,oBAAIA,KAAK,CAAT,EAAY;AACRgK,6BAAShK,CAAT,IAAc2I,MAAd;AACAlE,0BAAMuF,SAAShK,CAAT,CAAN;AACH,iBAHD,MAGO;AACHgK,6BAAShK,CAAT,IAAcgK,SAAShK,IAAI,CAAb,IAAkB2I,MAAhC;AACAlE,0BAAMuF,SAAShK,CAAT,CAAN;AACH;AACJ;AACJ;AACD,aAAK,IAAIU,MAAI,CAAb,EAAgBA,OAAKyD,GAArB,EAA0BzD,KAA1B,EAA+B;AAC3B,gBAAIuJ,SAAS1Q,UAAU0Q,MAAV,CAAiBxF,GAAjB,CAAb;AACA,iBAAK,IAAIyF,IAAI,CAAb,EAAgBF,SAASE,CAAT,KAAejK,SAA/B,EAA0CiK,GAA1C,EAA+C;AAC3C,oBAAIF,SAASE,CAAT,IAAcD,MAAlB,EAA0B;AACtB;AACH;AACDF,uBAAOrJ,GAAP,IAAYoC,KAAK,SAASoH,CAAd,CAAZ;AACA;AACH;AACJ;AACD,YAAItC,OAAO,CAAX;AACA,YAAIuC,MAAM,CAAV;AACA,YAAIC,MAAM,EAAV;AACA,aAAK,IAAIpK,KAAI,CAAb,EAAgBA,MAAKmE,GAArB,EAA0BnE,IAA1B,EAA+B;AAC3B,gBAAI+J,OAAO/J,EAAP,KAAaC,SAAjB,EAA4B;AACxBmK,uBAAOL,OAAO/J,EAAP,IAAY,IAAnB;AACA,oBAAI+J,OAAO/J,EAAP,EAAU8G,OAAV,CAAkB,GAAlB,KAA0B,CAAC,CAA/B,EAAkC;AAC9B,wBAAIuD,aAAaN,OAAO/J,EAAP,EAAUgH,KAAV,CAAgB,GAAhB,CAAjB;AACA,wBAAIqD,WAAW,CAAX,KAAiB,IAArB,EAA2B;AACvBzC,gCAAQV,SAASmD,WAAW,CAAX,CAAT,CAAR;AACH,qBAFD,MAEO,IAAIA,WAAW,CAAX,KAAiB,IAArB,EAA2B;AAC9BF,+BAAOjD,SAASmD,WAAW,CAAX,CAAT,CAAP;AACH;AACJ;AACJ;AACD,iBAAKC,gBAAL,CAAsBP,OAAO/J,EAAP,CAAtB,EAAiCA,EAAjC;AACA,iBAAK3D,OAAL,CAAaoE,MAAb,GAAsB,IAAtB;AACH;AACD,YAAImH,OAAO,CAAP,IAAYuC,MAAM,CAAtB,EAAyB;AACrB,gBAAII,QAAQtQ,OAAO2N,IAAP,GAAcA,IAA1B;AACA,gBAAI4C,OAAOvQ,OAAOkQ,GAAP,GAAaA,GAAxB;AACA,iBAAK1L,kBAAL,CAAwBoJ,UAAxB,CAAmC,EAACD,MAAM2C,KAAP,EAAcJ,KAAKK,IAAnB,EAAnC;AACAvQ,mBAAO8N,QAAP,CAAgBwC,KAAhB;AACAtQ,mBAAOwQ,OAAP,CAAeD,IAAf;AACH;AAEJ,KAluBI;AAmuBLF,sBAAkB,0BAAUP,MAAV,EAAkB/J,CAAlB,EAAqB;AAAA;;AACnC,YAAI,KAAKhB,UAAL,CAAgBgB,CAAhB,CAAJ,EAAwB;AACpB,iBAAKhB,UAAL,CAAgBgB,CAAhB,EAAmByB,OAAnB;AACA,iBAAKzC,UAAL,CAAgBgB,CAAhB,IAAqB,IAArB;AACH;AACD,YAAIJ,QAAQ,CAAC,GAAD,GAAOI,IAAI,GAAvB;;AAEA,YAAIE,OAAOvG,kBAAkBiN,MAAlB,CAAyBmD,MAAzB,CAAX;AACA,YAAIW,YAAY,KAAKvO,QAAL,CAAc+D,IAAd,CAAmBoD,QAAnB,CAA4BH,CAA5C;AACA,YAAIwH,YAAY,KAAKxO,QAAL,CAAc+D,IAAd,CAAmBoD,QAAnB,CAA4BD,CAA5B,GAA8B,GAA9C;;AAEA,aAAKrE,UAAL,CAAgBgB,CAAhB,IAAsBE,IAAtB;AACAA,aAAKoD,QAAL,GAAgBjJ,GAAGkL,CAAH,CAAKmF,SAAL,EAAeC,SAAf,CAAhB;AACA,YAAIC,SAASvQ,GAAGiO,MAAH,CAAU,GAAV,EAAejO,GAAGkL,CAAH,CAAK3F,KAAL,EAAY,GAAZ,CAAf,CAAb;AACA,YAAI6I,UAAUpO,GAAGwQ,QAAH,CAAY,YAAM;AAC5B3K,iBAAKvB,YAAL,CAAkB,YAAlB,EAAgCmM,SAAhC;AACA,mBAAKhO,QAAL,GAAgB,IAAhB;AACH,SAHa,EAGX,IAHW,CAAd;AAIA;AACA,aAAKT,OAAL,CAAakE,QAAb,CAAsBL,IAAtB;AACAA,aAAKqI,SAAL,CAAelO,GAAG0Q,QAAH,CAAYH,MAAZ,EAAoBnC,OAApB,CAAf;AACH,KAxvBI;AAyvBLuC,qBAAiB,yBAAUC,KAAV,EAAiB;AAC9B,YAAIC,aAAa,KAAKlD,UAAL,EAAjB;AACA,YAAIrE,eAAe,KAAKA,YAAL,CAAkB,CAAlB,CAAnB;AACA,YAAIuH,cAAc,CAAd,IAAmBvH,gBAAgB,CAAvC,EAA0C;AACtC,iBAAKwH,aAAL,GAAqBF,MAAMG,WAAN,EAArB;;AAEA,iBAAKC,WAAL,CAAiB,KAAKF,aAAtB;AACA;AACH;AACD,aAAKnP,MAAL,CAAYkE,IAAZ,CAAiBO,MAAjB,GAA0B,KAA1B;AACA,aAAKnD,SAAL,GAAiB9D,UAAU8R,GAA3B;AACA,aAAKxO,QAAL,GAAgB,KAAhB;AACA,aAAKT,OAAL,CAAaoE,MAAb,GAAqB,IAArB;AACA,aAAKwI,YAAL;AACH,KAvwBI;AAwwBLsC,gBAAW,sBAAU;AACjB,YAAGtR,OAAOqH,IAAP,GAAc,CAAjB,EACI;AACJ,YAAI4J,aAAa,KAAKlD,UAAL,EAAjB;AACA,YAAIrE,eAAe,KAAKA,YAAL,CAAkB,CAAlB,CAAnB;AACA,YAAIuH,cAAc,CAAd,IAAmBvH,gBAAgB,CAAvC,EAA0C;AACtC,gBAAIzD,OAAOtG,cAAcgN,MAAd,EAAX;AACA1G,iBAAKoD,QAAL,GAAe,KAAKnH,QAAL,CAAc+D,IAAd,CAAmBoD,QAAlC;AACApD,iBAAKsL,QAAL,GAAgB,GAAhB;AACA,iBAAKvN,WAAL,GAAmBiC,IAAnB;AACA,iBAAKxF,QAAL,CAAc6F,QAAd,CAAuBL,IAAvB;AACH;AACJ,KApxBI;AAqxBLsB,mBAAc,yBAAU;AACpB,YAAG,KAAKvD,WAAR,EAAoB;AAChB,iBAAKA,WAAL,CAAiBqJ,gBAAjB,CAAkC,IAAlC;AACA,iBAAKrJ,WAAL,GAAkB,IAAlB;AACH;AACJ,KA1xBI;AA2xBL;AACA;AACAoN,iBAAa,qBAAUI,KAAV,EAAiB;AAC1B,YAAIxG,UAAU,KAAKrK,MAAL,CAAYsF,IAAZ,CAAiByE,YAAjB,EAAd;AACA,YAAIO,QAAQ,KAAKxK,QAAL,CAAc2I,CAA1B;AACA,YAAIG,YAAY,KAAK/G,UAAL,GAAkB,KAAKC,UAAvC;AACA,YAAIoH,OAAOiB,KAAKC,KAAL,CAAW,CAACyG,MAAMpI,CAAN,GAAU4B,OAAX,IAAsBzB,SAAjC,CAAX;AACA,YAAIa,MAAMU,KAAKC,KAAL,CAAW,CAACyG,MAAMtI,CAAN,GAAU,KAAKvG,OAAf,GAAyB,KAAKF,UAA/B,IAA6C8G,SAAxD,CAAV;AACA,YAAI9E,OAAO,KAAX;AACA,YAAI,KAAKuF,eAAL,CAAqBH,IAArB,EAA2BO,GAA3B,CAAJ,EAAqC;AACjC,iBAAK,IAAIrE,IAAI,KAAKjC,WAAlB,EAA+BiC,KAAK,KAAKhC,SAAzC,EAAoDgC,GAApD,EAAyD;AACrD,oBAAI,KAAK/C,UAAL,IAAmB,IAAnB,IAA2B,KAAKA,UAAL,CAAgB+C,CAAhB,KAAsB,IAAjD,IAAyD,KAAK/C,UAAL,CAAgB+C,CAAhB,KAAsBC,SAAnF,EAA8F;AAC1F,wBAAI,KAAKhD,UAAL,CAAgB+C,CAAhB,EAAmBmD,CAAnB,IAAwBW,IAAxB,IAAgC,KAAK7G,UAAL,CAAgB+C,CAAhB,EAAmBqD,CAAnB,IAAwBgB,GAA5D,EAAiE;AAC7D,6BAAKtF,OAAL,CAAaiB,CAAb,EAAgBE,IAAhB,CAAqBO,MAArB,GAA8B,KAA9B;AACA;;AAEA,6BAAKgF,YAAL,CAAkB3B,IAAlB,EAAwBO,GAAxB;AACA,6BAAK1B,aAAL,CAAmB3C,CAAnB;AACAtB,+BAAO,IAAP;AACA;AACH;AACJ;AACJ;AACD,gBAAI,CAACA,IAAL,EAAW;AACP,qBAAK+G,YAAL,CAAkB3B,IAAlB,EAAwBO,GAAxB;AACH;AACJ;AACD;AACH,KAvzBI;AAwzBLqH,wBAAoB,4BAAUC,SAAV,EAAqB;;AAErC,YAAI,CAAC,KAAK7O,QAAV,EAAoB;AAChB;AACH;;AAEDyG,gBAAQhE,GAAR,CAAY,oBAAZ;;AAEA,YAAI,KAAKjC,SAAL,IAAkB9D,UAAU8R,GAAhC,EAAqC;AACjC,iBAAKjP,OAAL,CAAaoE,MAAb,GAAsB,KAAtB;AACA,iBAAKY,OAAL;AACH;;AAED,YAAG,KAAKuK,UAAL,IAAmB3L,SAAnB,IAAiC,KAAK2L,UAAL,IAAmB,OAAnB,IAA+B,KAAKA,UAAL,IAAmB,MAAtF,EAA8F;AAC1F,iBAAKA,UAAL,GAAkB,OAAlB;AACH,SAFD,MAEK;AACD,iBAAKA,UAAL,GAAkB,MAAlB;AACH;AACD,YAAG,KAAKA,UAAL,IAAmB,MAAtB,EAA6B;AACzBrI,oBAAQhE,GAAR,CAAY,KAAZ;AACA,iBAAK5D,YAAL,CAAkBuE,IAAlB,CAAuBO,MAAvB,GAAgC,KAAhC;AACH;AACD,YAAI6D,WAAU,KAAK5J,QAAL,CAAcmR,kBAAd,CAAiCF,SAAjC,CAAd;AACA,aAAKhQ,YAAL,CAAkBuE,IAAlB,CAAuB4L,YAAvB,CAAoCH,UAAUxI,CAAV,GAAc,KAAKtF,SAAvD;AACA,aAAKlC,YAAL,CAAkBuE,IAAlB,CAAuB8I,YAAvB,CAAoC2C,UAAUtI,CAAV,GAAc,KAAK1F,UAAvD;AACA,aAAKhC,YAAL,CAAkBoQ,KAAlB;AAEH,KAn1BI;;AAq1BLC,yBAAqB,6BAAUL,SAAV,EAAqB;AACtC,YAAIrH,WAAU,KAAK5J,QAAL,CAAcmR,kBAAd,CAAiCF,SAAjC,CAAd;AACA,aAAKN,WAAL,CAAiB/G,QAAjB;AACA,aAAK2H,UAAL,GAAkB,KAAlB;AACA,aAAKtQ,YAAL,CAAkBoQ,KAAlB;AACA,aAAKpQ,YAAL,CAAkBuE,IAAlB,CAAuBO,MAAvB,GAAgC,IAAhC;AACH,KA31BI;;AA61BLyL,sBAAkB,0BAAUP,SAAV,EAAqB;AACnC,YAAIrH,WAAU,KAAK5J,QAAL,CAAcmR,kBAAd,CAAiCF,SAAjC,CAAd;AACA,aAAKN,WAAL,CAAiB/G,QAAjB;AACA,aAAK2H,UAAL,GAAkB,KAAlB;AACA1I,gBAAQhE,GAAR,CAAY,kBAAZ;AACA,aAAK5D,YAAL,CAAkBoQ,KAAlB;AACA,aAAKhP,UAAL,GAAgB,IAAhB;AACA,aAAKpB,YAAL,CAAkBuE,IAAlB,CAAuBO,MAAvB,GAAgC,IAAhC;AACH,KAr2BI;AAs2BL0L,uBAAmB,2BAAUR,SAAV,EAAqB;AACpC,YAAIrH,WAAU,KAAK5J,QAAL,CAAcmR,kBAAd,CAAiCF,SAAjC,CAAd;AACA,YAAI,CAAC,KAAK7O,QAAV,EAAoB;AAChB;AACH;AACD,aAAK8O,UAAL,GAAiB,MAAjB;AACArI,gBAAQhE,GAAR,CAAY,mBAAZ;AACA,aAAK5D,YAAL,CAAkBuE,IAAlB,CAAuB4L,YAAvB,CAAoCH,UAAUxI,CAAV,GAAc,KAAKtF,SAAvD;AACA,aAAKlC,YAAL,CAAkBuE,IAAlB,CAAuB8I,YAAvB,CAAoC2C,UAAUtI,CAAV,GAAc,KAAK1F,UAAvD;AACA,YAAI2G,SAASnB,CAAT,GAAa,KAAKvG,OAAlB,IAA6B0H,SAASnB,CAAT,IAAc,IAAI,KAAKtF,SAAT,GAAqB,KAAKjB,OAA1B,IACxC0H,SAASjB,CAAT,GAAa,GADa,CAAjC,EAC0B;AACtB,iBAAK1H,YAAL,CAAkBoQ,KAAlB;AACA;AACH;AACD,aAAKV,WAAL,CAAiB/G,QAAjB;AACA;AACA;AACA;AACH,KAx3BI;AAy3BL;AACA8H,sBAAiB,0BAASC,UAAT,EAAsC;AAAA,YAAlBC,UAAkB,uEAAL,IAAK;;AACnD,aAAKV,UAAL,GAAiB,MAAjB;AACA,aAAKjQ,YAAL,CAAkBoQ,KAAlB;AACA,YAAIJ,YAAY,KAAKjR,QAAL,CAAcmR,kBAAd,CAAiCQ,UAAjC,CAAhB;AACA;AACA;AACA;AACA,YAAG,KAAKtP,UAAL,IAAmB,IAAtB,EAA2B;AACvB,iBAAKA,UAAL,GAAgB,EAAhB;AACA,iBAAKA,UAAL,CAAgB,CAAhB,IAAoB4O,SAApB;AACA;AACA;AACH;AACD,YAAIY,WAAWlS,GAAGmS,IAAH,CAAS,KAAKzP,UAAL,CAAgB,CAAhB,CAAT,EAA4B4O,SAA5B,CAAf;AACA;AACA,YAAGY,SAASlJ,CAAT,IAAc,CAAjB,EAAmB;AACf,gBAAIoJ,SAAS,KAAK7R,MAAL,CAAYsF,IAAZ,CAAiByE,YAAjB,EAAb;AACA,gBAAIgC,SAAQ,CAAE8F,SAAOF,SAASlJ,CAAlB,IAAqB,GAAjC;AACA,gBAAGsD,SAAQ,CAAX,EAAc;AACVA,yBAAQ,CAAR;AACH;AACD,gBAAGA,SAAQ,KAAKxI,YAAhB,EAA6B;AACzBwI,yBAAS,KAAKxI,YAAd;AACH;AACD,gBAAGwI,UAAS,CAAZ,EACI;AACJ,gBAAIsB,OAAOwE,SAAS9F,MAApB;AACA,iBAAK/L,MAAL,CAAYsF,IAAZ,CAAiB8I,YAAjB,CAA8BrC,MAA9B;AACA,iBAAK,IAAI3G,IAAI,KAAKjC,WAAlB,EAA+BiC,IAAI,KAAKhC,SAAxC,EAAmDgC,GAAnD,EAAwD;AACpD,oBAAG,KAAKjB,OAAL,CAAaiB,CAAb,KAAmBC,SAAtB,EAAgC;AAC5B,wBAAIqE,WAAS,KAAKvF,OAAL,CAAaiB,CAAb,EAAgBE,IAAhB,CAAqBoD,QAAlC;AACA;AACC;AACD,yBAAKvE,OAAL,CAAaiB,CAAb,EAAgBE,IAAhB,CAAqB8I,YAArB,CAAkC1E,SAASjB,CAAT,GAAW4E,IAA7C;AACH;AACJ;AACJ;AACJ,KA/5BI;AAg6BL;AACA;;;AAIAyE,mBAAe,uBAAUpQ,IAAV,EAAgBkE,EAAhB,EAAmC;AAAA,YAAfmM,MAAe,uEAAN,IAAM;;AAC9C;AACA,gBAAQrQ,IAAR;AACI,iBAAK,CAAL;AACI,oBAAIqQ,UAAU,IAAd,EAAmB;AACf;AACA,wBAAG3S,WAAW4S,eAAX,EAAH,EAAgC;AAC5B,4BAAIC,MAAMhU,QAAQ,UAAR,CAAV;AACAiU,+BAAO,IAAP;AACAD,4BAAIE,kBAAJ,CAAuB,YAAU;AACzBD,iCAAKE,kBAAL,CAAwBxM,EAAxB;AACAsM,iCAAKrO,kBAAL,CAAwBwO,YAAxB;AACH,yBAHL;AAKH,qBARD,MAQK;AACD,6BAAKD,kBAAL,CAAwBxM,EAAxB;AACH;AAEJ,iBAdD,MAeK;AACD,wBAAImM,UAAU,QAAd,EAAwB;AACpB,6BAAKO,oBAAL,CAA0B1M,EAA1B;AACH;AACJ;AACD;AACJ,iBAAK,CAAL;AACI,qBAAK2M,UAAL,CAAgB3M,EAAhB;AACA;AACJ,iBAAK,CAAL;AACI,qBAAK4M,aAAL,CAAmB5M,EAAnB,EAAsBmM,MAAtB;AACA;AA5BR;AA8BH,KAr8BI;AAs8BL;AACAK,wBAAoB,4BAAUxM,EAAV,EAAc;AAC9B,YAAIsC,OAAO5J,kBAAkBsH,EAAlB,CAAX;AACAvG,eAAO,QAAQuG,EAAf,IAAqBsC,KAAK3B,IAA1B;AACA,aAAKkM,iBAAL;AACA,aAAK5O,kBAAL,CAAwBwO,YAAxB;AAEH,KA78BI;AA88BL;AACAC,0BAAsB,8BAAU1M,EAAV,EAAc;AAChC,aAAK6M,iBAAL;AACA,aAAK5O,kBAAL,CAAwBwO,YAAxB;AACH,KAl9BI;;AAo9BLI,uBAAmB,6BAAY;AAC3B,YAAIC,cAAc,CAAlB;AACA,YAAIC,YAAY,CAAhB;AACA,aAAK,IAAIvN,MAAI,CAAb,EAAgBA,OAAK,CAArB,EAAwBA,KAAxB,EAA6B;AACzB,gBAAI/F,OAAO,QAAQ+F,GAAf,IAAoB,CAAxB,EAA2B;AACvBsN,+BAAepU,kBAAkB8G,GAAlB,EAAqBwN,KAApC;AACAD,6BAAarU,kBAAkB8G,GAAlB,EAAqByN,IAAlC;AACH;AACJ;AACD,YAAIH,eAAe,CAAnB,EAAsB;AAClBA,0BAAc,CAAd;AACH;AACD,YAAIC,aAAa,CAAjB,EAAoB;AAChBA,wBAAY,CAAZ;AACH;AACD,aAAKrQ,aAAL,GAAqBoQ,WAArB;AACA,aAAKnQ,WAAL,GAAmBoQ,SAAnB;AACA,aAAK,IAAIvN,IAAI,KAAKjC,WAAlB,EAA+BiC,KAAK,KAAKhC,SAAzC,EAAoDgC,GAApD,EAAyD;AACrD,gBAAI,KAAKjB,OAAL,CAAaiB,CAAb,KAAmBC,SAAvB,EAAkC;AAC9B,oBAAIc,QAAQ9H,gBAAgBgB,OAAO6F,MAAP,CAAcE,CAAd,EAAiBc,SAAjC,CAAZ;AACA,qBAAK/B,OAAL,CAAaiB,CAAb,EAAgBgB,SAAhB,GAA4B,QAAQD,MAAME,GAAN,GAAYC,WAAWH,MAAMI,IAAjB,CAApB,IAA8C,KAAKjE,aAA/E;AACH;AACJ;AACJ,KA3+BI;AA4+BLwQ,qBAAiB,2BAAY,CAE5B,CA9+BI;AA++BLP,gBAAY,oBAAU3M,EAAV,EAAc;AACtB,YAAIH,OAAOrH,WAAWwH,EAAX,CAAX;;AAEA,YAAIvG,OAAO6F,MAAP,CAAcU,EAAd,KAAqBP,SAAzB,EAAoC;AAAC;AACjC,gBAAIwH,OAAO,KAAKkG,WAAL,CAAiBnN,EAAjB,CAAX;AACA,gBAAIiH,IAAJ,EAAU;AACNxN,uBAAO6F,MAAP,CAAcU,EAAd,IAAoB,EAACA,IAAIA,EAAL,EAASM,WAAWT,KAAKS,SAAzB,EAApB;AACA7G,uBAAO2T,UAAP,CAAkB3T,OAAO6F,MAAzB;AACA,qBAAK+C,SAAL,CAAerC,EAAf;AACA,qBAAKmC,aAAL,CAAmBnC,EAAnB;AACH,aALD,MAKO;AACH,qBAAKqN,SAAL,CAAerN,EAAf;AACH;AACD,iBAAK/B,kBAAL,CAAwBwO,YAAxB;AAEH,SAZD,MAYO;AAAC;AACJ,gBAAInK,OAAO7J,gBAAgBgB,OAAO6F,MAAP,CAAcU,EAAd,EAAkBM,SAAlC,CAAX;AACA,gBAAIgN,OAAO,EAAX;;AAEA,gBAAIhL,KAAKiL,QAAL,GAAgB,IAApB,EAA0B;AACtB9T,uBAAO2N,IAAP,IAAe9E,KAAKkL,IAApB;AACAF,qBAAK,MAAL,IAAe7T,OAAO2N,IAAtB;AACH,aAHD,MAGO,IAAI9E,KAAKiL,QAAL,GAAgB,IAApB,EAA0B;AAC7B9T,uBAAOkQ,GAAP,IAAcrH,KAAKkL,IAAnB;AACAF,qBAAK,KAAL,IAAc7T,OAAOkQ,GAArB;AACH;AACD,gBAAIrH,KAAKmL,IAAL,IAAa,CAAC,CAAlB,EAAqB;AACjBhU,uBAAO6F,MAAP,CAAcU,EAAd,EAAkBM,SAAlB,GAA8BgC,KAAKmL,IAAnC;AACA,oBAAIlN,QAAQ9H,gBAAgB6J,KAAKmL,IAArB,CAAZ;AACAhU,uBAAO2T,UAAP,CAAkB3T,OAAO6F,MAAzB;AACA,qBAAKf,OAAL,CAAayB,EAAb,EAAiBQ,SAAjB,GAA6B,QAAQD,MAAME,GAAN,GAAYC,WAAWH,MAAMI,IAAjB,CAApB,IAA8C,KAAKjE,aAAhF;AACH;AACD,iBAAKuB,kBAAL,CAAwBoJ,UAAxB,CAAmCiG,IAAnC;AACH;AACJ,KAjhCI;AAkhCLH,iBAAa,qBAAUnN,EAAV,EAAc;AACvB,YAAIsC,OAAO9J,WAAWwH,EAAX,CAAX;AACA,YAAIqG,eAAJ;AACA,YAAIqH,iBAAJ;AACA,YAAI,YAAYpL,IAAhB,EAAsB;AAClB,gBAAIA,KAAKqL,MAAL,CAAYrH,OAAZ,CAAoB,GAApB,KAA4B,CAAC,CAAjC,EAAoC;AAChCoH,2BAAWpL,KAAKqL,MAAL,CAAYnH,KAAZ,CAAkB,GAAlB,CAAX;AACAH,yBAASqH,SAAS,CAAT,CAAT;AACH,aAHD,MAGO;AACHrH,yBAASK,SAASpE,KAAKqL,MAAd,CAAT;AACH;AACD,gBAAItH,UAAU,CAAC,CAAf,EAAkB;AACd,uBAAO,IAAP;AACH;AACD,gBAAIA,UAAU,CAAd,EAAiB;AAAC;AACd,uBAAO,IAAP;AACH,aAFD,MAEO,IAAIA,UAAU,CAAd,EAAiB;AAAC;AACrB,uBAAO5M,OAAOmU,WAAP,GAAqB,CAA5B;AACH,aAFM,MAEA,IAAIvH,UAAU,CAAd,EAAiB;AAAC;AACrB,oBAAIwH,UAAUH,SAAS,CAAT,CAAd;AACA,oBAAIjU,OAAOqU,KAAP,GAAeD,OAAnB,EAA4B;AACxB,2BAAO,KAAP;AACH,iBAFD,MAEO;AACH,2BAAO,IAAP;AACH;AAEJ,aARM,MAQA,IAAIxH,UAAU,CAAd,EAAiB;AAAC;AACrB;AACA;AACA;AACA;AACA;AACA,oBAAG5M,OAAOsU,aAAP,GAAqBL,SAAS,CAAT,CAAxB,EAAoC;AAChC,2BAAO,KAAP;AACH,iBAFD,MAEK;AACD,2BAAO,IAAP;AACH;AACJ;AACJ;AACD,eAAO,KAAP;AACH,KA1jCI;AA2jCLM,uBAAkB,2BAASC,QAAT,EAAkB;AAChC,YAAGxU,OAAOyU,WAAP,IAAqB,IAAxB,EAA6B;AACzBzU,mBAAOyU,WAAP,GAAqB,EAArB;AACH;AAEJ,KAhkCI;AAikCLb,eAAW,mBAAUrN,EAAV,EAAc;AACrB,YAAIsC,OAAO9J,WAAWwH,EAAX,CAAX;AACA,YAAIqG,eAAJ;AACA,YAAIqH,iBAAJ;AACA,YAAIpB,OAAO,IAAX;AACA,YAAI,YAAYhK,IAAhB,EAAsB;AAClB,gBAAIA,KAAKqL,MAAL,CAAYrH,OAAZ,CAAoB,GAApB,KAA4B,CAAC,CAAjC,EAAoC;AAChCoH,2BAAWpL,KAAKqL,MAAL,CAAYnH,KAAZ,CAAkB,GAAlB,CAAX;AACAH,yBAASqH,SAAS,CAAT,CAAT;AACH,aAHD,MAGO;AACHrH,yBAASK,SAASpE,KAAKqL,MAAd,CAAT;AACH;AACD,gBAAItH,UAAU,CAAd,EAAiB;AAAC;AACd,oBAAG7M,WAAW4S,eAAX,EAAH,EAAgC;AAC5B,wBAAIC,MAAMhU,QAAQ,UAAR,CAAV;AACAgU,wBAAIE,kBAAJ,CAAuB,YAAU;AACzB9S,+BAAOmU,WAAP;AACAtB,6BAAKrO,kBAAL,CAAwBwO,YAAxB;AACH,qBAHL;AAKH,iBAPD,MAOK;AACDhT,2BAAOmU,WAAP;AACH;AACJ,aAXD,MAWO,IAAIvH,UAAU,CAAd,EAAiB;AAAC;AACrB,oBAAI8H,OAAO9V,QAAQ,UAAR,CAAX;AACA,oBAAIiU,QAAO,IAAX;AACA,oBAAG9S,WAAW4S,eAAX,EAAH,EAAgC;AAC5B+B,yBAAKC,WAAL,CAAiB,UAASC,QAAT,EAAkB;AAC/B,4BAAG5U,OAAOyU,WAAP,IAAqB,IAAxB,EAA6B;AACzBzU,mCAAOyU,WAAP,GAAqB,EAArB;AACH;AACD,4BAAIzU,OAAOyU,WAAP,CAAmBlO,EAAnB,KAA0B,IAA9B,EAAmC;AAC/BvG,mCAAOyU,WAAP,CAAmBlO,EAAnB,IAAwB,EAAxB;AACH;AACD,4BAAI9B,OAAO,KAAX;AACA,6BAAI,IAAIsB,IAAI,CAAZ,EAAcA,IAAE/F,OAAOyU,WAAP,CAAmBlO,EAAnB,EAAuBqB,MAAvC,EAA8C7B,GAA9C,EAAkD;AAC9C,gCAAI8O,YAAY7U,OAAOyU,WAAP,CAAmBlO,EAAnB,CAAhB;AACA,gCAAGsO,aAAYD,QAAf,EAAyB;AACrBnQ,uCAAM,IAAN;AACA;AACH;AACJ;AACD,4BAAG,CAACA,IAAJ,EAAS;AACLzE,mCAAOyU,WAAP,CAAmBlO,EAAnB,EAAuB0D,IAAvB,CAA4B2K,QAA5B;AACA5U,mCAAOsU,aAAP,GAAuBtU,OAAOyU,WAAP,CAAmBlO,EAAnB,EAAuBqB,MAA9C;AACH;AACDiL,8BAAKrO,kBAAL,CAAwBwO,YAAxB;AACH,qBApBD;AAqBH,iBAtBD,MAsBK;AACDhT,2BAAOsU,aAAP;AACH;AACJ;AACJ;AACJ,KAtnCI;;AAwnCLnB,mBAAe,uBAAU5M,EAAV,EAAyB;AAAA,YAAZ4J,GAAY,uEAAN,IAAM;;AACpC,YAAGA,OAAO,IAAV,EAAe;AACX,iBAAK2E,gBAAL;AACA;AACH;AACD,YAAIjM,OAAO3J,iBAAiBqH,EAAjB,CAAX;AACA,YAAI2J,MAAM,CAAV;AACA,YAAI6E,UAAQ,CAAZ;AACA,YAAIlM,KAAKiL,QAAL,IAAiB,IAAjB,IAAyB9T,OAAOkQ,GAAP,IAAcrH,KAAKkL,IAAhD,EAAsD;AAAC;AACnD7D,kBAAMlQ,OAAOkQ,GAAP,GAAarH,KAAKkL,IAAxB;AACA,gBAAIlL,KAAK2K,IAAL,GAAY,CAAhB,EAAmB;AACf;AACA,oBAAIwB,YAAYC,KAAKC,KAAL,CAAY,IAAID,IAAJ,EAAZ,IAAwB,IAAxC,CAFe,CAE8B;AAC7CjV,uBAAOmV,UAAP,CAAkB5O,EAAlB,IAAwB,EAAC,MAAKA,EAAN,EAAS,YAAWsC,KAAK3B,IAAzB,EAA8B,aAAY8N,SAA1C,EAAxB;AACA,qBAAKF,gBAAL;AACH;AACD,gBAAIrH,SAAS,EAAb;AACA,gBAAI5E,KAAKuM,QAAL,GAAgB,CAApB,EAAuB;AAAC;;AAEpB,qBAAI,IAAIrP,IAAE,KAAKjC,WAAf,EAA2BiC,KAAG,KAAKhC,SAAnC,EAA8CgC,GAA9C,EAAkD;AAC9C,wBAAG/F,OAAO6F,MAAP,CAAcE,CAAd,KAAoBC,SAAvB,EAAiC;AAC7B,4BAAIqP,OAAOrW,gBAAgBgB,OAAO6F,MAAP,CAAcE,CAAd,EAAiBc,SAAjC,CAAX;AACAkO,mCAASlM,KAAKuM,QAAL,GAAc,EAAd,GAAiB,EAAjB,GAAoBC,KAAKnO,IAAzB,GAA+BmO,KAAKrO,GAA7C;AACH;AACJ;AACDhH,uBAAO+U,OAAP,GAAiBA,OAAjB;AACA/U,uBAAOsV,OAAP,GAAiB,MAAjB;AACAtV,uBAAOuV,MAAP,GAAgBhP,EAAhB;AACA,qBAAKpE,UAAL,CAAgBqE,MAAhB,GAAwB,IAAxB;AACH;AACJ;AACD,aAAKhC,kBAAL,CAAwBoJ,UAAxB,CAAmC,EAAC,OAAOsC,GAAR,EAAnC;AACAlQ,eAAOwQ,OAAP,CAAeN,GAAf;AACAlQ,eAAOwV,cAAP,CAAsBxV,OAAOmV,UAA7B;AACA,aAAK3Q,kBAAL,CAAwBwO,YAAxB;AACH,KA3pCI;AA4pCL;AACAlN,uBAAkB,6BAAU;AACxB,YAAI2P,UAASR,KAAKC,KAAL,CAAY,IAAID,IAAJ,EAAZ,IAAwB,IAArC,CADwB,CACkB;AAC1C,YAAIF,UAAU,CAAd;AACA,aAAK,IAAIxO,EAAT,IAAevG,OAAOmV,UAAtB,EAAkC;AAC9B,gBAAKnV,OAAOmV,UAAP,CAAkB5O,EAAlB,KAAyB,IAA9B,EAAmC;AAC/B;AACH;AACD,gBAAImP,WAAW,CAACD,UAAUzV,OAAOmV,UAAP,CAAkB5O,EAAlB,EAAsBoP,SAAjC,IAA4C,EAA3D,CAJ8B,CAIgC;AAC9D,gBAAI9M,OAAO3J,iBAAiBqH,EAAjB,CAAX;AACA,gBAAIqP,UAAU/M,KAAK3B,IAAL,GAAYlH,OAAOmV,UAAP,CAAkB5O,EAAlB,EAAsBsP,QAAhD;AACA,gBAAGH,WAAW7M,KAAK3B,IAAnB,EAAyB;AACrBwO,2BAAW7M,KAAK3B,IAAhB;AACH;AACD,gBAAI4O,cAAaJ,WAAWE,OAA5B;AACA,gBAAIC,WAAWhN,KAAK3B,IAAL,GAAY4O,WAAZ,GAA0BF,OAAzC;AACA,gBAAGC,YAAW,CAAd,EAAgB;AACZ7V,uBAAOmV,UAAP,CAAkB5O,EAAlB,IAAwB,IAAxB;AACH,aAFD,MAEK;AACDvG,uBAAOmV,UAAP,CAAkB5O,EAAlB,EAAsBsP,QAAtB,GAAiC5I,SAAS4I,QAAT,CAAjC;AACA,qBAAK1S,UAAL,IAAmB0F,KAAK2K,IAAL,GAAY,CAA/B;AACH;AACD,iBAAI,IAAIzN,IAAE,KAAKjC,WAAf,EAA2BiC,KAAG,KAAKhC,SAAnC,EAA8CgC,GAA9C,EAAkD;AAC9C,oBAAG/F,OAAO6F,MAAP,CAAcE,CAAd,KAAoBC,SAAvB,EAAiC;AAC7B,wBAAIqP,OAAOrW,gBAAgBgB,OAAO6F,MAAP,CAAcE,CAAd,EAAiBc,SAAjC,CAAX;AACAkO,+BAASlM,KAAK2K,IAAL,GAAUsC,WAAV,GAAsB,EAAtB,GAA0BT,KAAKrO,GAA/B,GAAmCqO,KAAKnO,IAAjD;AACH;AACJ;AACD,gBAAGlH,OAAO+V,WAAP,GAAmBD,WAAtB,EAAkC;AAC9B9V,uBAAO+V,WAAP,GAAqBD,WAArB;AACH;AACJ;AACD9V,eAAOwV,cAAP,CAAsBxV,OAAOmV,UAA7B;AACAJ,kBAAW9H,SAAS8H,OAAT,CAAX;AACA,YAAGA,UAAS,CAAZ,EAAe;AACX/U,mBAAO+U,OAAP,GAAiB9H,SAAS8H,OAAT,CAAjB;AACA/U,mBAAOsV,OAAP,GAAiB,SAAjB;AACA,iBAAKnT,UAAL,CAAgBqE,MAAhB,GAAyB,IAAzB;AACH;AACJ,KAnsCI;AAosCL;AACAsO,sBAAkB,4BAAY;AAC1B,YAAIkB,SAAO,CAAX;;AAEA,aAAK,IAAIzP,EAAT,IAAevG,OAAOmV,UAAtB,EAAiC;AAC7B,gBAAGnV,OAAOmV,UAAP,CAAkB5O,EAAlB,KAAyB,IAA5B,EACI;AACJ,gBAAIsC,OAAO3J,iBAAiBqH,EAAjB,CAAX;AACAyP,sBAAQnN,KAAK2K,IAAL,GAAY,CAApB;AACH;AACD,aAAKrQ,UAAL,GAAkB6S,MAAlB;AACA,aAAKxR,kBAAL,CAAwBwO,YAAxB;AACH,KAhtCI;AAitCL;AACA;;;AAIA;AACA;;AAEAiD,oBAztCK,8BAytCc;;AAEf,YAAI/F,MAAMlQ,OAAOkQ,GAAP,GAAa,GAAvB;AACA,aAAK1L,kBAAL,CAAwBoJ,UAAxB,CAAmC,EAAC,OAAOsC,GAAR,EAAnC;AACAlQ,eAAOwQ,OAAP,CAAeN,GAAf;AACA,aAAK1L,kBAAL,CAAwBwO,YAAxB;AACH,KA/tCI;AAiuCLkD,oBAjuCK,8BAiuCc;;AAEf,YAAIhG,MAAMlQ,OAAOkQ,GAAP,GAAa,EAAb,GAAkB,CAAlB,GAAsBlQ,OAAOkQ,GAAP,GAAa,EAAnC,GAAwC,CAAlD;AACA,aAAK1L,kBAAL,CAAwBoJ,UAAxB,CAAmC,EAAC,OAAOsC,GAAR,EAAnC;AACAlQ,eAAOwQ,OAAP,CAAeN,GAAf;AACA,aAAK1L,kBAAL,CAAwBwO,YAAxB;AACH,KAvuCI;AAwuCLmD,qBAxuCK,+BAwuCe;;AAEhB,YAAIxI,OAAO3N,OAAO2N,IAAP,GAAc,EAAzB;AACA,aAAKnJ,kBAAL,CAAwBoJ,UAAxB,CAAmC,EAAC,QAAQD,IAAT,EAAnC;AACA3N,eAAO8N,QAAP,CAAgBH,IAAhB;AACA,aAAKnJ,kBAAL,CAAwBwO,YAAxB;AACH,KA9uCI;AA+uCLoD,qBA/uCK,+BA+uCe;;AAEhB,YAAIzI,OAAO3N,OAAO2N,IAAP,GAAc,EAAd,GAAmB,CAAnB,GAAuB3N,OAAO2N,IAAP,GAAc,EAArC,GAA0C,CAArD;AACA,aAAKnJ,kBAAL,CAAwBoJ,UAAxB,CAAmC,EAAC,QAAQD,IAAT,EAAnC;AACA3N,eAAO8N,QAAP,CAAgBH,IAAhB;AACA,aAAKnJ,kBAAL,CAAwBwO,YAAxB;AACH,KArvCI;AAsvCLqD,oBAtvCK,8BAsvCc;;AAEf,YAAI3I,MAAM1N,OAAO0N,GAAP,GAAY,IAAtB;AACA,aAAKlJ,kBAAL,CAAwBoJ,UAAxB,CAAmC,EAAC,OAAOF,GAAR,EAAnC;AACA1N,eAAO6N,OAAP,CAAeH,GAAf;AACA;AACH;AACD;;AA7vCK,CAAT;AA+vCA","file":"BoxController.js","sourceRoot":"../../../../../assets/src/controller","sourcesContent":["/**\n * Created by bing on 20/04/2018.\n */\n\n//负责head展现和变换。\nlet StageConfig = require(\"StageConfig\");\nlet BlockConfig = require(\"BoxConfig1\");\nlet CycleConfig = require(\"CycleConfig\");\nlet ToolConfig = require(\"ToolConfig\");\nlet AttributeConfig = require(\"AttributeConfig\");\nlet AcceleratorConfig = require(\"AcceleratorConfig\");\nlet EfficiencyConfig = require(\"EfficiencyConfig\");\nlet BoxConfig = require(\"BoxConfig\");\nlet RewardConfig = require(\"RewardConfig\");\n\n\nlet GameType = require(\"GameType\");\nlet GameUtils = require(\"GameUtils\");\nlet GameState = require(\"GameState\");\nlet BlockBigFactory = require(\"BlockBigFactory\");\nlet BlockSmallFactory = require(\"BlockSmallFactory\");\nlet RewardItemFactory = require(\"RewardItemFactory\");\nlet UILeadFactory = require(\"UILeadFactory\");\n\nlet SpriteFrameCenter = require(\"SpriteFrameCenter\");\nlet ParticleSystemCenter = require(\"ParticleSystemCenter\");\nlet SkeletonDataCenter = require(\"SkeletonDataCenter\");\nlet GameConfig = require(\"GameConfig\");\n// let GameMenuController = require('GameMenuController');\n\nlet Global = require('Global');\n\nconst GameHeight = 514;\nconst GameCenterY = 0;\nconst BaseGame = GameHeight/2;\n\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        gameNode: cc.Node,\n        camera: cc.Camera,\n        BlockBig: cc.Prefab,\n        BlockSmall: cc.Prefab,\n        MarginsBig: cc.Prefab,\n        MarginsSmall: cc.Prefab,\n        RewardItem: cc.Prefab,\n        UIBottom: cc.Prefab,\n        uilead: cc.Prefab,\n        inviteUI:cc.Prefab,\n        inviteItem:cc.Prefab,\n        Sky: cc.Node,\n        Bgbz: cc.Node,\n        Underground: cc.Node,\n        motionStreak: cc.MotionStreak,\n        // hammer: sp.Skeleton,\n        boxSpine: sp.Skeleton,\n        btnbox: cc.Button,\n        GameMenu: cc.Node,\n        treasure: cc.Button,\n        upgradView: cc.Node,\n        openbox: cc.Node,\n        type: {\n            visible: false,\n            default: 0\n        },\n        blockWidth: 100,\n        blockBlank: {\n            visible: false,\n            default: 0\n        },\n        moveNum: {\n            visible: false,\n            default: 0\n        },\n        margins: {\n            visible: false,\n            default: 0\n        },\n        curMaxLine: {\n            visible: false,\n            default: 0\n        },\n        canTouch: {\n            visible: false,\n            default: true\n        },\n        previousPt: {\n            visible: false,\n            default: null\n        },\n        Hatting: {\n            visible: false,\n            default: false\n        },\n        HattingPos: {\n            visible: false,\n            default: null\n        },\n        accelerHammer: {\n            visible: false,\n            default: 1\n        },\n        accelerGold: {\n            visible: false,\n            default: 1\n        },\n        efficeGold: 0,\n        startClock:3,\n        gameState: GameState.init,//0 init 1 playing 2 rolling 3 end\n    },\n\n\n    onLoad: function () {\n        this.winsize = cc.winSize;\n        this.BaseHeight = this.winsize.height / 2;\n        this.BaseWidth = this.winsize.width / 2;\n        this.hammerStart = 1;//表示锤子的起始id\n        this.hammerEnd = 10;//表示锤子的最后一个id\n        this.boxLeadNode = null;//box的引导节点\n        this.rowNum = 0;\n        this.startCameraY=0;\n        this.blockLeadNode = null;\n        this.blockPosNode = null;\n\n        SpriteFrameCenter.preLoadAtlas(\"png/box\", this.initdata.bind(this));\n        this.GameMenuController = cc.find(\"Canvas/GameMenu\").getComponent(\"GameMenuController\");\n        Global.initInfo();\n        this.blocks = [];\n        this.marginlist = [];\n        this.hammers = {};\n        this.rewardItem = [];\n        this.accelerHammer = 1;\n        this.accelerGold = 1;\n        this.startPos = -GameHeight / 2;\n        this.boxSpine.setCompleteListener(trackEntry => {\n            var animationName1 = trackEntry.animation ? trackEntry.animation.name : \"\";\n            cc.log(\"recordSpine [track %s][animation %s] end.\", trackEntry.trackIndex, animationName1);\n            // this.restart();\n            this.addItems();\n\n        });\n        this.firstblock= true;\n        this.firstOpen = true;\n    },\n    start: function () {\n        this.GameMenuController.initInfo();\n        this.hammers = {};\n        let timescale = 1;\n        let hammer = Global.hammer;\n        this.initEfficienyInfo();//[改 延迟执行]\n        for (var i = this.hammerStart; i <= this.hammerEnd; i++) {\n            if (hammer[i] == undefined)\n                continue;\n            let node = new cc.Node();\n            let nodehammer = node.addComponent(sp.Skeleton);\n            let info = ToolConfig[i];\n            let animation = info.animation;\n            SkeletonDataCenter.addSkeletonData(animation, nodehammer);\n            this.GameMenu.addChild(node);\n            this.hammers[hammer[i].id] = nodehammer;\n            nodehammer.node.active = false;\n            let j=i;\n            nodehammer.setCompleteListener(trackEntry => {\n                var animationName = trackEntry.animation ? trackEntry.animation.name : \"\";\n                cc.log(\"HammerSpine [track %s][animation %s] end.\", trackEntry.trackIndex, animationName);\n                nodehammer.node.active = false;\n                if (this.checkCanHammer(j)) {\n                    this.smCallback(j);\n                }\n            });\n            let attribute = Global.hammer[i].attribute;\n            let conf1 = AttributeConfig[attribute];\n            nodehammer.timeScale = 0.17 * conf1.att / parseFloat(conf1.time) * this.accelerHammer;\n        }\n\n    },\n    update: function () {\n        // this.cameraCentPosY();\n    },\n    restart: function () {\n\n        if (StageConfig[Global.hard+1] != null && StageConfig[Global.hard+1] != undefined) {\n            Global.hard++;\n            Global.saveHard(Global.hard);\n        }\n        this.deleteBoxLead();\n        this.boxSpine.node.active = false;\n        for (let i = 1; i < 4; i++) {\n            // let node = this.rewardItem[i];\n            this.rewardItem[i].destroy();\n            // if(cc.isValid( node)){\n            //     node.destroy();\n            // }\n        }\n        this.rewardItem = [];\n        // this.addItems();\n        this.initdata();\n        this.gameState = GameState.hatting;\n    },\n    initdata: function () {\n        let floorNum = StageConfig[Global.hard].layer;\n        for (var i = 0; i < BlockConfig.length; i++) {\n            if (BlockConfig[i].blockwidth == StageConfig[Global.hard].size) {\n                this.type = BlockConfig[i].type;\n                break;\n            }\n        }\n\n        this.rowNum = BlockConfig[this.type].count;\n        this.blockWidth = BlockConfig[this.type].blockwidth;\n        this.blockBlank = BlockConfig[this.type].blank;\n        this.margins = BlockConfig[this.type].margins;\n\n        this.addBlocks();\n        this.cameraStartPosY();\n        this.changeBlockLead();\n        this.btnbox.node.active = true;\n        this.playHammers();\n        this.initTreasure();\n        if (this.firstOpen) {\n            this.GameMenuController.addUIBottom();\n            this.firstOpen = false;\n        }\n\n\n    },\n    //-----------------------------锤子部分 start-------------------------\n    playHammerSpine: function (hammerpos) {\n\n        this.hammers[hammerpos].node.active = true;\n        this.hammers[hammerpos].setAnimation(0, \"newAnimation\", true);\n    },\n    playHammers: function () {\n        for (var i = this.hammerStart; i <= this.hammerEnd; i++) {\n            if (this.hammers[i] != undefined) {\n                this.setSmPosition(i);\n            }\n        }\n    },\n    stopHammerSpine: function (hammerpos) {\n        this.hammers[hammerpos].node.active = false;\n    },\n    addHammer: function (id) {\n        let node = new cc.Node();\n        let hammer = node.addComponent(sp.Skeleton);\n        let info = ToolConfig[id];\n        let animation = info.animation;\n        let conf = AttributeConfig[info.attribute];\n\n        SkeletonDataCenter.addSkeletonData(animation, hammer);\n        this.GameMenu.addChild(node);\n        this.hammers[id] = hammer;\n        hammer.node.active = false;\n        hammer.setCompleteListener(trackEntry => {\n            var animationName = trackEntry.animation ? trackEntry.animation.name : \"\";\n            cc.log(\"HammerSpine [track %s][animation %s] end.\", trackEntry.trackIndex, animationName);\n            hammer.node.active = false;\n            if (this.checkCanHammer(id)) {\n                    this.smCallback(id);\n            }\n        });\n        let timescale = 0.17 * conf.att / parseFloat(conf.time) * this.accelerHammer;\n        hammer.timeScale = timescale;\n    },\n    changeHammerSpine: function (data) {\n        this.hammer.skeletonData = data;\n    },\n\n\n    checkCanHammer: function (id) {\n        var hammer = Global.hammer;\n        if (hammer[id] != undefined && hammer[id].attribute != -1)\n            return true;\n        return false;\n    },\n    setSmPosition: function (hammerpos) {\n        if(this.blockPosNode !=null){\n            if (this.HattingPos == null) {\n                this.HattingPos = {};\n            }\n            let startLine = this.blockPosNode.x;\n            let startRow = this.blockPosNode.y;\n            this.HattingPos[hammerpos] = this.blockPosNode;\n            let position = this.hammerpos(startLine,startRow);\n            console.log(\"choose:\",this.HattingPos[hammerpos]);\n            this.hammers[hammerpos].node.position = position;\n            this.hammers[hammerpos].node.active = true;\n            this.playHammerSpine(hammerpos);\n            this.blockPosNode = null;\n            return;\n        }\n        let realwidth = this.blockWidth + this.blockBlank;\n        let maxline = this.curMaxLine;\n        let maxrow = this.totoalRowNum(0);\n        if (maxline == 0 && maxrow == 0) {\n            this.HattingPos = null;\n            // this.sm.node.visible = false;\n            this.hammers[hammerpos].node.active = false;\n            return;\n        }\n\n        let range = this.geScreenRange();\n        let line = this.curMaxLine;\n        let find = false;\n        let canclick = [];\n        let curline = line;\n        for (; curline >= 0; curline--) {\n            for (var i = 0; i < this.rowNum; i++) {//当前行可以删除的\n                if (this.blocks[curline] && this.checkCanDestroy(curline, i)) {\n                    let find = false;\n                    for (var j = this.hammerStart; j <= this.hammerEnd; j++) {\n                        if (this.HattingPos && this.HattingPos[j]) {\n                            if (this.HattingPos[j].x == curline && i == this.HattingPos[j].y) {\n                                find = true;\n                                break;\n                            }\n                        }\n                    }\n                    if (!find) {\n                        canclick.push(i);\n                    }\n                }\n            }\n            if (canclick.length > 0)\n                break;\n        }\n        if (canclick.length == 0) {\n            this.HattingPos[hammerpos] = null;\n            return;\n        }\n        let num = GameUtils.randomInt(0, canclick.length - 1);\n        let row = canclick[num];\n        let location = this.hammerpos(curline, row);\n        if (this.HattingPos == null) {\n            this.HattingPos = {};\n        }\n        this.HattingPos[hammerpos] = {x: curline, y: row};\n        console.log(\"choose:\",this.HattingPos[hammerpos]);\n        this.hammers[hammerpos].node.position = location;\n        this.hammers[hammerpos].node.active = true;\n        this.playHammerSpine(hammerpos);\n    },\n    //根据小块的位置 过的特效文件\n    getEffByBlock(line, row) {\n\n        let type = this.type == 0 ? \"BlockBig\" : \"BlockSmall\";\n        let node = this.blocks[line][row].getComponent(type);\n        return node.getPngId();\n    },\n    geScreenRange: function () {\n        let max = this.curMaxLine;\n        let cameraPosY = this.camera.node.getPositionY();\n        let min = 0;\n        let realwidth = this.blockWidth + this.blockBlank;\n        if (cameraPosY <= this.BaseHeight) {\n            min = 0;\n        } else {\n            let maxPosY = max * realwidth;\n            let canshowy = (maxPosY - cameraPosY + this.BaseHeight) / realwidth;\n            min = Math.floor(max - canshowy);\n        }\n        return {max: max, min: min};\n    },\n    //根据块的位置计算锤子的位置\n    hammerpos: function (line, row) {\n        let cameraY = this.camera.node.getPositionY();\n        let gameY = this.gameNode.y;\n        let realwidth = this.blockWidth + this.blockBlank;\n        let realx = row * realwidth + this.margins + this.blockBlank;\n        let realy = line * realwidth - cameraY ;\n        let hamX = realx - this.BaseWidth - 42 + this.blockWidth;\n        let hamY = realy - 42;\n        return cc.p(hamX, hamY);\n\n    },\n    smCallback: function (hammerpos) {\n        if (this.HattingPos != null && this.HattingPos[hammerpos] != null) {\n\n            let y = this.HattingPos[hammerpos].y;\n            let x = this.HattingPos[hammerpos].x;\n            console.log(\"hammer:\",x,y);\n            if (cc.isValid(this.blocks[x][y])) {\n                this.destroyBlock(x, y);\n            }\n            // this.changeBlockLead(true);\n            this.setSmPosition(hammerpos);\n\n\n        }\n    },\n    //-----------------------------锤子部分 end-------------------------\n    //-----------------------------block start-------------------------\n    resetMarginList: function () {\n        if (this.marginlist.length > 0) {\n            for (let i = 0; i < this.marginlist.length; i++) {\n                let node = this.marginlist[i];\n                if (cc.isValid(node)) {\n                    node.destroy();\n                }\n            }\n        }\n        this.marginlist = [];\n    },\n    resetBlockList: function () {\n        if (this.blocks.length > 0) {\n            for (let i = 0; i < this.blocks.length; i++) {\n                for (let j = 0; j < this.blocks[i].length; j++) {\n                    let node = this.blocks[i][j];\n                    if (cc.isValid(node)) {\n                        node.destroy();\n                    }\n                }\n            }\n        }\n        this.blocks = [];\n    },\n    addBlocks: function () {\n\n        this.resetBlockList();\n        this.resetMarginList();\n        let floorNum = StageConfig[Global.hard].layer;\n        for (var i = 0; i < floorNum - 1; i++) {\n\n            var lineinfo = this.addLines(this.getPngName(StageConfig[Global.hard].cycleID, i), i);\n\n            this.blocks.push(lineinfo);\n            lineinfo = [];\n        }\n        let topline = this.addLines(StageConfig[Global.hard].top, i);\n        this.blocks.push(topline);\n    },\n    addLines: function (pngname, thisNum) {\n\n        let conf = BlockConfig[this.type];\n        let count = conf.count;\n        let factory = this.type == 0 ? BlockBigFactory : BlockSmallFactory;\n        let curX = conf.margins + conf.blank - this.BaseWidth;\n        let curY = thisNum * (this.blockWidth + conf.blank) + this.startPos;\n        let lineArray = [];\n        let left = factory.createMargins(pngname);\n\n        left.position = cc.p(conf.margins / 2 - this.BaseWidth, curY + this.blockWidth / 2);\n        this.gameNode.addChild(left);\n        this.marginlist.push(left);\n        let right = factory.createMargins(pngname);\n        let endpos = this.BaseWidth - conf.margins / 2;\n        right.position = cc.p(endpos, curY + this.blockWidth / 2);\n        this.gameNode.addChild(right);\n        this.marginlist.push(right);\n\n        for (var i = 0; i < count; i++) {\n            let node = factory.create(pngname);\n            node.position = cc.p(curX + this.blockWidth / 2, curY + this.blockWidth / 2);\n            curX += this.blockWidth + conf.blank;\n            this.gameNode.addChild(node);\n            lineArray.push(node);\n        }\n\n        return lineArray;\n    },\n\n    //根据 获得 图片的名字\n    getPngName(cycleID, thisNum) {\n        let thisID;\n        if (cycleID.indexOf(\";\") != -1) {\n            let cycleArry = cycleID.split(\";\");\n            let getnum = GameUtils.randomInt(0, cycleArry.length - 1);\n            thisID = cycleArry[getnum];\n        } else {\n            thisID = parseInt(cycleID);\n        }\n        let neednumber = 0;\n        for (var i = 1; i <= 10; i++) {\n            if (CycleConfig[thisID][\"num\" + i] == 0) {\n                i = 0;\n                continue;\n            }\n            neednumber += CycleConfig[thisID][\"num\" + i];\n            if (neednumber >= thisNum) {\n                return CycleConfig[thisID][\"block\" + i]\n            }\n            if (i == 10) {\n                i = 0;\n            }\n        }\n    },\n    //销毁砖块\n    destroyBlock: function (line, row) {\n\n        if (!this.blocks[line])\n            return;\n        let node = this.blocks[line][row];\n\n        if (node != null) {\n            let location = this.hammerpos(line, row);\n            let texiao = this.getEffByBlock(line, row);\n             console.log(\"destroylog:\", line, \":\", row, location);\n            ParticleSystemCenter.addParticleForNode(texiao + \".plist\", this.GameMenuController.node, location);\n            node.removeFromParent(true);\n            this.blocks[line][row] = null;\n            this.destroyUpdate();\n            this.cameraCentPosY();\n        }\n        this.firstblock = false;\n        this.startClock--;\n        this.changeBlockLead();\n\n\n    },\n    changeBlockLead:function(){\n        let bool = this.startClock>0;\n        // if(this.startClock>0){\n        //     if(this.HattingPos && this.HattingPos[1]){\n        //         this.blockLead(bool,this.HattingPos[1].x,this.HattingPos[1].y);\n        //     }else{\n        //         this.blockLead(bool,2,2+this.startClock);\n        //     }\n        // }else{\n        //     this.blockLead(bool);\n        // }\n\n\n        if(Global.hard == 1 && bool){\n            if(!this.blockLeadNode){\n                var node = UILeadFactory.create();\n                this.blockLeadNode= node;\n                this.gameNode.addChild(node);\n            }\n            let row =3+this.startClock;\n            let line = 2;\n\n            let position = this.hammerpos(line,row);\n            position.y = position.y-216;\n            this.blockLeadNode.position = position;\n            this.blockPosNode = {x: line,y:row};\n        }else {\n            if (this.blockLeadNode) {\n                this.blockLeadNode.removeFromParent(true);\n                this.blockLeadNode = null;\n                this.blockPosNode = null;\n            }\n\n        }\n\n    },\n    checkCanDestroy: function (line, row) {\n        if (!this.blocks[line] || !this.blocks[line][row])\n            return false;\n        let floorNum = StageConfig[Global.hard].layer;\n        if (line >= floorNum - 1)\n            return true;\n        let node;\n        node = this.blocks[line + 1][row];\n        if (!cc.isValid(node)) {\n            return true;\n        }\n        if (line > 0) {\n            node = this.blocks[line - 1][row];\n            if (!cc.isValid(node)) {\n                return true;\n            }\n        }\n        if (row > 0 && row < this.rowNum - 1) {\n            node = this.blocks[line][row - 1];\n            if (!cc.isValid(node)) {\n                return true;\n            }\n            node = this.blocks[line][row + 1];\n            if (!cc.isValid(node)) {\n                return true;\n            }\n        } else if (row == 0) {\n            node = this.blocks[line][row + 1];\n            if (!cc.isValid(node)) {\n                return true;\n            }\n        } else if (row == this.rowNum - 1) {\n            node = this.blocks[line][row - 1];\n            if (!cc.isValid(node)) {\n                return true;\n            }\n        }\n        return false;\n    },\n    destroyUpdate: function () {\n\n        let myinfo = {};\n        myinfo.exp = Global.exp + 1;\n        myinfo.gold = Global.gold + 1 * (this.accelerGold) + this.efficeGold;\n        this.GameMenuController.updateDate(myinfo);\n        Global.saveExp(myinfo.exp);\n        Global.saveGold(myinfo.gold);\n\n    },\n    maxLineNum: function () {\n        var max = 0;\n        let floorNum = StageConfig[Global.hard].layer;\n        for (var i = 0; i < floorNum; i++) {\n            for (var j = 0; j < this.rowNum; j++) {\n                if (this.blocks && this.blocks[i] && this.blocks[i][j]) {\n                    var node = this.blocks[i][j];\n                    if (!cc.isValid(node))\n                        continue;\n                    if (i > max) {\n                        max = i;\n                    }\n                    break;\n                }\n            }\n        }\n        return max;\n    },\n\n    totoalRowNum: function (line) {//line 行拥有点的数量\n        var max = 0;\n        for (var j = 0; j < this.rowNum; j++) {\n            var node = this.blocks[line][j];\n            if (!cc.isValid(node))\n                continue;\n            max++;\n        }\n        return max;\n    },\n    //-----------------------------block   end-------------------------\n    //-----------------------------camera   start-------------------------\n\n    cameraCentPosY: function () {\n\n        let maxline = this.maxLineNum();\n        if (this.curMaxLine <= maxline) {\n            return;\n        }\n        let move = this.curMaxLine - maxline;\n        this.curMaxLine = maxline;\n        let oldY = this.camera.node.getPositionY();\n        if (oldY <= 0) {\n            return;\n        }\n        let newY = oldY - this.blockWidth * move;\n        let moveY = 0;\n        if (newY >= 0) {\n            moveY = newY;\n        } else {\n            moveY = 0;\n        }\n        let location = cc.p(0, moveY);\n        let action1 = cc.moveTo(0.1, location);\n        this.camera.node.runAction(action1);\n        let ralmovelength = oldY - newY;\n        for (var i = this.hammerStart; i < this.hammerEnd; i++) {\n            if(this.hammers[i] != undefined){\n                let location=this.hammers[i].node.position;\n                let action2 = cc.moveTo(0.1,{x:location.x,y:location.y+ralmovelength})\n                this.hammers[i].node.runAction(action2);\n            }\n        }\n    },\n\n    cameraStartPosY: function () {\n        let floorNum = StageConfig[Global.hard].layer;\n        let height = floorNum * (this.blockWidth + this.blockBlank);\n        //地下\n        this.Underground.height = height;\n        let posbottom = (height - GameHeight) / 2;\n        this.Underground.y = posbottom;\n        //地面\n        let totoal = this.Bgbz.height + height - 50;\n        let skyposy;\n        let bzYbottom;\n        let other = GameHeight - totoal;\n        bzYbottom = (totoal + height - GameHeight) / 2 - 25;\n        this.Bgbz.y = bzYbottom;\n        let movePos = 0;\n        if (other > 0) {\n            this.Sky.active = true;\n            this.Sky.height = other + 10;\n            skyposy = (GameHeight - other) / 2;\n            this.Sky.y = skyposy;\n            // this.camera.node.setPositionY(0);\n            movePos = 0;\n        } else {\n            this.Sky.active = false;\n            // this.camera.node.setPositionY(-other);\n            movePos = -other;\n        }\n        this.camera.node.setPositionY(movePos);\n        this.startCameraY = movePos;\n        this.curMaxLine = floorNum - 1;\n    },\n    //-----------------------------camera   end-------------------------\n    //----------------------------- treasure start----------------------\n    playBoxSpine: function () {\n        this.boxSpine.node.active = true;\n        this.boxSpine.setAnimation(0, \"newAnimation\", false);\n    },\n    stopBoxSpine: function () {\n        this.boxSpine.node.active = false;\n    },\n    initTreasure: function () {\n        let BoxID = StageConfig[Global.hard].box;\n        let BoxConf = BoxConfig[BoxID];\n        this.treasure.normalSprite = SpriteFrameCenter.getFrameFromAtlas(\"png/box\", BoxConf.icon + \".png\");\n        this.treasure.pressedSprite = SpriteFrameCenter.getFrameFromAtlas(\"png/box\", BoxConf.icon + \".png\");\n        this.treasure.hoverSprite = SpriteFrameCenter.getFrameFromAtlas(\"png/box\", BoxConf.icon + \".png\");\n        this.treasure.disabledSprite = SpriteFrameCenter.getFrameFromAtlas(\"png/box\", BoxConf.icon + \".png\");\n        let animation = BoxConf.animation;\n        SkeletonDataCenter.addSkeletonDataWait(animation, this.boxSpine);\n        this.treasure.node.y = -GameHeight / 2 + this.blockWidth + 35 - 20;\n        this.boxSpine.node.y = -GameHeight / 2 + this.blockWidth + 35 - 20+103;\n        // let loction  = this.gameNode.convertToWorldSpace(this.treasure.node.position);\n        // let loction1 = this.openbox.convertToNodeSpace(loction);\n        // this.boxSpine.node = loction1;\n\n    },\n    addItems: function () {\n\n        let hard = Global.hard;\n        let boxID = StageConfig[hard].box;\n        let rewardID = BoxConfig[boxID].reward;\n        let conf = RewardConfig[rewardID];\n        let num = conf.num;\n        let itemdata = {};\n        let totoal = 0;\n        let reward = {};\n        let max = 0;\n        for (let i = 1; i < 7; i++) {\n            if (conf['rate' + i] != 0) {\n                totoal = conf['rate' + i];\n                if (i == 1) {\n                    itemdata[i] = totoal;\n                    max = itemdata[i];\n                } else {\n                    itemdata[i] = itemdata[i - 1] + totoal;\n                    max = itemdata[i];\n                }\n            }\n        }\n        for (let j = 1; j <= num; j++) {\n            let random = GameUtils.random(max);\n            for (let z = 1; itemdata[z] != undefined; z++) {\n                if (itemdata[z] < random) {\n                    continue;\n                }\n                reward[j] = conf['item' + z];\n                break;\n            }\n        }\n        let gold = 0;\n        let gem = 0;\n        let str = \"\";\n        for (let i = 1; i <= num; i++) {\n            if (reward[i] != undefined) {\n                str += reward[i] + \"--\";\n                if (reward[i].indexOf(\";\") != -1) {\n                    let rewardarry = reward[i].split(\";\");\n                    if (rewardarry[0] == 1001) {\n                        gold += parseInt(rewardarry[1]);\n                    } else if (rewardarry[0] == 1002) {\n                        gem += parseInt(rewardarry[1]);\n                    }\n                }\n            }\n            this.createRewardItem(reward[i], i);\n            this.openbox.active = true;\n        }\n        if (gold > 0 || gem > 0) {\n            let golds = Global.gold + gold;\n            let gems = Global.gem + gem;\n            this.GameMenuController.updateDate({gold: golds, gem: gems});\n            Global.saveGold(golds);\n            Global.saveGem(gems);\n        }\n\n    },\n    createRewardItem: function (reward, i) {\n        if (this.rewardItem[i]) {\n            this.rewardItem[i].destroy();\n            this.rewardItem[i] = null;\n        }\n        let start = -400 + i * 200;\n\n        let node = RewardItemFactory.create(reward);\n        let locationX = this.treasure.node.position.x;\n        let locationY = this.treasure.node.position.y+103;\n\n        this.rewardItem[i] = (node);\n        node.position = cc.p(locationX,locationY);\n        let action = cc.moveTo(0.5, cc.p(start, 100));\n        let action2 = cc.callFunc(() => {\n            node.getComponent(\"RewardItem\").setFinish();\n            this.canTouch = true;\n        }, this);\n        // node.runAction(cc. moveTo(0.5,cc.p(start,-20)));\n        this.openbox.addChild(node);\n        node.runAction(cc.sequence(action, action2));\n    },\n    onClickTreasure: function (event) {\n        var maxlinenum = this.maxLineNum();\n        var totoalRowNum = this.totoalRowNum(0);\n        if (maxlinenum != 0 || totoalRowNum != 0) {\n            this.touchEndPoint = event.getLocation();\n\n            this.updateTouch(this.touchEndPoint);\n            return;\n        }\n        this.btnbox.node.active = false;\n        this.gameState = GameState.end;\n        this.canTouch = false;\n        this.openbox.active= true;\n        this.playBoxSpine();\n    },\n    addBoxLead:function(){\n        if(Global.hard > 1)\n            return;\n        var maxlinenum = this.maxLineNum();\n        var totoalRowNum = this.totoalRowNum(0);\n        if (maxlinenum == 0 && totoalRowNum == 0) {\n            let node = UILeadFactory.create();\n            node.position= this.treasure.node.position;\n            node.ratation = 180;\n            this.boxLeadNode = node;\n            this.gameNode.addChild(node);\n        }\n    },\n    deleteBoxLead:function(){\n        if(this.boxLeadNode){\n            this.boxLeadNode.removeFromParent(true);\n            this.boxLeadNode= null;\n        }\n    },\n    //-----------------------------treasure end--------------------------\n    //-----------------------------touch   start-------------------------\n    updateTouch: function (point) {\n        let cameraY = this.camera.node.getPositionY();\n        let gameY = this.gameNode.y;\n        let realwidth = this.blockWidth + this.blockBlank;\n        var line = Math.floor((point.y + cameraY) / realwidth);\n        var row = Math.floor((point.x - this.margins - this.blockBlank) / realwidth);\n        let find = false;\n        if (this.checkCanDestroy(line, row)) {\n            for (var i = this.hammerStart; i <= this.hammerEnd; i++) {\n                if (this.HattingPos != null && this.HattingPos[i] != null && this.HattingPos[i] != undefined) {\n                    if (this.HattingPos[i].x == line && this.HattingPos[i].y == row) {\n                        this.hammers[i].node.active = false;\n                        // this.smCallback(i);\n\n                        this.destroyBlock(line, row);\n                        this.setSmPosition(i);\n                        find = true;\n                        break;\n                    }\n                }\n            }\n            if (!find) {\n                this.destroyBlock(line, row);\n            }\n        }\n        // this.changeBlockLead(true);\n    },\n    touchStartCallBack: function (location1) {\n\n        if (!this.canTouch) {\n            return;\n        }\n\n        console.log(\"touchStartCallBack\");\n\n        if (this.gameState == GameState.end) {\n            this.openbox.active = false;\n            this.restart();\n        }\n\n        if(this.touchState == undefined ||( this.touchState != 'start'  && this.touchState != 'move')){\n            this.touchState = 'start';\n        }else{\n            this.touchState = 'mult';\n        }\n        if(this.touchState == 'mult'){\n            console.log(\"藏起来\");\n            this.motionStreak.node.active = false;\n        }\n        let location= this.gameNode.convertToNodeSpace(location1);\n        this.motionStreak.node.setPositionX(location1.x - this.BaseWidth);\n        this.motionStreak.node.setPositionY(location1.y - this.BaseHeight);\n        this.motionStreak.reset();\n\n    },\n\n    touchCancelCallBack: function (location1) {\n        let location= this.gameNode.convertToNodeSpace(location1);\n        this.updateTouch(location);\n        this.isTouching = false;\n        this.motionStreak.reset();\n        this.motionStreak.node.active = true;\n    },\n\n    touchEndCallBack: function (location1) {\n        let location= this.gameNode.convertToNodeSpace(location1);\n        this.updateTouch(location);\n        this.isTouching = false;\n        console.log(\"touchEndCallBack\");\n        this.motionStreak.reset();\n        this.previousPt=null;\n        this.motionStreak.node.active = true;\n    },\n    touchMoveCallBack: function (location1) {\n        let location= this.gameNode.convertToNodeSpace(location1);\n        if (!this.canTouch) {\n            return;\n        }\n        this.touchState =\"move\";\n        console.log(\"touchMoveCallBack\");\n        this.motionStreak.node.setPositionX(location1.x - this.BaseWidth);\n        this.motionStreak.node.setPositionY(location1.y - this.BaseHeight);\n        if (location.x < this.margins || location.x > (2 * this.BaseWidth - this.margins\n            || location.y < 216)) {\n            this.motionStreak.reset();\n            return;\n        }\n        this.updateTouch(location);\n        // this.previousPt = location;\n        // let motionpos = this.node.convertToNodeSpace(location1);\n        // this.motionStreak.node.position=motionpos;\n    },\n    //多点触控\n    multMoveCallBack:function(location01,location02 = null){\n        this.touchState =\"mult\";\n        this.motionStreak.reset();\n        let location1 = this.gameNode.convertToNodeSpace(location01);\n        // let location2 = this.gameNode.convertToNodeSpace(location02);\n        // console.log(\"1\",location1);\n        // console.log(\"2\",location2);\n        if(this.previousPt == null){\n            this.previousPt={};\n            this.previousPt[0]= location1;\n            // this.previousPt[1]= location2;\n            return;\n        }\n        var distance = cc.pSub( this.previousPt[0],location1);\n        // console.log(\"distance\",distance);\n        if(distance.y != 0){\n            let origin = this.camera.node.getPositionY();\n            let endpos =( origin+distance.y)*0.5;\n            if(endpos <0 ){\n                endpos =0;\n            }\n            if(endpos >this.startCameraY){\n                endpos = this.startCameraY;\n            }\n            if(endpos== 0)\n                return;\n            let move = origin - endpos;\n            this.camera.node.setPositionY(endpos);\n            for (var i = this.hammerStart; i < this.hammerEnd; i++) {\n                if(this.hammers[i] != undefined){\n                    let location=this.hammers[i].node.position;\n                    // let action2 = cc.moveTo(0.1,{x:location.x,y:location.y+move})\n                     // this.hammers[i].node.runAction(action2);\n                    this.hammers[i].node.setPositionY(location.y+move);\n                }\n            }\n        }\n    },\n    //-----------------------------touch   end-------------------------\n    //-----------------------------bottom   start-------------------------\n\n\n\n    eventcallback: function (type, id, string = null) {\n        // let node= this.itemList.indexOf(sender);\n        switch (type) {\n            case 0:\n                if (string == null){\n                    //视频激励\n                    if(GameConfig.isFBInstantGame()){\n                        let FBP = require(\"FBPlugin\");\n                        self = this;\n                        FBP.RewardedVideoAsync(function(){\n                                self.accleleratorChange(id);\n                                self.GameMenuController.updateButtom();\n                            }\n                        );\n                    }else{\n                        this.accleleratorChange(id);\n                    }\n\n                }\n                else {\n                    if (string == 'finish') {\n                        this.accleleratorrRecover(id);\n                    }\n                }\n                break;\n            case 1:\n                this.toolChange(id);\n                break;\n            case 2:\n                this.efficiencyAdd(id,string);\n                break;\n        }\n    },\n    //广告加速开始\n    accleleratorChange: function (id) {\n        let conf = AcceleratorConfig[id];\n        Global['bar' + id] = conf.time;\n        this.changeHammerSpeed();\n        this.GameMenuController.updateButtom();\n\n    },\n    //广告加速结束\n    accleleratorrRecover: function (id) {\n        this.changeHammerSpeed();\n        this.GameMenuController.updateButtom();\n    },\n\n    changeHammerSpeed: function () {\n        let speedHammer = 0;\n        let speedGold = 0;\n        for (let i = 1; i <= 2; i++) {\n            if (Global['bar' + i] > 0) {\n                speedHammer += AcceleratorConfig[i].speed;\n                speedGold += AcceleratorConfig[i].coin;\n            }\n        }\n        if (speedHammer == 0) {\n            speedHammer = 1;\n        }\n        if (speedGold == 0) {\n            speedGold = 1;\n        }\n        this.accelerHammer = speedHammer;\n        this.accelerGold = speedGold;\n        for (var i = this.hammerStart; i <= this.hammerEnd; i++) {\n            if (this.hammers[i] != undefined) {\n                let conf1 = AttributeConfig[Global.hammer[i].attribute];\n                this.hammers[i].timeScale = 0.17 * (conf1.att / parseFloat(conf1.time)) * this.accelerHammer;\n            }\n        }\n    },\n    changeGoldSpeed: function () {\n\n    },\n    toolChange: function (id) {\n        let info = ToolConfig[id];\n\n        if (Global.hammer[id] == undefined) {//激活\n            let bool = this.checkCanAdd(id);\n            if (bool) {\n                Global.hammer[id] = {id: id, attribute: info.attribute};\n                Global.saveHammer(Global.hammer);\n                this.addHammer(id);\n                this.setSmPosition(id);\n            } else {\n                this.addAdTime(id);\n            }\n            this.GameMenuController.updateButtom();\n\n        } else {//升级\n            let conf = AttributeConfig[Global.hammer[id].attribute];\n            let mess = {};\n\n            if (conf.costtype = 1001) {\n                Global.gold -= conf.cost;\n                mess['gold'] = Global.gold;\n            } else if (conf.costtype = 1002) {\n                Global.gem -= conf.cost;\n                mess['gem'] = Global.gem;\n            }\n            if (conf.next != -1) {\n                Global.hammer[id].attribute = conf.next;\n                let conf1 = AttributeConfig[conf.next];\n                Global.saveHammer(Global.hammer);\n                this.hammers[id].timeScale = 0.17 * (conf1.att / parseFloat(conf1.time)) * this.accelerHammer;\n            }\n            this.GameMenuController.updateDate(mess);\n        }\n    },\n    checkCanAdd: function (id) {\n        let conf = ToolConfig[id];\n        let thisID;\n        let confArry;\n        if (\"unlock\" in conf) {\n            if (conf.unlock.indexOf(\";\") != -1) {\n                confArry = conf.unlock.split(\";\");\n                thisID = confArry[0];\n            } else {\n                thisID = parseInt(conf.unlock);\n            }\n            if (thisID == -1) {\n                return true;\n            }\n            if (thisID == 0) {//点击激活\n                return true;\n            } else if (thisID == 1) {//视频激励\n                return Global.openAdTimes > 0;\n            } else if (thisID == 2) {//等级激活\n                let needlvl = confArry[1];\n                if (Global.level < needlvl) {\n                    return false;\n                } else {\n                    return true;\n                }\n\n            } else if (thisID == 3) {//邀请好友\n                // if(Global.freindsInfo[id]&&Global.freindsInfo[id].length){\n                //     Global.inviteFriends = Global.freindsInfo[id].length;\n                // }else{\n                //     Global.inviteFriends=0;\n                // }\n                if(Global.inviteFriends<confArry[1]){\n                    return false;\n                }else{\n                    return true;\n                }\n            }\n        }\n        return false;\n    },\n    addFriendCallBack:function(friendId){\n        if(Global.freindsInfo== null){\n            Global.freindsInfo = {};\n        }\n\n    },\n    addAdTime: function (id) {\n        let conf = ToolConfig[id];\n        let thisID;\n        let confArry;\n        let self = this;\n        if (\"unlock\" in conf) {\n            if (conf.unlock.indexOf(\";\") != -1) {\n                confArry = conf.unlock.split(\";\");\n                thisID = confArry[0];\n            } else {\n                thisID = parseInt(conf.unlock);\n            }\n            if (thisID == 1) {//视频激励\n                if(GameConfig.isFBInstantGame()){\n                    let FBP = require(\"FBPlugin\");\n                    FBP.RewardedVideoAsync(function(){\n                            Global.openAdTimes++;\n                            self.GameMenuController.updateButtom();\n                        }\n                    );\n                }else{\n                    Global.openAdTimes++;\n                }\n            } else if (thisID == 3) {//邀请好友\n                let FBP1 = require(\"FBPlugin\");\n                let self = this;\n                if(GameConfig.isFBInstantGame()){\n                    FBP1.chooseAsync(function(friendID){\n                        if(Global.freindsInfo== null){\n                            Global.freindsInfo = {};\n                        }\n                        if( Global.freindsInfo[id] == null){\n                            Global.freindsInfo[id] =[];\n                        }\n                        var find = false;\n                        for(var i = 0;i<Global.freindsInfo[id].length;i++){\n                            let oldFriend = Global.freindsInfo[id];\n                            if(oldFriend ==friendID ){\n                                find= true;\n                                break;\n                            }\n                        }\n                        if(!find){\n                            Global.freindsInfo[id].push(friendID);\n                            Global.inviteFriends = Global.freindsInfo[id].length;\n                        }\n                        self.GameMenuController.updateButtom();\n                    });\n                }else{\n                    Global.inviteFriends++;\n                }\n            }\n        }\n    },\n\n    efficiencyAdd: function (id,str = null) {\n        if(str != null){\n            this.efficiencyChange();\n            return;\n        }\n        let conf = EfficiencyConfig[id];\n        let gem = 0;\n        let addgold=0;\n        if (conf.costtype == 1002 && Global.gem >= conf.cost) {//enough gem\n            gem = Global.gem - conf.cost;\n            if (conf.coin > 0) {\n                // this.efficeGold += conf.coin - 1;\n                let timestamp = Date.parse( new Date())/1000;// 以秒为单位\n                Global.efficiency[id] = {'id':id,'timeleft':conf.time,'timestart':timestamp};\n                this.efficiencyChange();\n            }\n            let myinfo = {};\n            if (conf.jumptime > 0) {//jump time\n\n                for(let i=this.hammerStart;i<=this.hammerEnd; i++){\n                    if(Global.hammer[i] != undefined){\n                        let attr = AttributeConfig[Global.hammer[i].attribute];\n                        addgold+=conf.jumptime*60*60/attr.time* attr.att;\n                    }\n                }\n                Global.addgold = addgold;\n                Global.btnType = 'skip';\n                Global.skipID = id;\n                this.upgradView.active= true;\n            }\n        }\n        this.GameMenuController.updateDate({'gem': gem});\n        Global.saveGem(gem);\n        Global.saveEfficiency(Global.efficiency);\n        this.GameMenuController.updateButtom();\n    },\n    //进入游戏计算离线时间 并计算收益\n    initEfficienyInfo:function(){\n        let nowtime= Date.parse( new Date())/1000;// 以秒为单位;\n        let addgold = 0;\n        for (let id in Global.efficiency) {\n            if ( Global.efficiency[id] == null){\n                continue;\n            }\n            let paseTime = (nowtime - Global.efficiency[id].timestart)/60;//以min\n            let conf = EfficiencyConfig[id];\n            let useTime = conf.time - Global.efficiency[id].timeleft;\n            if(paseTime > conf.time) {\n                paseTime = conf.time;\n            }\n            let outlineTime= paseTime - useTime;\n            let timeleft = conf.time - outlineTime - useTime;\n            if(timeleft <=0){\n                Global.efficiency[id] = null;\n            }else{\n                Global.efficiency[id].timeleft = parseInt(timeleft);\n                this.efficeGold += conf.coin - 1;\n            }\n            for(let i=this.hammerStart;i<=this.hammerEnd; i++){\n                if(Global.hammer[i] != undefined){\n                    let attr = AttributeConfig[Global.hammer[i].attribute];\n                    addgold+=conf.coin*outlineTime*60* attr.att/attr.time;\n                }\n            }\n            if(Global.offlinetime<outlineTime){\n                Global.offlinetime = outlineTime;\n            }\n        }\n        Global.saveEfficiency(Global.efficiency);\n        addgold  = parseInt(addgold);\n        if(addgold >0) {\n            Global.addgold = parseInt(addgold);\n            Global.btnType = 'outline';\n            this.upgradView.active = true;\n        }\n    },\n    //收益加速开始/结束\n    efficiencyChange: function () {\n        let addeff=0;\n\n        for( let id in Global.efficiency){\n            if(Global.efficiency[id] == null)\n                continue;\n            let conf = EfficiencyConfig[id];\n            addeff+=conf.coin - 1;\n        }\n        this.efficeGold = addeff;\n        this.GameMenuController.updateButtom();\n    },\n    //-----------------------------bottom   end----------------------------\n    //-----------------------------引导   start----------------------------\n\n\n\n    //-----------------------------引导   end----------------------------\n    //-----------------------------GM   part start-------------------------\n\n    onClickBtnaddGem() {\n\n        let gem = Global.gem + 100;\n        this.GameMenuController.updateDate({'gem': gem});\n        Global.saveGem(gem);\n        this.GameMenuController.updateButtom();\n    },\n\n    onClickBtnsubGem() {\n\n        let gem = Global.gem - 10 > 0 ? Global.gem - 10 : 0;\n        this.GameMenuController.updateDate({'gem': gem});\n        Global.saveGem(gem);\n        this.GameMenuController.updateButtom();\n    },\n    onClickBtnaddGold() {\n\n        let gold = Global.gold + 10;\n        this.GameMenuController.updateDate({'gold': gold});\n        Global.saveGold(gold);\n        this.GameMenuController.updateButtom();\n    },\n    onClickBtnsubGold() {\n\n        let gold = Global.gold - 10 > 0 ? Global.gold - 10 : 0;\n        this.GameMenuController.updateDate({'gold': gold});\n        Global.saveGold(gold);\n        this.GameMenuController.updateButtom();\n    },\n    onClickBtnaddExp() {\n\n        let exp = Global.exp +1000;\n        this.GameMenuController.updateDate({'exp': exp});\n        Global.saveExp(exp);\n        // this.GameMenuController.updateButtom();\n    }\n    //-----------------------------GM   part end-------------------------\n});\n//"]}