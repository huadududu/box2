{"version":3,"sources":["../../../../../assets/src/controller/assets/src/controller/BoxController.js"],"names":["CameraController","require","StageConfig","BlockConfig","CycleConfig","ToolConfig","AttributeConfig","AcceleratorConfig","BoxConfig","RewardConfig","GameType","GameUtils","GameState","BlockBigFactory","BlockSmallFactory","RewardItemFactory","SpriteFrameCenter","ParticleSystemCenter","SkeletonDataCenter","Global","winsize","cc","winSize","BaseHeight","height","BaseWidth","width","GameHeight","GameCenterY","BaseGame","Class","extends","Component","properties","gameNode","Node","camera","Camera","BlockBig","Prefab","BlockSmall","MarginsBig","MarginsSmall","RewardItem","UIBottom","Sky","Bgbz","Underground","motionStreak","MotionStreak","boxSpine","sp","Skeleton","btnbox","Button","GameMenu","treasure","upgradView","bgopenbox","Sprite","language","visible","default","type","rowNum","blockWidth","blockBlank","moveNum","margins","curMaxLine","canTouch","previousPt","Hatting","HattingPos","accelerHammer","accelerGold","gameState","init","onLoad","preLoadAtlas","initdata","bind","GameMenuController","find","getComponent","initInfo","blocks","marginlist","hammers","rewardItem","startPos","setCompleteListener","animationName1","trackEntry","animation","name","log","trackIndex","addItems","firstOpen","playBoxSpine","node","active","setAnimation","stopBoxSpine","playHammerSpine","hammerpos","playHammers","i","undefined","setSmPosition","stopHammerSpine","addHammer","id","hammer","addComponent","info","conf","attribute","addSkeletonData","addChild","animationName","checkCanHammer","smCallback","timescale","att","parseFloat","time","timeScale","changeHammerSpine","data","skeletonData","start","nodehammer","conf1","restart","hard","destroy","hatting","floorNum","layer","length","blockwidth","size","count","blank","addBlocks","cameraStartPosY","initTreasure","addUIBottom","resetMarginList","isValid","resetBlockList","j","lineinfo","addLines","getPngName","cycleID","push","topline","top","pngname","thisNum","factory","curX","curY","lineArray","left","createMargins","position","p","right","endpos","create","thisID","indexOf","cycleArry","split","getnum","randomInt","parseInt","neednumber","destroyBlock","line","row","location","texiao","getEffByBlock","console","addParticleForNode","removeFromParent","destroyUpdate","checkCanDestroy","exp","gold","saveExp","saveGold","myinfo","updateDate","maxLineNum","max","totoalRowNum","cameraCentPosY","maxline","move","oldY","getPositionY","newY","moveY","action1","moveTo","runAction","posbottom","y","totoal","skyposy","bzYbottom","other","setPositionY","realwidth","maxrow","range","geScreenRange","canclick","x","num","getPngId","cameraPosY","min","maxPosY","canshowy","Math","floor","cameraY","gameY","realx","realy","hamX","hamY","updateTouch","point","touchStartCallBack","end","reset","setPositionX","touchCancelCallBack","isTouching","touchEndCallBack","touchMoveCallBack","onClickTreasure","event","maxlinenum","touchEndPoint","getLocation","update","eventcallback","string","accleleratorChange","accleleratorrRecover","toolChange","changeHammerSpeed","updateButtom","speedHammer","speedGold","speed","coin","changeGoldSpeed","bool","checkCanAdd","saveHammer","addAdTime","mess","costtype","cost","gem","next","confArry","unlock","openAdTimes","needlvl","level","inviteFriends","boxID","box","rewardID","reward","itemdata","random","z","str","rewardarry","createRewardItem","golds","gems","saveGem","BoxID","BoxConf","normalSprite","getFrameFromAtlas","icon","pressedSprite","hoverSprite","disabledSprite","addSkeletonDataWait","action","action2","callFunc","setFinish","sequence","onclickOtherBtn"],"mappings":";;;;;;AAAA;;;;AAIA;AACA,IAAMA,mBAAmBC,QAAQ,kBAAR,CAAzB;AACA,IAAIC,cAAcD,QAAQ,aAAR,CAAlB;AACA,IAAIE,cAAcF,QAAQ,YAAR,CAAlB;AACA,IAAIG,cAAcH,QAAQ,aAAR,CAAlB;AACA,IAAII,aAAaJ,QAAQ,YAAR,CAAjB;AACA,IAAIK,kBAAkBL,QAAQ,iBAAR,CAAtB;AACA,IAAIM,oBAAoBN,QAAQ,mBAAR,CAAxB;AACA,IAAIO,YAAYP,QAAQ,WAAR,CAAhB;AACA,IAAIQ,eAAeR,QAAQ,cAAR,CAAnB;;AAGA,IAAIS,WAAWT,QAAQ,UAAR,CAAf;AACA,IAAIU,YAAYV,QAAQ,WAAR,CAAhB;AACA,IAAIW,YAAYX,QAAQ,WAAR,CAAhB;AACA,IAAIY,kBAAkBZ,QAAQ,iBAAR,CAAtB;AACA,IAAIa,oBAAoBb,QAAQ,mBAAR,CAAxB;AACA,IAAIc,oBAAoBd,QAAQ,mBAAR,CAAxB;AACA,IAAIe,oBAAoBf,QAAQ,mBAAR,CAAxB;AACA,IAAIgB,uBAAuBhB,QAAQ,sBAAR,CAA3B;AACA,IAAIiB,qBAAqBjB,QAAQ,oBAAR,CAAzB;AACA;;AAEA,IAAIkB,SAASlB,QAAQ,QAAR,CAAb;;AAGA,IAAImB,UAAUC,GAAGC,OAAjB;AACA,IAAMC,aAAcH,QAAQI,MAAR,GAAe,CAAnC;AACA,IAAMC,YAAaL,QAAQM,KAAR,GAAc,CAAjC;AACA,IAAMC,aAAa,GAAnB;AACA,IAAMC,cAAc,GAApB;AACA,IAAMC,WAAW,GAAjB;;AAEAR,GAAGS,KAAH,CAAS;AACLC,aAAQV,GAAGW,SADN;;AAGLC,gBAAW;AACPC,kBAASb,GAAGc,IADL;AAEPC,gBAAQf,GAAGgB,MAFJ;AAGPC,kBAASjB,GAAGkB,MAHL;AAIPC,oBAAWnB,GAAGkB,MAJP;AAKPE,oBAAWpB,GAAGkB,MALP;AAMPG,sBAAarB,GAAGkB,MANT;AAOPI,oBAAWtB,GAAGkB,MAPP;AAQPK,kBAASvB,GAAGkB,MARL;AASPM,aAAIxB,GAAGc,IATA;AAUPW,cAAKzB,GAAGc,IAVD;AAWPY,qBAAY1B,GAAGc,IAXR;AAYPa,sBAAc3B,GAAG4B,YAZV;AAaP;AACAC,kBAASC,GAAGC,QAdL;AAePC,gBAAOhC,GAAGiC,MAfH;AAgBPC,kBAASlC,GAAGc,IAhBL;AAiBPqB,kBAASnC,GAAGiC,MAjBL;AAkBPG,oBAAWpC,GAAGc,IAlBP;AAmBPuB,mBAAUrC,GAAGsC,MAnBN;AAoBP;AACAC,kBAAS;AACLC,qBAAS,KADJ;AAELC,qBAAQ;AAFH,SArBF;AAyBPC,cAAK;AACDF,qBAAU,KADT;AAEDC,qBAAQ;AAFP,SAzBE;AA6BPE,gBAAO;AACHH,qBAAQ,KADL;AAEHC,qBAAQ;AAFL,SA7BA;AAiCPG,oBAAW,GAjCJ;AAkCPC,oBAAW;AACPL,qBAAQ,KADD;AAEPC,qBAAQ;AAFD,SAlCJ;AAsCPK,iBAAQ;AACJN,qBAAQ,KADJ;AAEJC,qBAAQ;AAFJ,SAtCD;AA0CPM,iBAAQ;AACJP,qBAAQ,KADJ;AAEJC,qBAAQ;AAFJ,SA1CD;AA8CPO,oBAAW;AACPR,qBAAS,KADF;AAEPC,qBAAQ;AAFD,SA9CJ;AAkDPQ,kBAAS;AACLT,qBAAQ,KADH;AAELC,qBAAQ;AAFH,SAlDF;AAsDPS,oBAAW;AACPV,qBAAQ,KADD;AAEPC,qBAAQ;AAFD,SAtDJ;AA0DPU,iBAAQ;AACJX,qBAAQ,KADJ;AAEJC,qBAAQ;AAFJ,SA1DD;AA8DPW,oBAAW;AACPZ,qBAAS,KADF;AAEPC,qBAAQ;AAFD,SA9DJ;AAkEPY,uBAAc;AACVb,qBAAQ,KADE;AAEVC,qBAAQ;AAFE,SAlEP;AAsEPa,qBAAY;AACRd,qBAAQ,KADA;AAERC,qBAAQ;AAFA,SAtEL;AA0EPc,mBAAUhE,UAAUiE,IA1Eb,CA0EmB;AA1EnB,KAHN;;AAiFLC,YAAO,kBAAY;AAAA;;AACf9D,0BAAkB+D,YAAlB,CAA+B,SAA/B,EAAyC,KAAKC,QAAL,CAAcC,IAAd,CAAmB,IAAnB,CAAzC;AACA,aAAKC,kBAAL,GAA0B7D,GAAG8D,IAAH,CAAQ,UAAR,EAAoBC,YAApB,CAAiC,oBAAjC,CAA1B;AACAjE,eAAOkE,QAAP;AACA,aAAKC,MAAL,GAAc,EAAd;AACA,aAAKC,UAAL,GAAgB,EAAhB;AACA,aAAKC,OAAL,GAAa,EAAb;AACA,aAAKC,UAAL,GAAiB,EAAjB;AACA,aAAKf,aAAL,GAAmB,CAAnB;AACA,aAAKC,WAAL,GAAmB,CAAnB;AACA,aAAKe,QAAL,GAAgB,CAAC/D,UAAD,GAAY,CAA5B;AACA,aAAKuB,QAAL,CAAcyC,mBAAd,CAAkC,sBAAc;AAC5C,gBAAIC,iBAAiBC,WAAWC,SAAX,GAAuBD,WAAWC,SAAX,CAAqBC,IAA5C,GAAmD,EAAxE;AACA1E,eAAG2E,GAAH,CAAO,2CAAP,EAAoDH,WAAWI,UAA/D,EAA2EL,cAA3E;AACA;AACA,kBAAKM,QAAL;AAEH,SAND;AAOA,aAAKC,SAAL,GAAiB,IAAjB;AACH,KApGI;AAqGLC,kBAAa,wBAAY;AACrB,aAAKlD,QAAL,CAAcmD,IAAd,CAAmBC,MAAnB,GAA4B,IAA5B;AACA,aAAKpD,QAAL,CAAcqD,YAAd,CAA2B,CAA3B,EAA8B,cAA9B,EAA8C,KAA9C;AACH,KAxGI;AAyGLC,kBAAa,wBAAY;AACrB,aAAKtD,QAAL,CAAcmD,IAAd,CAAmBC,MAAnB,GAA4B,KAA5B;AACH,KA3GI;AA4GLG,qBAAgB,yBAAUC,SAAV,EAAqB;;AAEjC,aAAKlB,OAAL,CAAakB,SAAb,EAAwBL,IAAxB,CAA6BC,MAA7B,GAAsC,IAAtC;AACA,aAAKd,OAAL,CAAakB,SAAb,EAAwBH,YAAxB,CAAqC,CAArC,EAAwC,cAAxC,EAAwD,IAAxD;AACH,KAhHI;AAiHLI,iBAAY,uBAAU;AAClB,aAAK,IAAIC,IAAI,CAAb,EAAgBA,IAAG,CAAnB,EAAqBA,GAArB,EAAyB;AACrB,gBAAG,KAAKpB,OAAL,CAAaoB,CAAb,KAAmBC,SAAtB,EAAgC;AAC5B,qBAAKC,aAAL,CAAmBF,CAAnB;AACH;AACJ;AACJ,KAvHI;AAwHLG,qBAAgB,yBAAUL,SAAV,EAAqB;AACjC,aAAKlB,OAAL,CAAakB,SAAb,EAAwBL,IAAxB,CAA6BC,MAA7B,GAAsC,KAAtC;AACH,KA1HI;AA2HLU,eAAU,mBAASC,EAAT,EAAY;AAAA;;AAClB,YAAIZ,OAAO,IAAKhF,GAAGc,IAAR,EAAX;AACA,YAAI+E,SAASb,KAAKc,YAAL,CAAkBhE,GAAGC,QAArB,CAAb;AACA,YAAIgE,OAAO/G,WAAW4G,EAAX,CAAX;AACA,YAAInB,YAAYsB,KAAKtB,SAArB;AACA,YAAIuB,OAAO/G,gBAAgB8G,KAAKE,SAArB,CAAX;;AAEApG,2BAAmBqG,eAAnB,CAAmCzB,SAAnC,EAA6CoB,MAA7C;AACA,aAAK3D,QAAL,CAAciE,QAAd,CAAuBnB,IAAvB;AACA,aAAKb,OAAL,CAAayB,EAAb,IAAiBC,MAAjB;AACAA,eAAOb,IAAP,CAAYC,MAAZ,GAAqB,KAArB;AACAY,eAAOvB,mBAAP,CAA2B,sBAAc;AACrC,gBAAI8B,gBAAgB5B,WAAWC,SAAX,GAAuBD,WAAWC,SAAX,CAAqBC,IAA5C,GAAmD,EAAvE;AACA1E,eAAG2E,GAAH,CAAO,2CAAP,EAAoDH,WAAWI,UAA/D,EAA2EwB,aAA3E;AACAP,mBAAOb,IAAP,CAAYC,MAAZ,GAAqB,KAArB;AACA,gBAAG,OAAKoB,cAAL,CAAoBT,EAApB,CAAH,EAA2B;AACvB,uBAAKU,UAAL,CAAgBV,EAAhB;AACH;AACJ,SAPD;AAQA,YAAKW,YAAY,OAAKP,KAAKQ,GAAV,GAAcC,WAAWT,KAAKU,IAAhB,CAAd,GAAoC,KAAKrD,aAA1D;AACAwC,eAAOc,SAAP,GAAmBJ,SAAnB;AACH,KAhJI;AAiJLK,uBAAkB,2BAASC,IAAT,EAAc;AAC5B,aAAKhB,MAAL,CAAYiB,YAAZ,GAA2BD,IAA3B;AACH,KAnJI;AAoJLE,WAAM,iBAAU;AAAA;;AACZ,aAAKlD,kBAAL,CAAwBG,QAAxB;AACA,aAAKG,OAAL,GAAa,EAAb;AACA,YAAIoC,YAAU,CAAd;AACA,YAAIV,SAAS/F,OAAO+F,MAApB;;AAJY,mCAKJN,CALI;AAMR,gBAAGM,OAAON,CAAP,KAAcC,SAAjB,EACI;AACJ,gBAAGxG,WAAWuG,CAAX,EAAcK,EAAd,IAAmB,CAAnB,IAAwB5G,WAAWuG,CAAX,EAAcK,EAAd,IAAmB,CAA9C,EACI;AACJ,gBAAIZ,OAAO,IAAKhF,GAAGc,IAAR,EAAX;AACA,gBAAIkG,aAAahC,KAAKc,YAAL,CAAkBhE,GAAGC,QAArB,CAAjB;AACA,gBAAIgE,OAAO/G,WAAWuG,CAAX,CAAX;AACA,gBAAId,YAAYsB,KAAKtB,SAArB;AACA5E,+BAAmBqG,eAAnB,CAAmCzB,SAAnC,EAA6CuC,UAA7C;AACA,mBAAK9E,QAAL,CAAciE,QAAd,CAAuBnB,IAAvB;AACA,mBAAKb,OAAL,CAAa0B,OAAON,CAAP,EAAUK,EAAvB,IAA2BoB,UAA3B;AACAA,uBAAWhC,IAAX,CAAgBC,MAAhB,GAAyB,KAAzB;AACA+B,uBAAW1C,mBAAX,CAA+B,sBAAc;AACzC,oBAAI8B,gBAAgB5B,WAAWC,SAAX,GAAuBD,WAAWC,SAAX,CAAqBC,IAA5C,GAAmD,EAAvE;AACA1E,mBAAG2E,GAAH,CAAO,2CAAP,EAAoDH,WAAWI,UAA/D,EAA2EwB,aAA3E;AACAY,2BAAWhC,IAAX,CAAgBC,MAAhB,GAAyB,KAAzB;AACA,oBAAG,OAAKoB,cAAL,CAAoBd,CAApB,CAAH,EAA0B;AACtB,2BAAKe,UAAL,CAAgBf,CAAhB;AACH;AACJ,aAPD;AAQA,gBAAIU,YAAYnG,OAAO+F,MAAP,CAAcN,CAAd,EAAiBU,SAAjC;AACA,gBAAIgB,QAAQhI,gBAAgBgH,SAAhB,CAAZ;AACAe,uBAAWL,SAAX,GAAuB,OAAOM,MAAMT,GAAb,GAAiBC,WAAWQ,MAAMP,IAAjB,CAAjB,GAAyC,OAAKrD,aAArE;AA5BQ;;AAKZ,aAAI,IAAIkC,IAAE,CAAV,EAAYA,IAAE,CAAd,EAAgBA,GAAhB,EAAoB;AAAA,6BAAZA,CAAY;;AAAA,qCAIZ;AAoBP;AAEJ,KAnLI;AAoLL2B,aAAQ,mBAAU;AACd,YAAGpH,OAAOqH,IAAP,GAAY,EAAf,EAAkB;AACdrH,mBAAOqH,IAAP;AACH;AACD,aAAKtF,QAAL,CAAcmD,IAAd,CAAmBC,MAAnB,GAA4B,KAA5B;AACA,aAAI,IAAIM,IAAE,CAAV,EAAYA,IAAE,CAAd,EAAgBA,GAAhB,EAAoB;AAChB;AACA,iBAAKnB,UAAL,CAAgBmB,CAAhB,EAAmB6B,OAAnB;AACA;AACA;AACA;AACH;AACD,aAAKhD,UAAL,GAAiB,EAAjB;AACA;AACA,aAAKT,QAAL;AACA,aAAKJ,SAAL,GAAiBhE,UAAU8H,OAA3B;AAEH,KArMI;AAsML1D,cAAS,oBAAU;AACf,YAAI2D,WAASzI,YAAYiB,OAAOqH,IAAnB,EAAyBI,KAAtC;AACA,aAAK,IAAIhC,IAAI,CAAb,EAAeA,IAAEzG,YAAY0I,MAA7B,EAAoCjC,GAApC,EAAwC;AACpC,gBAAGzG,YAAYyG,CAAZ,EAAekC,UAAf,IAA6B5I,YAAYiB,OAAOqH,IAAnB,EAAyBO,IAAzD,EAA8D;AAC1D,qBAAKhF,IAAL,GAAY5D,YAAYyG,CAAZ,EAAe7C,IAA3B;AACA;AACH;AACJ;AACD,aAAKC,MAAL,GAAY7D,YAAY,KAAK4D,IAAjB,EAAuBiF,KAAnC;AACA,aAAK/E,UAAL,GAAgB9D,YAAY,KAAK4D,IAAjB,EAAuB+E,UAAvC;AACA,aAAK5E,UAAL,GAAgB/D,YAAY,KAAK4D,IAAjB,EAAuBkF,KAAvC;AACA,aAAK7E,OAAL,GAAajE,YAAY,KAAK4D,IAAjB,EAAuBK,OAApC;;AAEA,aAAK8E,SAAL;AACA,aAAKC,eAAL;AACA,aAAK9F,MAAL,CAAYgD,IAAZ,CAAiBC,MAAjB,GAA0B,IAA1B;AACA,aAAKK,WAAL;AACA,aAAKyC,YAAL;AACA,YAAG,KAAKjD,SAAR,EAAkB;AACd,iBAAKjB,kBAAL,CAAwBmE,WAAxB;AACA,iBAAKlD,SAAL,GAAgB,KAAhB;AACH;AAEJ,KA7NI;AA8NLuB,oBAAgB,wBAAST,EAAT,EAAY;AACxB,YAAIC,SAAS/F,OAAO+F,MAApB;AACA,YAAGA,OAAOD,EAAP,KAAcJ,SAAd,IAA2BK,OAAOD,EAAP,EAAWK,SAAX,IAAwB,CAAC,CAAvD,EACI,OAAO,IAAP;AACJ,eAAO,KAAP;AACH,KAnOI;AAoOLgC,qBAAgB,2BAAU;AACtB,YAAG,KAAK/D,UAAL,CAAgBsD,MAAhB,GAAuB,CAA1B,EAA4B;AACxB,iBAAI,IAAIjC,IAAE,CAAV,EAAaA,IAAE,KAAKrB,UAAL,CAAgBsD,MAA/B,EAAsCjC,GAAtC,EAA0C;AACtC,oBAAIP,OAAO,KAAKd,UAAL,CAAgBqB,CAAhB,CAAX;AACA,oBAAGvF,GAAGkI,OAAH,CAAWlD,IAAX,CAAH,EAAoB;AAChBA,yBAAKoC,OAAL;AACH;AACJ;AACJ;AACD,aAAKlD,UAAL,GAAgB,EAAhB;AACH,KA9OI;AA+OLiE,oBAAe,0BAAU;AACrB,YAAG,KAAKlE,MAAL,CAAYuD,MAAZ,GAAmB,CAAtB,EAAwB;AACpB,iBAAI,IAAIjC,IAAE,CAAV,EAAaA,IAAE,KAAKtB,MAAL,CAAYuD,MAA3B,EAAkCjC,GAAlC,EAAsC;AAClC,qBAAK,IAAI6C,IAAE,CAAX,EAAaA,IAAE,KAAKnE,MAAL,CAAYsB,CAAZ,EAAeiC,MAA9B,EAAqCY,GAArC,EAAyC;AACrC,wBAAIpD,OAAO,KAAKf,MAAL,CAAYsB,CAAZ,EAAe6C,CAAf,CAAX;AACA,wBAAGpI,GAAGkI,OAAH,CAAWlD,IAAX,CAAH,EAAoB;AAChBA,6BAAKoC,OAAL;AACH;AACJ;AACJ;AACJ;AACD,aAAKnD,MAAL,GAAY,EAAZ;AACH,KA3PI;AA4PL;AACA4D,eAAU,qBAAW;;AAEjB,aAAKM,cAAL;AACA,aAAKF,eAAL;AACA,YAAIX,WAASzI,YAAYiB,OAAOqH,IAAnB,EAAyBI,KAAtC;AACA,aAAK,IAAIhC,IAAG,CAAZ,EAAcA,IAAG+B,WAAS,CAA1B,EAA4B/B,GAA5B,EAAgC;;AAE5B,gBAAI8C,WAAS,KAAKC,QAAL,CAAc,KAAKC,UAAL,CAAgB1J,YAAYiB,OAAOqH,IAAnB,EAAyBqB,OAAzC,EAAiDjD,CAAjD,CAAd,EAAkEA,CAAlE,CAAb;;AAEA,iBAAKtB,MAAL,CAAYwE,IAAZ,CAAiBJ,QAAjB;AACAA,uBAAS,EAAT;AACH;AACD,YAAIK,UAAU,KAAKJ,QAAL,CAAczJ,YAAYiB,OAAOqH,IAAnB,EAAyBwB,GAAvC,EAA2CpD,CAA3C,CAAd;AACA,aAAKtB,MAAL,CAAYwE,IAAZ,CAAiBC,OAAjB;AACH,KA3QI;AA4QLJ,cAAS,kBAAUM,OAAV,EAAkBC,OAAlB,EAA2B;;AAEhC,YAAI7C,OAAKlH,YAAY,KAAK4D,IAAjB,CAAT;AACA,YAAIiF,QAAQ3B,KAAK2B,KAAjB;AACA,YAAImB,UAAS,KAAKpG,IAAL,IAAa,CAAb,GAAelD,eAAf,GAA+BC,iBAA5C;AACA,YAAIsJ,OAAM/C,KAAKjD,OAAL,GAAaiD,KAAK4B,KAAlB,GAAyBxH,SAAnC;AACA,YAAI4I,OAAMH,WAAS,KAAKjG,UAAL,GAAgBoD,KAAK4B,KAA9B,IAAuC,KAAKvD,QAAtD;AACA,YAAI4E,YAAU,EAAd;AACA,YAAIC,OAAOJ,QAAQK,aAAR,CAAsBP,OAAtB,CAAX;;AAEAM,aAAKE,QAAL,GAAgBpJ,GAAGqJ,CAAH,CAAKrD,KAAKjD,OAAL,GAAa,CAAb,GAAe3C,SAApB,EAA8B4I,OAAK,KAAKpG,UAAL,GAAgB,CAAnD,CAAhB;AACA,aAAK/B,QAAL,CAAcsF,QAAd,CAAuB+C,IAAvB;AACA,aAAKhF,UAAL,CAAgBuE,IAAhB,CAAqBS,IAArB;AACA,YAAII,QAAQR,QAAQK,aAAR,CAAsBP,OAAtB,CAAZ;AACA,YAAIW,SAASnJ,YAAW4F,KAAKjD,OAAL,GAAa,CAArC;AACAuG,cAAMF,QAAN,GAAiBpJ,GAAGqJ,CAAH,CAAKE,MAAL,EAAYP,OAAK,KAAKpG,UAAL,GAAgB,CAAjC,CAAjB;AACA,aAAK/B,QAAL,CAAcsF,QAAd,CAAuBmD,KAAvB;AACA,aAAKpF,UAAL,CAAgBuE,IAAhB,CAAqBa,KAArB;;AAEA,aAAI,IAAI/D,IAAE,CAAV,EAAYA,IAAEoC,KAAd,EAAoBpC,GAApB,EAAwB;AACpB,gBAAIP,OAAO8D,QAAQU,MAAR,CAAeZ,OAAf,CAAX;AACA5D,iBAAKoE,QAAL,GAAgBpJ,GAAGqJ,CAAH,CAAKN,OAAK,KAAKnG,UAAL,GAAgB,CAA1B,EAA4BoG,OAAK,KAAKpG,UAAL,GAAgB,CAAjD,CAAhB;AACAmG,oBAAM,KAAKnG,UAAL,GAAgBoD,KAAK4B,KAA3B;AACA,iBAAK/G,QAAL,CAAcsF,QAAd,CAAuBnB,IAAvB;AACAiE,sBAAUR,IAAV,CAAezD,IAAf;AACH;;AAED,eAAOiE,SAAP;AACH,KAxSI;;AA0SL;AACAV,cA3SK,sBA2SMC,OA3SN,EA2ScK,OA3Sd,EA2SsB;AACvB,YAAIY,eAAJ;AACA,YAAGjB,QAAQkB,OAAR,CAAgB,GAAhB,KAAwB,CAAC,CAA5B,EAA8B;AAC1B,gBAAIC,YAAYnB,QAAQoB,KAAR,CAAc,GAAd,CAAhB;AACA,gBAAIC,SAAOvK,UAAUwK,SAAV,CAAoB,CAApB,EAAsBH,UAAUnC,MAAV,GAAiB,CAAvC,CAAX;AACAiC,qBAAOE,UAAUE,MAAV,CAAP;AACH,SAJD,MAIK;AACDJ,qBAAOM,SAASvB,OAAT,CAAP;AACH;AACD,YAAIwB,aAAW,CAAf;AACA,aAAI,IAAIzE,IAAG,CAAX,EAAaA,KAAG,EAAhB,EAAoBA,GAApB,EACA;AACI,gBAAGxG,YAAY0K,MAAZ,EAAoB,QAAMlE,CAA1B,KAAgC,CAAnC,EAAqC;AACjCA,oBAAE,CAAF;AACA;AACH;AACDyE,0BAAYjL,YAAY0K,MAAZ,EAAoB,QAAMlE,CAA1B,CAAZ;AACA,gBAAGyE,cAAYnB,OAAf,EAAuB;AACnB,uBAAO9J,YAAY0K,MAAZ,EAAoB,UAAQlE,CAA5B,CAAP;AACH;AACD,gBAAGA,KAAG,EAAN,EAAS;AACLA,oBAAE,CAAF;AACH;AACJ;AACJ,KAnUI;;AAoUL;AACA0E,kBAAa,sBAASC,IAAT,EAAcC,GAAd,EAAmB;;AAE5B,YAAG,CAAC,KAAKlG,MAAL,CAAYiG,IAAZ,CAAJ,EACI;AACJ,YAAIlF,OAAO,KAAKf,MAAL,CAAYiG,IAAZ,EAAkBC,GAAlB,CAAX;AACA,YAAIC,WAAW,KAAK/E,SAAL,CAAe6E,IAAf,EAAoBC,GAApB,CAAf;AACA,YAAIE,SAAO,KAAKC,aAAL,CAAmBJ,IAAnB,EAAwBC,GAAxB,CAAX;AACA,YAAGnK,GAAGkI,OAAH,CAAWlD,IAAX,CAAH,EAAsB;AAClBuF,oBAAQ5F,GAAR,CAAY,aAAZ,EAA0BuF,IAA1B,EAA+B,GAA/B,EAAmCC,GAAnC,EAAuCC,QAAvC;AACAxK,iCAAqB4K,kBAArB,CAAwCH,SAAO,QAA/C,EAAwD,KAAKxG,kBAAL,CAAwBmB,IAAhF,EAAqFoF,QAArF;AACApF,iBAAKyF,gBAAL,CAAsB,IAAtB;AACA,iBAAKxG,MAAL,CAAYiG,IAAZ,EAAkBC,GAAlB,IAAuB,IAAvB;AACA,iBAAKO,aAAL;AACH;AAEJ,KApVI;AAqVLC,qBAAiB,yBAAST,IAAT,EAAcC,GAAd,EAAkB;AAC/B,YAAG,CAACnK,GAAGkI,OAAH,CAAW,KAAKjE,MAAL,CAAYiG,IAAZ,CAAX,CAAD,IAAkC,CAAClK,GAAGkI,OAAH,CAAW,KAAKjE,MAAL,CAAYiG,IAAZ,EAAkBC,GAAlB,CAAX,CAAtC,EACI,OAAO,KAAP;AACJ,YAAI7C,WAASzI,YAAYiB,OAAOqH,IAAnB,EAAyBI,KAAtC;AACA,YAAG2C,QAAQ5C,WAAS,CAApB,EACI,OAAO,IAAP;AACJ,YAAItC,aAAJ;AACAA,eAAO,KAAKf,MAAL,CAAYiG,OAAK,CAAjB,EAAoBC,GAApB,CAAP;AACA,YAAG,CAACnK,GAAGkI,OAAH,CAAWlD,IAAX,CAAJ,EAAqB;AACjB,mBAAO,IAAP;AACH;AACD,YAAGkF,OAAK,CAAR,EAAU;AACNlF,mBAAO,KAAKf,MAAL,CAAYiG,OAAK,CAAjB,EAAoBC,GAApB,CAAP;AACA,gBAAG,CAACnK,GAAGkI,OAAH,CAAWlD,IAAX,CAAJ,EAAqB;AACjB,uBAAO,IAAP;AACH;AACJ;AACD,YAAGmF,MAAI,CAAJ,IAASA,MAAK,KAAKxH,MAAL,GAAY,CAA7B,EAA+B;AAC3BqC,mBAAO,KAAKf,MAAL,CAAYiG,IAAZ,EAAkBC,MAAI,CAAtB,CAAP;AACA,gBAAG,CAACnK,GAAGkI,OAAH,CAAWlD,IAAX,CAAJ,EAAqB;AACjB,uBAAO,IAAP;AACH;AACDA,mBAAO,KAAKf,MAAL,CAAYiG,IAAZ,EAAkBC,MAAI,CAAtB,CAAP;AACA,gBAAG,CAACnK,GAAGkI,OAAH,CAAWlD,IAAX,CAAJ,EAAqB;AACjB,uBAAO,IAAP;AACH;AACJ,SATD,MASM,IAAImF,OAAO,CAAX,EAAa;AACfnF,mBAAO,KAAKf,MAAL,CAAYiG,IAAZ,EAAkBC,MAAI,CAAtB,CAAP;AACA,gBAAG,CAACnK,GAAGkI,OAAH,CAAWlD,IAAX,CAAJ,EAAqB;AACjB,uBAAO,IAAP;AACH;AACJ,SALK,MAKA,IAAGmF,OAAO,KAAKxH,MAAL,GAAY,CAAtB,EAAwB;AAC1BqC,mBAAO,KAAKf,MAAL,CAAYiG,IAAZ,EAAkBC,MAAI,CAAtB,CAAP;AACA,gBAAG,CAACnK,GAAGkI,OAAH,CAAWlD,IAAX,CAAJ,EAAsB;AAClB,uBAAO,IAAP;AACH;AACJ;AACD,eAAO,KAAP;AACH,KA3XI;AA4XL0F,mBAAc,yBAAU;AACpB;AACA5K,eAAO8K,GAAP;AACA9K,eAAO+K,IAAP,GAAc/K,OAAO+K,IAAP,GAAa,IAAG,KAAKvH,WAAnC;AACA;AACAxD,eAAOgL,OAAP,CAAehL,OAAO8K,GAAtB;AACA9K,eAAOiL,QAAP,CAAgBjL,OAAO+K,IAAvB;AACA,YAAIG,SAAS,EAAb;AACAA,eAAOJ,GAAP,GAAa9K,OAAO8K,GAAP,GAAW,CAAxB;AACAI,eAAOH,IAAP,GAAc/K,OAAO+K,IAAP,GAAY,IAAG,KAAKvH,WAAlC;AACA,aAAKO,kBAAL,CAAwBoH,UAAxB,CAAmCD,MAAnC;AACH,KAvYI;AAwYL;AACAE,gBAAW,sBAAU;AACjB,YAAIC,MAAI,CAAR;AACA,YAAI7D,WAASzI,YAAYiB,OAAOqH,IAAnB,EAAyBI,KAAtC;AACA,aAAI,IAAIhC,IAAE,CAAV,EAAYA,IAAE+B,QAAd,EAAuB/B,GAAvB,EAA2B;AACvB,iBAAI,IAAI6C,IAAG,CAAX,EAAaA,IAAE,KAAKzF,MAApB,EAA2ByF,GAA3B,EAAgC;AAC5B,oBAAI,KAAKnE,MAAL,IAAe,KAAKA,MAAL,CAAYsB,CAAZ,CAAf,IAAiC,KAAKtB,MAAL,CAAYsB,CAAZ,EAAe6C,CAAf,CAArC,EAAwD;AACpD,wBAAIpD,OAAO,KAAKf,MAAL,CAAYsB,CAAZ,EAAe6C,CAAf,CAAX;AACA,wBAAI,CAACpI,GAAGkI,OAAH,CAAWlD,IAAX,CAAL,EACI;AACH;AACD,wBAAIO,IAAI4F,GAAR,EAAa;AACTA,8BAAM5F,CAAN;AACH;AACD;AACH;AACJ;AACJ;AACD,eAAO4F,GAAP;AACH,KA3ZI;;AA6ZLC,kBAAa,sBAASlB,IAAT,EAAe;AAAC;AACzB,YAAIiB,MAAM,CAAV;AACA,aAAI,IAAI/C,IAAG,CAAX,EAAaA,IAAE,KAAKzF,MAApB,EAA2ByF,GAA3B,EAA+B;AAC3B,gBAAIpD,OAAO,KAAKf,MAAL,CAAYiG,IAAZ,EAAkB9B,CAAlB,CAAX;AACA,gBAAG,CAACpI,GAAGkI,OAAH,CAAWlD,IAAX,CAAJ,EACI;AACJmG;AACH;AACD,eAAOA,GAAP;AACH,KAtaI;;AAwaL;AACAE,oBAAe,0BAAU;;AAErB,YAAIC,UAAQ,KAAKJ,UAAL,EAAZ;AACA,YAAG,KAAKlI,UAAL,IAAkBsI,OAArB,EAA6B;AACzB;AACH;AACD,YAAIC,OAAO,KAAKvI,UAAL,GAAgBsI,OAA3B;AACA,aAAKtI,UAAL,GAAgBsI,OAAhB;AACA,YAAIE,OAAO,KAAKzK,MAAL,CAAYiE,IAAZ,CAAiByG,YAAjB,EAAX;AACA,YAAGD,QAAMjL,WAAT,EAAqB;AACjB;AACH;AACD,YAAImL,OAAMF,OAAK,KAAK5I,UAAL,GAAgB2I,IAA/B;AACA,YAAII,QAAM,CAAV;AACA,YAAGD,QAAMnL,WAAT,EAAqB;AACjBoL,oBAAQD,IAAR;AACH,SAFD,MAEM;AACFC,oBAAQpL,WAAR;AACH;AACF,YAAK6J,WAAWpK,GAAGqJ,CAAH,CAAKjJ,SAAL,EAAeuL,KAAf,CAAhB;AACC,YAAIC,UAAU5L,GAAG6L,MAAH,CAAU,GAAV,EAAczB,QAAd,CAAd;AACA,aAAKrJ,MAAL,CAAYiE,IAAZ,CAAiB8G,SAAjB,CAA2BF,OAA3B;AACC;;AAGJ,KAlcI;;AAocL9D,qBAAgB,2BAAU;AACtB,YAAIR,WAASzI,YAAYiB,OAAOqH,IAAnB,EAAyBI,KAAtC;AACA,YAAIpH,SAASmH,YAAU,KAAK1E,UAAL,GAAgB,KAAKC,UAA/B,CAAb;AACA;AACA,aAAKnB,WAAL,CAAiBvB,MAAjB,GAAwBA,MAAxB;AACA,YAAI4L,YAAW,CAAC5L,SAAOG,UAAR,IAAoB,CAAnC;AACA,aAAKoB,WAAL,CAAiBsK,CAAjB,GAAmBD,SAAnB;AACA;AACA,YAAIE,SAAQ,KAAKxK,IAAL,CAAUtB,MAAV,GAAiBA,MAAjB,GAAyB,EAArC;AACA,YAAI+L,gBAAJ;AACA,YAAIC,kBAAJ;AACA,YAAIC,QAAQ9L,aAAY2L,MAAxB;AACAE,oBAAW,CAACF,SAAO9L,MAAP,GAAgBG,UAAjB,IAA6B,CAA7B,GAAgC,EAA3C;AACA,aAAKmB,IAAL,CAAUuK,CAAV,GAAYG,SAAZ;AACA,YAAGC,QAAM,CAAT,EAAW;AACP,iBAAK5K,GAAL,CAASyD,MAAT,GAAkB,IAAlB;AACA,iBAAKzD,GAAL,CAASrB,MAAT,GAAkBiM,QAAM,EAAxB;AACAF,sBAAS,CAAC5L,aAAa8L,KAAd,IAAqB,CAA9B;AACA,iBAAK5K,GAAL,CAASwK,CAAT,GAAWE,OAAX;AACA,iBAAKnL,MAAL,CAAYiE,IAAZ,CAAiBqH,YAAjB,CAA8B9L,WAA9B;AACH,SAND,MAMK;AACD,iBAAKiB,GAAL,CAASyD,MAAT,GAAkB,KAAlB;AACA,iBAAKlE,MAAL,CAAYiE,IAAZ,CAAiBqH,YAAjB,CAA8B9L,cAAc6L,KAA5C;AAEH;AACD,aAAKpJ,UAAL,GAAkBsE,WAAU,CAA5B;AACH,KA9dI;;AAieL;AACA;AACA7B,mBAAc,uBAASJ,SAAT,EAAmB;AAC7B,YAAIiH,YAAU,KAAK1J,UAAL,GAAgB,KAAKC,UAAnC;AACA,YAAIyI,UAAU,KAAKtI,UAAnB;AACA,YAAIuJ,SAAS,KAAKnB,YAAL,CAAkB,CAAlB,CAAb;AACA,YAAGE,WAAW,CAAX,IAAgBiB,UAAY,CAA/B,EACA;AACI,iBAAKnJ,UAAL,GAAiB,IAAjB;AACA;AACA,iBAAKe,OAAL,CAAakB,SAAb,EAAwBL,IAAxB,CAA6BC,MAA7B,GAAsC,KAAtC;AACA;AACH;AACD,aAAKd,OAAL,CAAakB,SAAb,EAAwBL,IAAxB,CAA6BC,MAA7B,GAAsC,IAAtC;AACA,YAAIuH,QAAQ,KAAKC,aAAL,EAAZ;AACA;AACA,YAAIvC,OAAO,KAAKlH,UAAhB;AACA,YAAIc,OAAO,KAAX;AACA,YAAI4I,WAAS,EAAb;AACA,aAAI,IAAInH,IAAI,CAAZ,EAAcA,IAAE,KAAK5C,MAArB,EAA4B4C,GAA5B,EAAgC;AAAC;AAC7B,gBAAG,KAAKtB,MAAL,CAAYiG,IAAZ,KAAmB,KAAKS,eAAL,CAAqBT,IAArB,EAA0B3E,CAA1B,CAAtB,EAAoD;AAChD,oBAAIzB,QAAO,KAAX;AACA,qBAAI,IAAIsE,IAAE,CAAV,EAAYA,KAAG,CAAf,EAAiBA,GAAjB,EAAqB;AACjB,wBAAI,KAAKhF,UAAL,IAAmB,KAAKA,UAAL,CAAgBgF,CAAhB,CAAvB,EAA0C;AACtC,4BAAG,KAAKhF,UAAL,CAAgBgF,CAAhB,EAAmBuE,CAAnB,IAAwBzC,IAAxB,IAAgC3E,KAAI,KAAKnC,UAAL,CAAgBgF,CAAhB,EAAmB4D,CAA1D,EAA4D;AACxDlI,oCAAM,IAAN;AACA;AACH;AACJ;AACJ;AACD,oBAAG,CAACA,KAAJ,EAAS;AACL4I,6BAASjE,IAAT,CAAclD,CAAd;AACH;AACJ;AACJ;;AAED,YAAGmH,SAASlF,MAAT,IAAkB,CAAlB,IAAuB0C,QAAO,CAAjC,EAAmC;AAC/B,iBAAK9G,UAAL,CAAgBiC,SAAhB,IAA6B,IAA7B;AACA;AACH,SAHD,MAGM,IAAGqH,SAASlF,MAAT,IAAmB,CAAtB,EAAwB;AAC1B0C,mBAAMA,OAAK,CAAX;AACA,iBAAI,IAAI3E,IAAI,CAAZ,EAAcA,IAAE,KAAK5C,MAArB,EAA4B4C,GAA5B,EAAgC;AAAC;AAC7B,oBAAG,KAAKtB,MAAL,CAAYiG,IAAZ,KAAmB,KAAKS,eAAL,CAAqBT,IAArB,EAA0B3E,CAA1B,CAAtB,EAAoD;AAChD,wBAAIzB,SAAO,KAAX;AACA,yBAAI,IAAIsE,KAAE,CAAV,EAAYA,MAAG,CAAf,EAAiBA,IAAjB,EAAqB;AACjB,4BAAI,KAAKhF,UAAL,IAAmB,KAAKA,UAAL,CAAgBgF,EAAhB,CAAvB,EAA0C;AACtC,gCAAG,KAAKhF,UAAL,CAAgBgF,EAAhB,EAAmBuE,CAAnB,IAAwBzC,IAAxB,IAAgC3E,KAAI,KAAKnC,UAAL,CAAgBgF,EAAhB,EAAmB4D,CAA1D,EAA4D;AACxDlI,yCAAM,IAAN;AACA;AACH;AACJ;AACJ;AACD,wBAAG,CAACA,MAAJ,EAAS;AACL4I,iCAASjE,IAAT,CAAclD,CAAd;AACH;AACJ;AACJ;AACJ;AACD,YAAIqH,MAAMtN,UAAUwK,SAAV,CAAoB,CAApB,EAAsB4C,SAASlF,MAAT,GAAgB,CAAtC,CAAV;AACA,YAAI2C,MAAKuC,SAASE,GAAT,CAAT;;AAEA,YAAIxC,WAAW,KAAK/E,SAAL,CAAe6E,IAAf,EAAoBC,GAApB,CAAf;AACA,YAAIE,SAAO,KAAKC,aAAL,CAAmBJ,IAAnB,EAAwBC,GAAxB,CAAX;AACA,YAAG,KAAK/G,UAAL,IAAmB,IAAtB,EAA2B;AACvB,iBAAKA,UAAL,GAAiB,EAAjB;AACH;AACD,aAAKA,UAAL,CAAgBiC,SAAhB,IAA4B,EAACsH,GAAEzC,IAAH,EAAQ8B,GAAE7B,GAAV,EAA5B;AACA,aAAKhG,OAAL,CAAakB,SAAb,EAAwBL,IAAxB,CAA6BoE,QAA7B,GAAsCgB,QAAtC;AACA,aAAKhF,eAAL,CAAqBC,SAArB;AACH,KAtiBI;AAuiBL;AACAiF,iBAxiBK,yBAwiBSJ,IAxiBT,EAwiBcC,GAxiBd,EAwiBkB;;AAEnB,YAAIzH,OAAO,KAAKA,IAAL,IAAa,CAAb,GAAgB,UAAhB,GAA2B,YAAtC;AACA,YAAIsC,OAAO,KAAKf,MAAL,CAAYiG,IAAZ,EAAkBC,GAAlB,EAAuBpG,YAAvB,CAAoCrB,IAApC,CAAX;AACA,eAAOsC,KAAK6H,QAAL,EAAP;AACH,KA7iBI;;AA8iBLJ,mBAAgB,yBAAU;AACtB,YAAItB,MAAM,KAAKnI,UAAf;AACA,YAAI8J,aAAa,KAAK/L,MAAL,CAAYiE,IAAZ,CAAiByG,YAAjB,EAAjB;AACA,YAAIsB,MAAI,CAAR;AACA,YAAIT,YAAU,KAAK1J,UAAL,GAAgB,KAAKC,UAAnC;AACA,YAAGiK,cAAc5M,UAAjB,EAA4B;AACxB6M,kBAAK,CAAL;AACH,SAFD,MAEK;AACD,gBAAIC,UAAS7B,MAAImB,SAAjB;AACA,gBAAIW,WAAW,CAACD,UAAUF,UAAV,GAAqB5M,UAAtB,IAAkCoM,SAAjD;AACAS,kBAAMG,KAAKC,KAAL,CAAWhC,MAAK8B,QAAhB,CAAN;AACH;AACD,eAAO,EAAC9B,KAAIA,GAAL,EAAS4B,KAAIA,GAAb,EAAP;AACH,KA3jBI;AA4jBL;AACA1H,eAAU,mBAAS6E,IAAT,EAAcC,GAAd,EAAkB;AACxB,YAAIiD,UAAS,KAAKrM,MAAL,CAAYiE,IAAZ,CAAiByG,YAAjB,EAAb;AACA,YAAI4B,QAAQ,KAAKxM,QAAL,CAAcmL,CAA1B;AACA,YAAIM,YAAU,KAAK1J,UAAL,GAAgB,KAAKC,UAAnC;AACA,YAAIyK,QAAQnD,MAAMmC,SAAN,GAAgB,KAAKvJ,OAArB,GAA6B,KAAKF,UAA9C;AACA,YAAI0K,QAAQrD,OAAOoC,SAAP,GAAiBe,KAAjB,GAAwBD,OAAxB,GAAiC5M,QAA7C;AACA,YAAIgN,OAAMF,QAAQlN,SAAR,GAAoB,EAApB,GAAuB,KAAKwC,UAAtC;AACA,YAAI6K,OAAOF,QAAQ,EAAnB;AACA,eAAOvN,GAAGqJ,CAAH,CAAKmE,IAAL,EAAUC,IAAV,CAAP;AAEH,KAvkBI;AAwkBLnH,gBAAW,oBAASjB,SAAT,EAAmB;AAC1B,YAAG,KAAKjC,UAAL,IAAmB,IAAnB,IAA2B,KAAKA,UAAL,CAAgBiC,SAAhB,KAA4B,IAA1D,EAAgE;AAC5D,gBAAI2G,IAAG,KAAK5I,UAAL,CAAgBiC,SAAhB,EAA2B2G,CAAlC;AACA,gBAAIW,IAAG,KAAKvJ,UAAL,CAAgBiC,SAAhB,EAA2BsH,CAAlC;AACA,gBAAG3M,GAAGkI,OAAH,CAAW,KAAKjE,MAAL,CAAY0I,CAAZ,EAAeX,CAAf,CAAX,CAAH,EAAiC;AAC7B,qBAAK/B,YAAL,CAAkB0C,CAAlB,EAAoBX,CAApB;AACH;AACD,iBAAKX,cAAL;AACA,iBAAK5F,aAAL,CAAmBJ,SAAnB;AACH;AACJ,KAllBI;AAmlBL;;AAEAqI,iBAAY,qBAASC,KAAT,EAAe;AACvB,YAAIP,UAAS,KAAKrM,MAAL,CAAYiE,IAAZ,CAAiByG,YAAjB,EAAb;AACA,YAAI4B,QAAQ,KAAKxM,QAAL,CAAcmL,CAA1B;AACA,YAAIM,YAAU,KAAK1J,UAAL,GAAgB,KAAKC,UAAnC;AACA,YAAIqH,OAAOgD,KAAKC,KAAL,CAAW,CAACQ,MAAM3B,CAAN,IAASqB,QAAMD,OAAN,GAAclN,UAAd,GAA2BM,QAApC,CAAD,IAAgD8L,SAA3D,CAAX;AACA,YAAInC,MAAM+C,KAAKC,KAAL,CAAW,CAACQ,MAAMhB,CAAN,GAAQ,KAAK5J,OAAb,GAAuB,KAAKF,UAA7B,IAAyCyJ,SAApD,CAAV;AACA,YAAIxI,OAAO,KAAX;AACA,YAAG,KAAK6G,eAAL,CAAqBT,IAArB,EAA0BC,GAA1B,CAAH,EAAkC;AAC9B,iBAAI,IAAI5E,IAAE,CAAV,EAAYA,IAAE,CAAd,EAAgBA,GAAhB,EAAoB;AAChB,oBAAG,KAAKnC,UAAL,IAAmB,IAAnB,IAA2B,KAAKA,UAAL,CAAgBmC,CAAhB,KAAsB,IAAjD,IAAyD,KAAKnC,UAAL,CAAgBmC,CAAhB,KAAsBC,SAAlF,EAA4F;AACxF,wBAAG,KAAKpC,UAAL,CAAgBmC,CAAhB,EAAmBoH,CAAnB,IAAwBzC,IAAxB,IAAgC,KAAK9G,UAAL,CAAgBmC,CAAhB,EAAmByG,CAAnB,IAAwB7B,GAA3D,EAAgE;AAC5D,6BAAKhG,OAAL,CAAaoB,CAAb,EAAgBP,IAAhB,CAAqBC,MAArB,GAA8B,KAA9B;AACA,6BAAKqB,UAAL,CAAgBf,CAAhB;AACAzB,+BAAM,IAAN;AACA;AACH;AACJ;AACJ;AACD,gBAAG,CAACA,IAAJ,EAAS;AACL,qBAAKmG,YAAL,CAAkBC,IAAlB,EAAuBC,GAAvB;AACH;AACJ;AACJ,KA3mBI;AA4mBLyD,wBAAmB,4BAAUxD,QAAV,EAAoB;AACnC,YAAG,CAAC,KAAKnH,QAAT,EAAkB;AACd;AACH;AACD,YAAG,KAAKM,SAAL,IAAkBhE,UAAUsO,GAA/B,EAAmC;AAC/B,iBAAKxL,SAAL,CAAe2C,IAAf,CAAoBC,MAApB,GAA6B,KAA7B;AACA,iBAAKiC,OAAL;AACH;AACD,YAAGkD,SAASuC,CAAT,GAAW,KAAK5J,OAAhB,IAA2BqH,SAASuC,CAAT,GAAa,IAAEvM,SAAF,GAAY,KAAK2C,OAA5D,EAAqE;AACjE,iBAAKpB,YAAL,CAAkBmM,KAAlB;AACA;AACH;AACDvD,gBAAQ5F,GAAR,CAAY,oBAAZ;AACA,aAAKzB,UAAL,GAAkBkH,QAAlB;AACA,aAAKzI,YAAL,CAAkBqD,IAAlB,CAAuB+I,YAAvB,CAAoC3D,SAASuC,CAA7C;AACA,aAAKhL,YAAL,CAAkBqD,IAAlB,CAAuBqH,YAAvB,CAAoCjC,SAAS4B,CAA7C;AACA,aAAKrK,YAAL,CAAkBmM,KAAlB;;AAEA;AACH,KA/nBI;;AAioBLE,yBAAoB,6BAAU5D,QAAV,EAAoB;AACpC,aAAKsD,WAAL,CAAiBtD,QAAjB;AACA,aAAK6D,UAAL,GAAkB,KAAlB;AACA,aAAKtM,YAAL,CAAkBmM,KAAlB;AACH,KAroBI;;AAuoBLI,sBAAiB,0BAAU9D,QAAV,EAAoB;AACjC;AACA,aAAKsD,WAAL,CAAiBtD,QAAjB;AACA,aAAK6D,UAAL,GAAkB,KAAlB;AACA1D,gBAAQ5F,GAAR,CAAY,kBAAZ;AACA,aAAKhD,YAAL,CAAkBmM,KAAlB;AACH,KA7oBI;AA8oBLK,uBAAkB,2BAAU/D,QAAV,EAAoB;AAClC,YAAGA,SAASuC,CAAT,GAAW,KAAK5J,OAAhB,IAA2BqH,SAASuC,CAAT,IAAa,IAAEvM,SAAF,GAAY,KAAK2C,OAAjB,IACpCqH,SAAS4B,CAAT,GAAW,GADY,CAA9B,EACwB;AACpB,iBAAKrK,YAAL,CAAkBmM,KAAlB;AACA;AACH;AACD,aAAKJ,WAAL,CAAiBtD,QAAjB;AACA,aAAKlH,UAAL,GAAkBkH,QAAlB;AACA,aAAKzI,YAAL,CAAkBqD,IAAlB,CAAuB+I,YAAvB,CAAoC3D,SAASuC,CAA7C;AACA,aAAKhL,YAAL,CAAkBqD,IAAlB,CAAuBqH,YAAvB,CAAoCjC,SAAS4B,CAA7C;AACH,KAxpBI;;AA0pBLoC,qBAAgB,yBAASC,KAAT,EAAe;AAC3B,YAAIC,aAAY,KAAKpD,UAAL,EAAhB;AACA,YAAIE,eAAc,KAAKA,YAAL,CAAkB,CAAlB,CAAlB;AACA,YAAGkD,cAAc,CAAd,IAAoBlD,gBAAgB,CAAvC,EAAyC;AACrC,iBAAKmD,aAAL,GAAqBF,MAAMG,WAAN,EAArB;;AAEA,iBAAKd,WAAL,CAAiB,KAAKa,aAAtB;AACA;AACH;AACD,aAAKvM,MAAL,CAAYgD,IAAZ,CAAiBC,MAAjB,GAA0B,KAA1B;AACA,aAAK1B,SAAL,GAAiBhE,UAAUsO,GAA3B;AACA,aAAK9I,YAAL;AACH,KAtqBI;AAuqBL0J,YAAO,kBAAU;AACb,aAAKpD,cAAL;AACH,KAzqBI;AA0qBLqD,mBAAe,uBAAShM,IAAT,EAAekD,EAAf,EAAkC;AAAA,YAAf+I,MAAe,uEAAN,IAAM;;AAC7C;AACA,gBAAQjM,IAAR;AACI,iBAAK,CAAL;AACI,oBAAGiM,UAAU,IAAb,EACI,KAAKC,kBAAL,CAAwBhJ,EAAxB,EADJ,KAEI;AACA,wBAAG+I,UAAU,QAAb,EAAsB;AAClB,6BAAKE,oBAAL,CAA0BjJ,EAA1B;AACH;AACJ;AACD;AACJ,iBAAK,CAAL;AACI;AACA;AACA;AACA;AACA,qBAAKkJ,UAAL,CAAgBlJ,EAAhB;AACA;AACJ,iBAAK,CAAL;AACI;AAlBR;AAoBH,KAhsBI;AAisBLgJ,wBAAmB,4BAAShJ,EAAT,EAAY;AAC3B,YAAII,OAAO9G,kBAAkB0G,EAAlB,CAAX;AACA9F,eAAO,QAAM8F,EAAb,IAAkBI,KAAKU,IAAvB;AACA,aAAKqI,iBAAL;AACA,aAAKlL,kBAAL,CAAwBmL,YAAxB;AAEH,KAvsBI;AAwsBLH,0BAAqB,8BAASjJ,EAAT,EAAY;AAC7B,aAAKmJ,iBAAL;AACA,aAAKlL,kBAAL,CAAwBmL,YAAxB;AACH,KA3sBI;;AA6sBLD,uBAAkB,6BAAU;AACxB,YAAIE,cAAc,CAAlB;AACA,YAAIC,YAAY,CAAhB;AACA,aAAK,IAAI3J,IAAI,CAAb,EAAgBA,KAAG,CAAnB,EAAqBA,GAArB,EAAyB;AACrB,gBAAGzF,OAAO,QAAMyF,CAAb,IAAgB,CAAnB,EAAqB;AACjB0J,+BAAc/P,kBAAkBqG,CAAlB,EAAqB4J,KAAnC;AACAD,6BAAWhQ,kBAAkBqG,CAAlB,EAAqB6J,IAAhC;AACH;AACJ;;AAGD,YAAGH,eAAc,CAAjB,EAAmB;AACfA,0BAAc,CAAd;AACH;AACD,YAAGC,aAAa,CAAhB,EAAkB;AACdA,wBAAY,CAAZ;AACH;AACD,aAAK7L,aAAL,GAAqB4L,WAArB;AACA,aAAK3L,WAAL,GAAmB4L,SAAnB;AACA,aAAI,IAAI3J,KAAI,CAAZ,EAAcA,MAAG,CAAjB,EAAoBA,IAApB,EAAyB;AACrB,gBAAI,KAAKpB,OAAL,CAAaoB,EAAb,KAAmBC,SAAvB,EAAiC;AAC7B,oBAAIyB,QAAMhI,gBAAgBa,OAAO+F,MAAP,CAAcN,EAAd,EAAiBU,SAAjC,CAAV;AACA,qBAAK9B,OAAL,CAAaoB,EAAb,EAAgBoB,SAAhB,GAA4B,QAAMM,MAAMT,GAAN,GAAUC,WAAWQ,MAAMP,IAAjB,CAAhB,IAAyC,KAAKrD,aAA1E;AACH;AACJ;AACJ,KAtuBI;AAuuBLgM,qBAAgB,2BAAU,CAEzB,CAzuBI;AA0uBLP,gBAAW,oBAASlJ,EAAT,EAAa;AACpB,YAAIG,OAAO/G,WAAW4G,EAAX,CAAX;AACA;AACA;AACA;AACA;;AAEA,YAAG9F,OAAO+F,MAAP,CAAcD,EAAd,KAAqBJ,SAAxB,EAAkC;AAC9B,gBAAI8J,OAAM,KAAKC,WAAL,CAAiB3J,EAAjB,CAAV;AACA,gBAAG0J,IAAH,EAAS;AACLxP,uBAAO+F,MAAP,CAAcD,EAAd,IAAoB,EAACA,IAAIA,EAAL,EAASK,WAAWF,KAAKE,SAAzB,EAApB;AACAnG,uBAAO0P,UAAP,CAAkB1P,OAAO+F,MAAzB;AACA,oBAAGD,MAAM,CAAN,IAAWA,MAAK,CAAnB,EAAqB;AACjB,yBAAKD,SAAL,CAAeC,EAAf;AACA,yBAAKH,aAAL,CAAmBG,EAAnB;AACH;AACJ,aAPD,MAOK;AACD,qBAAK6J,SAAL,CAAe7J,EAAf;AACH;AACD,iBAAK/B,kBAAL,CAAwBmL,YAAxB;AACH,SAbD,MAaK;;AAED,gBAAIhJ,OAAO/G,gBAAgBa,OAAO+F,MAAP,CAAcD,EAAd,EAAkBK,SAAlC,CAAX;AACA,gBAAIyJ,OAAM,EAAV;;AAEA,gBAAG1J,KAAK2J,QAAL,GAAgB,IAAnB,EAAwB;AACpB7P,uBAAO+K,IAAP,IAAe7E,KAAK4J,IAApB;AACAF,qBAAK,MAAL,IAAa5P,OAAO+K,IAApB;AACH,aAHD,MAGM,IAAG7E,KAAK2J,QAAL,GAAgB,IAAnB,EAAwB;AAC1B7P,uBAAO+P,GAAP,IAAc7J,KAAK4J,IAAnB;AACAF,qBAAK,KAAL,IAAY5P,OAAO+P,GAAnB;AACH;AACD,gBAAG7J,KAAK8J,IAAL,IAAa,CAAC,CAAjB,EAAmB;AACfhQ,uBAAO+F,MAAP,CAAcD,EAAd,EAAkBK,SAAlB,GAA8BD,KAAK8J,IAAnC;AACA,oBAAI7I,QAAMhI,gBAAgB+G,KAAK8J,IAArB,CAAV;AACAhQ,uBAAO0P,UAAP,CAAkB1P,OAAO+F,MAAzB;AACA,qBAAK1B,OAAL,CAAayB,EAAb,EAAiBe,SAAjB,GAA6B,QAAMM,MAAMT,GAAN,GAAUC,WAAWQ,MAAMP,IAAjB,CAAhB,IAA0C,KAAKrD,aAA5E;AACH;AACD,iBAAKQ,kBAAL,CAAwBoH,UAAxB,CAAmCyE,IAAnC;AACH;AACJ,KAlxBI;AAmxBLH,iBAAY,qBAAS3J,EAAT,EAAY;AACpB,YAAII,OAAOhH,WAAW4G,EAAX,CAAX;AACA,YAAI6D,eAAJ;AACA,YAAIsG,iBAAJ;AACA,YAAGnK,MAAM,CAAN,IAAWA,MAAM,CAApB,EACI,OAAO,KAAP;AACJ,YAAG,YAAYI,IAAf,EAAqB;AACjB,gBAAIA,KAAKgK,MAAL,CAAYtG,OAAZ,CAAoB,GAApB,KAA4B,CAAC,CAAjC,EAAoC;AAChCqG,2BAAW/J,KAAKgK,MAAL,CAAYpG,KAAZ,CAAkB,GAAlB,CAAX;AACAH,yBAASsG,SAAS,CAAT,CAAT;AACH,aAHD,MAGO;AACHtG,yBAASM,SAAS/D,KAAKgK,MAAd,CAAT;AACH;AACD,gBAAIvG,UAAU,CAAC,CAAf,EAAmB;AACf,uBAAO,IAAP;AACH;AACD,gBAAGA,UAAU,CAAb,EAAe;AAAC;AACZ,uBAAO,IAAP;AACH,aAFD,MAEM,IAAGA,UAAU,CAAb,EAAe;AAAC;AACjB,uBAAO3J,OAAOmQ,WAAP,GAAmB,CAA1B;AACJ,aAFK,MAEA,IAAGxG,UAAU,CAAb,EAAe;AAAC;AAClB,oBAAIyG,UAAUH,SAAS,CAAT,CAAd;AACA,oBAAGjQ,OAAOqQ,KAAP,GAAaD,OAAhB,EAAwB;AACpB,2BAAO,KAAP;AACH,iBAFD,MAEK;AACD,2BAAO,IAAP;AACH;AAEJ,aARK,MAQA,IAAGzG,UAAU,CAAb,EAAe;AAAC;AAClB,oBAAI3J,OAAOsQ,aAAP,GAAsBL,SAAS,CAAT,CAA1B,EACI,OAAO,KAAP,CADJ,KAGI,OAAO,IAAP;AACP;AACJ;AACD,eAAO,IAAP;AAEH,KAxzBI;AAyzBLN,eAAU,mBAAS7J,EAAT,EAAY;AAClB,YAAII,OAAOhH,WAAW4G,EAAX,CAAX;AACA,YAAI6D,eAAJ;AACA,YAAIsG,iBAAJ;AACA,YAAGnK,MAAM,CAAN,IAAWA,MAAM,CAApB,EACI;AACJ,YAAG,YAAYI,IAAf,EAAqB;AACjB,gBAAIA,KAAKgK,MAAL,CAAYtG,OAAZ,CAAoB,GAApB,KAA4B,CAAC,CAAjC,EAAoC;AAChCqG,2BAAW/J,KAAKgK,MAAL,CAAYpG,KAAZ,CAAkB,GAAlB,CAAX;AACAH,yBAASsG,SAAS,CAAT,CAAT;AACH,aAHD,MAGO;AACHtG,yBAASM,SAAS/D,KAAKgK,MAAd,CAAT;AACH;AACD,gBAAGvG,UAAU,CAAb,EAAe;AAAC;AACZ,uBAAO3J,OAAOmQ,WAAP,EAAP;AACH,aAFD,MAEM,IAAGxG,UAAU,CAAb,EAAe;AAAC;AAClB3J,uBAAOsQ,aAAP;AACH;AACJ;AACJ,KA50BI;AA60BLvL,cAAS,oBAAU;;AAEf,YAAIsC,OAAOrH,OAAOqH,IAAlB;AACA,YAAIkJ,QAAQxR,YAAYsI,IAAZ,EAAkBmJ,GAA9B;AACA,YAAIC,WAAUpR,UAAUkR,KAAV,EAAiBG,MAA/B;AACA,YAAIxK,OAAO5G,aAAamR,QAAb,CAAX;AACA,YAAI3D,MAAM5G,KAAK4G,GAAf;AACA,YAAI6D,WAAW,EAAf;AACA,YAAIxE,SAAO,CAAX;AACA,YAAIuE,SAAQ,EAAZ;AACA,YAAIrF,MAAK,CAAT;AACA,aAAK,IAAI5F,IAAG,CAAZ,EAAcA,IAAE,CAAhB,EAAkBA,GAAlB,EAAsB;AAClB,gBAAGS,KAAK,SAAOT,CAAZ,KAAiB,CAApB,EAAsB;AAClB0G,yBAAOjG,KAAK,SAAOT,CAAZ,CAAP;AACA,oBAAGA,KAAK,CAAR,EAAU;AACNkL,6BAASlL,CAAT,IAAc0G,MAAd;AACAd,0BAAMsF,SAASlL,CAAT,CAAN;AACH,iBAHD,MAGK;AACDkL,6BAASlL,CAAT,IAAckL,SAASlL,IAAE,CAAX,IAAgB0G,MAA9B;AACAd,0BAAMsF,SAASlL,CAAT,CAAN;AACH;AACJ;AACJ;AACD,aAAK,IAAI6C,IAAE,CAAX,EAAaA,KAAGwE,GAAhB,EAAoBxE,GAApB,EAAwB;AACpB,gBAAIsI,SAAQpR,UAAUoR,MAAV,CAAiBvF,GAAjB,CAAZ;AACA,iBAAI,IAAIwF,IAAG,CAAX,EAAaF,SAASE,CAAT,KAAenL,SAA5B,EAAsCmL,GAAtC,EAA0C;AACtC,oBAAGF,SAASE,CAAT,IAAYD,MAAf,EAAsB;AAClB;AACH;AACDF,uBAAOpI,CAAP,IAAUpC,KAAK,SAAO2K,CAAZ,CAAV;AACA;AACH;AACJ;AACD,YAAI9F,OAAM,CAAV;AACA,YAAIgF,MAAK,CAAT;AACA,YAAIe,MAAK,EAAT;AACA,aAAI,IAAIrL,MAAE,CAAV,EAAaA,OAAGqH,GAAhB,EAAoBrH,KAApB,EAAwB;AACpB,gBAAGiL,OAAOjL,GAAP,KAAaC,SAAhB,EAA0B;AACtBoL,uBAAKJ,OAAOjL,GAAP,IAAU,IAAf;AACA,oBAAGiL,OAAOjL,GAAP,EAAUmE,OAAV,CAAkB,GAAlB,KAA0B,CAAC,CAA9B,EAAgC;AAC5B,wBAAImH,aAAaL,OAAOjL,GAAP,EAAUqE,KAAV,CAAgB,GAAhB,CAAjB;AACA,wBAAGiH,WAAW,CAAX,KAAiB,IAApB,EAAyB;AACrBhG,gCAAMd,SAAS8G,WAAW,CAAX,CAAT,CAAN;AACH,qBAFD,MAEM,IAAGA,WAAW,CAAX,KAAiB,IAApB,EAAyB;AAC3BhB,+BAAK9F,SAAS8G,WAAW,CAAX,CAAT,CAAL;AACH;AACJ;AACJ;AACD,iBAAKC,gBAAL,CAAsBN,OAAOjL,GAAP,CAAtB,EAAgCA,GAAhC;AACA,iBAAKlD,SAAL,CAAe2C,IAAf,CAAoBC,MAApB,GAA6B,IAA7B;AACH;AACD,YAAG4F,OAAK,CAAL,IAAUgF,MAAK,CAAlB,EAAoB;AAChB,gBAAIkB,QAAQjR,OAAO+K,IAAP,GAAYA,IAAxB;AACA,gBAAImG,OAAOlR,OAAO+P,GAAP,GAAWA,GAAtB;AACA,iBAAKhM,kBAAL,CAAwBoH,UAAxB,CAAmC,EAACJ,MAAKkG,KAAN,EAAYlB,KAAImB,IAAhB,EAAnC;AACAlR,mBAAOiL,QAAP,CAAgBgG,KAAhB;AACAjR,mBAAOmR,OAAP,CAAeD,IAAf;AACH;AAEJ,KAx4BI;AAy4BLjJ,kBAAa,wBAAU;AACnB,YAAImJ,QAAQrS,YAAYiB,OAAOqH,IAAnB,EAAyBmJ,GAArC;AACA,YAAIa,UAAUhS,UAAU+R,KAAV,CAAd;AACA,aAAK/O,QAAL,CAAciP,YAAd,GAA6BzR,kBAAkB0R,iBAAlB,CAAoC,SAApC,EAA8CF,QAAQG,IAAR,GAAa,MAA3D,CAA7B;AACA,aAAKnP,QAAL,CAAcoP,aAAd,GAA8B5R,kBAAkB0R,iBAAlB,CAAoC,SAApC,EAA8CF,QAAQG,IAAR,GAAa,MAA3D,CAA9B;AACA,aAAKnP,QAAL,CAAcqP,WAAd,GAA4B7R,kBAAkB0R,iBAAlB,CAAoC,SAApC,EAA8CF,QAAQG,IAAR,GAAa,MAA3D,CAA5B;AACA,aAAKnP,QAAL,CAAcsP,cAAd,GAA+B9R,kBAAkB0R,iBAAlB,CAAoC,SAApC,EAA8CF,QAAQG,IAAR,GAAa,MAA3D,CAA/B;AACA,YAAI7M,YAAY0M,QAAQ1M,SAAxB;AACA5E,2BAAmB6R,mBAAnB,CAAuCjN,SAAvC,EAAmD,KAAK5C,QAAxD;AACA,aAAKM,QAAL,CAAc6C,IAAd,CAAmBgH,CAAnB,GAAuB,CAAE1L,UAAF,GAAa,CAAb,GAAgB,KAAKsC,UAArB,GAAgC,EAAhC,GAAoC,EAA3D;AACA,aAAKf,QAAL,CAAcmD,IAAd,CAAmBgH,CAAnB,GAAuB,CAAE1L,UAAF,GAAa,CAAb,GAAgB,KAAKsC,UAArB,GAAgC,EAAhC,GAAoC,EAA3D;AAEH,KAr5BI;AAs5BLkO,sBAAiB,0BAASN,MAAT,EAAgBjL,CAAhB,EAAkB;AAC/B,YAAG,KAAKnB,UAAL,CAAgBmB,CAAhB,CAAH,EAAsB;AAClB,iBAAKnB,UAAL,CAAgBmB,CAAhB,EAAmB6B,OAAnB;AACA,iBAAKhD,UAAL,CAAgBmB,CAAhB,IAAmB,IAAnB;AACH;AACD,YAAIwB,QAAQ,CAAC,GAAD,GAAMxB,IAAE,GAApB;;AAEA,YAAIP,OAAOtF,kBAAkB8J,MAAlB,CAAyBgH,MAAzB,CAAX;AACA,YAAIpG,WAAW,KAAKjI,QAAL,CAAc6C,IAAd,CAAmBoE,QAAlC;AACA,aAAKhF,UAAL,CAAgBmB,CAAhB,IAAoBP,IAApB;AACAA,aAAKoE,QAAL,GAAgBgB,QAAhB;AACA,YAAIuH,SAAQ3R,GAAG6L,MAAH,CAAU,GAAV,EAAc7L,GAAGqJ,CAAH,CAAKtC,KAAL,EAAW,EAAX,CAAd,CAAZ;AACA,YAAI6K,UAAU5R,GAAG6R,QAAH,CAAY,YAAK;AAC3B7M,iBAAKjB,YAAL,CAAkB,YAAlB,EAAgC+N,SAAhC;AACH,SAFa,EAEZ,IAFY,CAAd;AAGA;AACA,aAAKjR,QAAL,CAAcsF,QAAd,CAAuBnB,IAAvB;AACAA,aAAK8G,SAAL,CAAe9L,GAAG+R,QAAH,CAAYJ,MAAZ,EAAoBC,OAApB,CAAf;AACH,KAx6BI;AAy6BLI,qBAAgB,2BAAU;AACtB,YAAI9H,OAAO,CAAX;AACA,aAAI,IAAIC,MAAM,CAAd,EAAiBA,OAAK,CAAtB,EAAwBA,KAAxB,EAAgC;AAC5B,gBAAIC,WAAW,KAAK/E,SAAL,CAAe6E,IAAf,EAAqBC,GAArB,CAAf;AACA,gBAAIE,SAAS,KAAKC,aAAL,CAAmBJ,IAAnB,EAAyBC,GAAzB,CAAb;AACAI,oBAAQ5F,GAAR,CAAY,OAAZ,EAAoBuF,IAApB,EAAyB,MAAzB,EAAgCC,GAAhC,EAAoCC,QAApC;AACAxK,iCAAqB4K,kBAArB,CAAwCH,MAAxC,EAAgD,KAAKxG,kBAAL,CAAwBmB,IAAxE,EAA8EoF,QAA9E;AACH;AACJ;AAj7BI,CAAT;AAm7BA","file":"BoxController.js","sourceRoot":"../../../../../assets/src/controller","sourcesContent":["/**\n * Created by bing on 20/04/2018.\n */\n\n//负责head展现和变换。\nconst CameraController = require('CameraController');\nlet StageConfig = require(\"StageConfig\");\nlet BlockConfig = require(\"BoxConfig1\");\nlet CycleConfig = require(\"CycleConfig\");\nlet ToolConfig = require(\"ToolConfig\");\nlet AttributeConfig = require(\"AttributeConfig\");\nlet AcceleratorConfig = require(\"AcceleratorConfig\");\nlet BoxConfig = require(\"BoxConfig\");\nlet RewardConfig = require(\"RewardConfig\");\n\n\nlet GameType = require(\"GameType\");\nlet GameUtils = require(\"GameUtils\");\nlet GameState = require(\"GameState\");\nlet BlockBigFactory = require(\"BlockBigFactory\");\nlet BlockSmallFactory = require(\"BlockSmallFactory\");\nlet RewardItemFactory = require(\"RewardItemFactory\");\nlet SpriteFrameCenter = require(\"SpriteFrameCenter\");\nlet ParticleSystemCenter = require(\"ParticleSystemCenter\");\nlet SkeletonDataCenter = require(\"SkeletonDataCenter\");\n// let GameMenuController = require('GameMenuController');\n\nlet Global = require('Global');\n\n\nlet winsize = cc.winSize;\nconst BaseHeight =  winsize.height/2;\nconst BaseWidth =  winsize.width/2;\nconst GameHeight = 514;\nconst GameCenterY = 360;\nconst BaseGame = 257 ;\n\ncc.Class({\n    extends:cc.Component,\n\n    properties:{\n        gameNode:cc.Node,\n        camera: cc.Camera,\n        BlockBig:cc.Prefab,\n        BlockSmall:cc.Prefab,\n        MarginsBig:cc.Prefab,\n        MarginsSmall:cc.Prefab,\n        RewardItem:cc.Prefab,\n        UIBottom:cc.Prefab,\n        Sky:cc.Node,\n        Bgbz:cc.Node,\n        Underground:cc.Node,\n        motionStreak: cc.MotionStreak,\n        // hammer: sp.Skeleton,\n        boxSpine:sp.Skeleton,\n        btnbox:cc.Button,\n        GameMenu:cc.Node,\n        treasure:cc.Button,\n        upgradView:cc.Node,\n        bgopenbox:cc.Sprite,\n        // GameMenuController: GameMenuController,\n        language:{\n            visible: false,\n            default:\"English\"\n        },\n        type:{\n            visible : false,\n            default:0\n        },\n        rowNum:{\n            visible:false,\n            default:5\n        },\n        blockWidth:100,\n        blockBlank:{\n            visible:false,\n            default:0\n        },\n        moveNum:{\n            visible:false,\n            default:0\n        },\n        margins:{\n            visible:false,\n            default:0\n        },\n        curMaxLine:{\n            visible: false,\n            default:0\n        },\n        canTouch:{\n            visible:false,\n            default:true\n        },\n        previousPt:{\n            visible:false,\n            default:null\n        },\n        Hatting:{\n            visible:false,\n            default:false\n        },\n        HattingPos:{\n            visible: false,\n            default:null\n        },\n        accelerHammer:{\n            visible:false,\n            default:1\n        },\n        accelerGold:{\n            visible:false,\n            default:1\n        },\n        gameState:GameState.init ,//0 init 1 playing 2 rolling 3 end\n    },\n\n\n    onLoad:function () {\n        SpriteFrameCenter.preLoadAtlas(\"png/box\",this.initdata.bind(this));\n        this.GameMenuController = cc.find(\"GameMenu\").getComponent(\"GameMenuController\");\n        Global.initInfo();\n        this.blocks = [];\n        this.marginlist=[];\n        this.hammers={};\n        this.rewardItem =[];\n        this.accelerHammer=1;\n        this.accelerGold = 1;\n        this.startPos = -GameHeight/2;\n        this.boxSpine.setCompleteListener(trackEntry => {\n            var animationName1 = trackEntry.animation ? trackEntry.animation.name : \"\";\n            cc.log(\"recordSpine [track %s][animation %s] end.\", trackEntry.trackIndex, animationName1);\n            // this.restart();\n            this.addItems();\n\n        });\n        this.firstOpen = true;\n    },\n    playBoxSpine:function () {\n        this.boxSpine.node.active = true;\n        this.boxSpine.setAnimation(0, \"newAnimation\", false);\n    },\n    stopBoxSpine:function () {\n        this.boxSpine.node.active = false;\n    },\n    playHammerSpine:function (hammerpos) {\n\n        this.hammers[hammerpos].node.active = true;\n        this.hammers[hammerpos].setAnimation(0, \"newAnimation\", true);\n    },\n    playHammers:function(){\n        for( var i = 3 ;i< 7;i++){\n            if(this.hammers[i] != undefined){\n                this.setSmPosition(i);\n            }\n        }\n    },\n    stopHammerSpine:function (hammerpos) {\n        this.hammers[hammerpos].node.active = false;\n    },\n    addHammer:function(id){\n        let node = new  cc.Node();\n        let hammer = node.addComponent(sp.Skeleton);\n        let info = ToolConfig[id];\n        let animation = info.animation;\n        let conf = AttributeConfig[info.attribute];\n\n        SkeletonDataCenter.addSkeletonData(animation,hammer) ;\n        this.GameMenu.addChild(node);\n        this.hammers[id]=hammer;\n        hammer.node.active = false;\n        hammer.setCompleteListener(trackEntry => {\n            var animationName = trackEntry.animation ? trackEntry.animation.name : \"\";\n            cc.log(\"HammerSpine [track %s][animation %s] end.\", trackEntry.trackIndex, animationName);\n            hammer.node.active = false;\n            if(this.checkCanHammer(id)){\n                this.smCallback(id);\n            }\n        });\n        let  timescale = 0.17*conf.att/parseFloat(conf.time)*this.accelerHammer;\n        hammer.timeScale = timescale;\n    },\n    changeHammerSpine:function(data){\n        this.hammer.skeletonData = data;\n    },\n    start:function(){\n        this.GameMenuController.initInfo();\n        this.hammers={};\n        let timescale=1;\n        let hammer = Global.hammer;\n        for(let i=1;i<7;i++){\n            if(hammer[i]  == undefined)\n                continue;\n            if(ToolConfig[i].id ==1 || ToolConfig[i].id ==2 )\n                continue;\n            let node = new  cc.Node();\n            let nodehammer = node.addComponent(sp.Skeleton);\n            let info = ToolConfig[i];\n            let animation = info.animation;\n            SkeletonDataCenter.addSkeletonData(animation,nodehammer) ;\n            this.GameMenu.addChild(node);\n            this.hammers[hammer[i].id]=nodehammer;\n            nodehammer.node.active = false;\n            nodehammer.setCompleteListener(trackEntry => {\n                var animationName = trackEntry.animation ? trackEntry.animation.name : \"\";\n                cc.log(\"HammerSpine [track %s][animation %s] end.\", trackEntry.trackIndex, animationName);\n                nodehammer.node.active = false;\n                if(this.checkCanHammer(i)){\n                    this.smCallback(i);\n                }\n            });\n            let attribute = Global.hammer[i].attribute;\n            let conf1 = AttributeConfig[attribute];\n            nodehammer.timeScale = 0.17 * conf1.att/parseFloat(conf1.time) *this.accelerHammer;\n        }\n\n    },\n    restart:function(){\n        if(Global.hard<10){\n            Global.hard++;\n        }\n        this.boxSpine.node.active = false;\n        for(let i=1;i<4;i++){\n            // let node = this.rewardItem[i];\n            this.rewardItem[i].destroy();\n            // if(cc.isValid( node)){\n            //     node.destroy();\n            // }\n        }\n        this.rewardItem =[];\n        // this.addItems();\n        this.initdata();\n        this.gameState = GameState.hatting;\n\n    },\n    initdata:function(){\n        let floorNum=StageConfig[Global.hard].layer;\n        for (var i = 0;i<BlockConfig.length;i++){\n            if(BlockConfig[i].blockwidth == StageConfig[Global.hard].size){\n                this.type = BlockConfig[i].type;\n                break;\n            }\n        }\n        this.rowNum=BlockConfig[this.type].count;\n        this.blockWidth=BlockConfig[this.type].blockwidth;\n        this.blockBlank=BlockConfig[this.type].blank;\n        this.margins=BlockConfig[this.type].margins;\n\n        this.addBlocks();\n        this.cameraStartPosY();\n        this.btnbox.node.active = true;\n        this.playHammers();\n        this.initTreasure();\n        if(this.firstOpen){\n            this.GameMenuController.addUIBottom();\n            this.firstOpen= false;\n        }\n\n    },\n    checkCanHammer :function(id){\n        var hammer = Global.hammer;\n        if(hammer[id] != undefined && hammer[id].attribute != -1)\n            return true;\n        return false;\n    },\n    resetMarginList:function(){\n        if(this.marginlist.length>0){\n            for(let i=0 ;i<this.marginlist.length;i++){\n                let node = this.marginlist[i];\n                if(cc.isValid(node)){\n                    node.destroy();\n                }\n            }\n        }\n        this.marginlist=[];\n    },\n    resetBlockList:function(){\n        if(this.blocks.length>0){\n            for(let i=0 ;i<this.blocks.length;i++){\n                for( let j=0;j<this.blocks[i].length;j++){\n                    let node = this.blocks[i][j];\n                    if(cc.isValid(node)){\n                        node.destroy();\n                    }\n                }\n            }\n        }\n        this.blocks=[];\n    },\n    //--------- block -----------------------\n    addBlocks:function() {\n\n        this.resetBlockList();\n        this.resetMarginList();\n        let floorNum=StageConfig[Global.hard].layer;\n        for (var i =0;i< floorNum-1;i++){\n\n            var lineinfo=this.addLines(this.getPngName(StageConfig[Global.hard].cycleID,i),i);\n\n            this.blocks.push(lineinfo);\n            lineinfo=[];\n        }\n        let topline = this.addLines(StageConfig[Global.hard].top,i);\n        this.blocks.push(topline);\n    },\n    addLines:function (pngname,thisNum) {\n\n        let conf=BlockConfig[this.type];\n        let count = conf.count;\n        let factory= this.type == 0?BlockBigFactory:BlockSmallFactory;\n        let curX= conf.margins+conf.blank -BaseWidth;\n        let curY= thisNum*(this.blockWidth+conf.blank) + this.startPos;\n        let lineArray=[];\n        let left = factory.createMargins(pngname);\n\n        left.position = cc.p(conf.margins/2-BaseWidth,curY+this.blockWidth/2);\n        this.gameNode.addChild(left);\n        this.marginlist.push(left);\n        let right = factory.createMargins(pngname);\n        let endpos = BaseWidth- conf.margins/2;\n        right.position = cc.p(endpos,curY+this.blockWidth/2);\n        this.gameNode.addChild(right);\n        this.marginlist.push(right);\n\n        for(var i=0;i<count;i++){\n            let node = factory.create(pngname);\n            node.position = cc.p(curX+this.blockWidth/2,curY+this.blockWidth/2);\n            curX+=this.blockWidth+conf.blank;\n            this.gameNode.addChild(node);\n            lineArray.push(node);\n        }\n\n        return lineArray;\n    },\n\n    //根据 获得 图片的名字\n    getPngName(cycleID,thisNum){\n        let thisID;\n        if(cycleID.indexOf(\";\") != -1){\n            let cycleArry = cycleID.split(\";\");\n            let getnum=GameUtils.randomInt(0,cycleArry.length-1);\n            thisID=cycleArry[getnum];\n        }else{\n            thisID=parseInt(cycleID);\n        }\n        let neednumber=0;\n        for(var i =1;i<=10 ;i++)\n        {\n            if(CycleConfig[thisID][\"num\"+i] == 0){\n                i=0;\n                continue;\n            }\n            neednumber+=CycleConfig[thisID][\"num\"+i];\n            if(neednumber>=thisNum){\n                return CycleConfig[thisID][\"block\"+i]\n            }\n            if(i==10){\n                i=0;\n            }\n        }\n    },\n    //销毁砖块\n    destroyBlock:function(line,row ){\n\n        if(!this.blocks[line])\n            return;\n        let node = this.blocks[line][row];\n        let location = this.hammerpos(line,row);\n        let texiao=this.getEffByBlock(line,row);\n        if(cc.isValid(node) ) {\n            console.log(\"destroylog:\",line,\":\",row,location);\n            ParticleSystemCenter.addParticleForNode(texiao+\".plist\",this.GameMenuController.node,location);\n            node.removeFromParent(true);\n            this.blocks[line][row]=null;\n            this.destroyUpdate();\n        }\n\n    },\n    checkCanDestroy :function(line,row){\n        if(!cc.isValid(this.blocks[line]) || !cc.isValid(this.blocks[line][row]) )\n            return false;\n        let floorNum=StageConfig[Global.hard].layer;\n        if(line >= floorNum-1)\n            return true;\n        let node;\n        node = this.blocks[line+1][row];\n        if(!cc.isValid(node)){\n            return true;\n        }\n        if(line>0){\n            node = this.blocks[line-1][row];\n            if(!cc.isValid(node)){\n                return true;\n            }\n        }\n        if(row>0 && row <this.rowNum-1){\n            node = this.blocks[line][row-1];\n            if(!cc.isValid(node)){\n                return true;\n            }\n            node = this.blocks[line][row+1];\n            if(!cc.isValid(node)){\n                return true;\n            }\n        }else if (row == 0){\n            node = this.blocks[line][row+1];\n            if(!cc.isValid(node)){\n                return true;\n            }\n        }else if(row == this.rowNum-1){\n            node = this.blocks[line][row-1];\n            if(!cc.isValid(node)) {\n                return true;\n            }\n        }\n        return false;\n    },\n    destroyUpdate:function(){\n        // this.myinfo.exp++;\n        Global.exp++;\n        Global.gold = Global.gold+ 1*(this.accelerGold);\n        // cc.sys.localStorage.setItem('myinfo',JSON.stringify(this.myinfo));\n        Global.saveExp(Global.exp);\n        Global.saveGold(Global.gold);\n        let myinfo = {};\n        myinfo.exp = Global.exp+1;\n        myinfo.gold = Global.gold+1*(this.accelerGold);\n        this.GameMenuController.updateDate(myinfo);\n    },\n    //--------- block -----------------------\n    maxLineNum:function(){\n        var max=0;\n        let floorNum=StageConfig[Global.hard].layer;\n        for(var i=0;i<floorNum;i++){\n            for(var j= 0;j<this.rowNum;j++) {\n                if (this.blocks && this.blocks[i] && this.blocks[i][j]) {\n                    var node = this.blocks[i][j];\n                    if (!cc.isValid(node))\n                        continue;\n                     // sss\n                    if (i > max) {\n                        max = i;\n                    }\n                    break;\n                }\n            }\n        }\n        return max;\n    },\n\n    totoalRowNum:function(line) {//line 行拥有点的数量\n        var max = 0;\n        for(var j= 0;j<this.rowNum;j++){\n            var node = this.blocks[line][j];\n            if(!cc.isValid(node) )\n                continue;\n            max++;\n        }\n        return max;\n    },\n\n    //************camera 相关设置 start **********************\n    cameraCentPosY:function(){\n\n        let maxline=this.maxLineNum();\n        if(this.curMaxLine<= maxline){\n            return;\n        }\n        let move = this.curMaxLine-maxline;\n        this.curMaxLine=maxline;\n        let oldY = this.camera.node.getPositionY();\n        if(oldY<=GameCenterY){\n            return;\n        }\n        let newY= oldY-this.blockWidth*move;\n        let moveY=0 ;\n        if(newY>=GameCenterY){\n            moveY = newY;\n        }else {\n            moveY = GameCenterY;\n        }\n       let  location = cc.p(BaseWidth,moveY);\n        let action1 = cc.moveTo(0.1,location);\n        this.camera.node.runAction(action1);\n         // this.camera.node.setPositionY(moveY);\n\n\n    },\n\n    cameraStartPosY:function(){\n        let floorNum=StageConfig[Global.hard].layer;\n        let height = floorNum*(this.blockWidth+this.blockBlank);\n        //地下\n        this.Underground.height=height;\n        let posbottom= (height-GameHeight)/2;\n        this.Underground.y=posbottom;\n        //地面\n        let totoal= this.Bgbz.height+height -50;\n        let skyposy;\n        let bzYbottom;\n        let other = GameHeight- totoal;\n        bzYbottom= (totoal+height - GameHeight)/2 -25;\n        this.Bgbz.y=bzYbottom;\n        if(other>0){\n            this.Sky.active = true;\n            this.Sky.height = other+10;\n            skyposy= (GameHeight - other)/2;\n            this.Sky.y=skyposy;\n            this.camera.node.setPositionY(GameCenterY);\n        }else{\n            this.Sky.active = false;\n            this.camera.node.setPositionY(GameCenterY - other);\n\n        }\n        this.curMaxLine = floorNum -1;\n    },\n\n\n    //************camera 相关设置 end **********************\n    //*********** 锤子 相关设置  start***************\n    setSmPosition:function(hammerpos){\n        let realwidth=this.blockWidth+this.blockBlank;\n        let maxline = this.curMaxLine;\n        let maxrow = this.totoalRowNum(0);\n        if(maxline == 0 && maxrow ==   0)\n        {\n            this.HattingPos =null;\n            // this.sm.node.visible = false;\n            this.hammers[hammerpos].node.active = false;\n            return ;\n        }\n        this.hammers[hammerpos].node.active = true;\n        let range = this.geScreenRange();\n        // let line = GameUtils.randomInt(range.min,range.max);\n        let line = this.curMaxLine;\n        let find = false;\n        let canclick=[];\n        for(var i = 0;i<this.rowNum;i++){//当前行可以删除的\n            if(this.blocks[line]&&this.checkCanDestroy(line,i) ){\n                let find = false;\n                for(let j=3;j<=6;j++){\n                    if( this.HattingPos && this.HattingPos[j]){\n                        if(this.HattingPos[j].x == line && i ==this.HattingPos[j].y){\n                            find= true;\n                            break;\n                        }\n                    }\n                }\n                if(!find){\n                    canclick.push(i);\n                }\n            }\n        }\n\n        if(canclick.length ==0 && line ==0){\n            this.HattingPos[hammerpos] = null;\n            return;\n        }else if(canclick.length == 0){\n            line= line-1;\n            for(var i = 0;i<this.rowNum;i++){//当前行可以删除的\n                if(this.blocks[line]&&this.checkCanDestroy(line,i) ){\n                    let find = false;\n                    for(let j=3;j<=6;j++){\n                        if( this.HattingPos && this.HattingPos[j]){\n                            if(this.HattingPos[j].x == line && i ==this.HattingPos[j].y){\n                                find= true;\n                                break;\n                            }\n                        }\n                    }\n                    if(!find){\n                        canclick.push(i);\n                    }\n                }\n            }\n        }\n        let num = GameUtils.randomInt(0,canclick.length-1);\n        let row= canclick[num];\n\n        let location = this.hammerpos(line,row);\n        let texiao=this.getEffByBlock(line,row);\n        if(this.HattingPos == null){\n            this.HattingPos= {};\n        }\n        this.HattingPos[hammerpos] ={x:line,y:row};\n        this.hammers[hammerpos].node.position=location;\n        this.playHammerSpine(hammerpos);\n    },\n    //根据小块的位置 过的特效文件\n    getEffByBlock(line,row){\n\n        let type = this.type == 0? \"BlockBig\":\"BlockSmall\";\n        let node = this.blocks[line][row].getComponent(type);\n        return node.getPngId();\n    },\n    geScreenRange : function(){\n        let max = this.curMaxLine;\n        let cameraPosY = this.camera.node.getPositionY();\n        let min=0;\n        let realwidth=this.blockWidth+this.blockBlank;\n        if(cameraPosY <= BaseHeight){\n            min =0;\n        }else{\n            let maxPosY= max*realwidth;\n            let canshowy = (maxPosY - cameraPosY+BaseHeight)/realwidth;\n            min = Math.floor(max- canshowy);\n        }\n        return {max:max,min:min};\n    },\n    //根据块的位置计算锤子的位置\n    hammerpos:function(line,row){\n        let cameraY= this.camera.node.getPositionY();\n        let gameY = this.gameNode.y;\n        let realwidth=this.blockWidth+this.blockBlank;\n        let realx = row * realwidth+this.margins+this.blockBlank;\n        let realy = line * realwidth+gameY -cameraY -BaseGame;\n        let hamX= realx - BaseWidth - 42+this.blockWidth;\n        let hamY = realy - 42;\n        return cc.p(hamX,hamY);\n\n    },\n    smCallback:function(hammerpos){\n        if(this.HattingPos != null && this.HattingPos[hammerpos]!=null ){\n            let y= this.HattingPos[hammerpos].y;\n            let x= this.HattingPos[hammerpos].x;\n            if(cc.isValid(this.blocks[x][y])){\n                this.destroyBlock(x,y);\n            }\n            this.cameraCentPosY();\n            this.setSmPosition(hammerpos);\n        }\n    },\n    //*********** 锤子 相关设置  end*****************\n\n    updateTouch:function(point){\n        let cameraY= this.camera.node.getPositionY();\n        let gameY = this.gameNode.y;\n        let realwidth=this.blockWidth+this.blockBlank;\n        var line = Math.floor((point.y-(gameY-cameraY+BaseHeight - BaseGame))/realwidth);\n        var row = Math.floor((point.x-this.margins - this.blockBlank)/realwidth);\n        let find = false;\n        if(this.checkCanDestroy(line,row)){\n            for(var i=3;i<7;i++){\n                if(this.HattingPos != null && this.HattingPos[i] != null && this.HattingPos[i] != undefined){\n                    if(this.HattingPos[i].x == line && this.HattingPos[i].y == row ){\n                        this.hammers[i].node.active = false;\n                        this.smCallback(i);\n                        find =true;\n                        break;\n                    }\n                }\n            }\n            if(!find){\n                this.destroyBlock(line,row);\n            }\n        }\n    },\n    touchStartCallBack:function (location) {\n        if(!this.canTouch){\n            return;\n        }\n        if(this.gameState == GameState.end){\n            this.bgopenbox.node.active = false;\n            this.restart();\n        }\n        if(location.x<this.margins || location.x >(2*BaseWidth-this.margins)){\n            this.motionStreak.reset();\n            return;\n        }\n        console.log(\"touchStartCallBack\");\n        this.previousPt = location;\n        this.motionStreak.node.setPositionX(location.x);\n        this.motionStreak.node.setPositionY(location.y);\n        this.motionStreak.reset();\n\n        // this.isTouching = false;\n    },\n\n    touchCancelCallBack:function (location) {\n        this.updateTouch(location);\n        this.isTouching = false;\n        this.motionStreak.reset();\n    },\n\n    touchEndCallBack:function (location) {\n        // this.touchPosition(location);\n        this.updateTouch(location);\n        this.isTouching = false;\n        console.log(\"touchEndCallBack\");\n        this.motionStreak.reset();\n    },\n    touchMoveCallBack:function (location) {\n        if(location.x<this.margins || location.x >(2*BaseWidth-this.margins\n            || location.y<216 )){\n            this.motionStreak.reset();\n            return;\n        }\n        this.updateTouch(location);\n        this.previousPt = location;\n        this.motionStreak.node.setPositionX(location.x);\n        this.motionStreak.node.setPositionY(location.y);\n    },\n\n    onClickTreasure:function(event){\n        var maxlinenum= this.maxLineNum();\n        var totoalRowNum= this.totoalRowNum(0);\n        if(maxlinenum != 0  || totoalRowNum != 0){\n            this.touchEndPoint = event.getLocation();\n\n            this.updateTouch(this.touchEndPoint);\n            return;\n        }\n        this.btnbox.node.active = false;\n        this.gameState = GameState.end;\n        this.playBoxSpine();\n    },\n    update:function(){\n        this.cameraCentPosY();\n    },\n    eventcallback: function(type, id, string = null) {\n        // let node= this.itemList.indexOf(sender);\n        switch (type) {\n            case 0:\n                if(string == null)\n                    this.accleleratorChange(id);\n                else{\n                    if(string == 'finish'){\n                        this.accleleratorrRecover(id);\n                    }\n                }\n                break;\n            case 1:\n                // let info = ToolConfig[id];\n                // let animation = info.animation;\n                // // BoxController.changeHammerSpine(animation);\n                // SkeletonDataCenter.addSkeletonData(animation, BoxController.changeHammerSpine);\n                this.toolChange(id);\n                break;\n            case 2:\n                break;\n        }\n    },\n    accleleratorChange:function(id){\n        let conf = AcceleratorConfig[id];\n        Global['bar'+id]= conf.time;\n        this.changeHammerSpeed();\n        this.GameMenuController.updateButtom();\n\n    },\n    accleleratorrRecover:function(id){\n        this.changeHammerSpeed();\n        this.GameMenuController.updateButtom();\n    },\n\n    changeHammerSpeed:function(){\n        let speedHammer = 0;\n        let speedGold = 0;\n        for (let i = 1 ;i<=2;i++){\n            if(Global['bar'+i]>0){\n                speedHammer +=AcceleratorConfig[i].speed;\n                speedGold+=AcceleratorConfig[i].coin;\n            }\n        }\n\n\n        if(speedHammer ==0){\n            speedHammer = 1;\n        }\n        if(speedGold == 0){\n            speedGold = 1;\n        }\n        this.accelerHammer = speedHammer;\n        this.accelerGold = speedGold;\n        for(let i = 3;i<=6; i++ ){\n            if( this.hammers[i] != undefined){\n                let conf1=AttributeConfig[Global.hammer[i].attribute];\n                this.hammers[i].timeScale = 0.17*(conf1.att/parseFloat(conf1.time))* this.accelerHammer;\n            }\n        }\n    },\n    changeGoldSpeed:function(){\n\n    },\n    toolChange:function(id) {\n        let info = ToolConfig[id];\n        // let animation = info.animation;\n        // this.BoxController.changeHammerSpine(animation);\n        // let node = this.BoxController.hammers[id-1];\n        // SkeletonDataCenter.addSkeletonData(animation,node);\n\n        if(Global.hammer[id] == undefined){\n            let bool =this.checkCanAdd(id);\n            if(bool) {\n                Global.hammer[id] = {id: id, attribute: info.attribute};\n                Global.saveHammer(Global.hammer);\n                if(id != 1 && id !=2){\n                    this.addHammer(id);\n                    this.setSmPosition(id);\n                }\n            }else{\n                this.addAdTime(id);\n            }\n            this.GameMenuController.updateButtom();\n        }else{\n\n            let conf = AttributeConfig[Global.hammer[id].attribute];\n            let mess ={};\n\n            if(conf.costtype = 1001){\n                Global.gold -= conf.cost;\n                mess['gold']=Global.gold;\n            }else if(conf.costtype = 1002){\n                Global.gem -= conf.cost;\n                mess['gem']=Global.gem;\n            }\n            if(conf.next != -1){\n                Global.hammer[id].attribute = conf.next;\n                let conf1=AttributeConfig[conf.next];\n                Global.saveHammer(Global.hammer);\n                this.hammers[id].timeScale = 0.17*(conf1.att/parseFloat(conf1.time)) * this.accelerHammer;\n            }\n            this.GameMenuController.updateDate(mess);\n        }\n    },\n    checkCanAdd:function(id){\n        let conf = ToolConfig[id];\n        let thisID;\n        let confArry;\n        if(id == 1 || id == 2 )\n            return false;\n        if(\"unlock\" in conf) {\n            if (conf.unlock.indexOf(\";\") != -1) {\n                confArry = conf.unlock.split(\";\");\n                thisID = confArry[0];\n            } else {\n                thisID = parseInt(conf.unlock);\n            }\n            if (thisID == -1 ) {\n                return true;\n            }\n            if(thisID == 0){//点击激活\n                return true;\n            }else if(thisID == 1){//视频激励\n                 return Global.openAdTimes>0;\n            }else if(thisID == 2){//等级激活\n                let needlvl = confArry[1];\n                if(Global.level<needlvl){\n                    return false;\n                }else{\n                    return true;\n                }\n\n            }else if(thisID == 3){//邀请好友\n                if( Global.inviteFriends< confArry[1])\n                    return false;\n                else\n                    return true;\n            }\n        }\n        return true;\n\n    },\n    addAdTime:function(id){\n        let conf = ToolConfig[id];\n        let thisID;\n        let confArry;\n        if(id == 1 || id == 2 )\n            return;\n        if(\"unlock\" in conf) {\n            if (conf.unlock.indexOf(\";\") != -1) {\n                confArry = conf.unlock.split(\";\");\n                thisID = confArry[0];\n            } else {\n                thisID = parseInt(conf.unlock);\n            }\n            if(thisID == 1){//视频激励\n                return Global.openAdTimes++;\n            }else if(thisID == 3){//邀请好友\n                Global.inviteFriends++;\n            }\n        }\n    },\n    addItems:function(){\n\n        let hard = Global.hard;\n        let boxID = StageConfig[hard].box;\n        let rewardID= BoxConfig[boxID].reward;\n        let conf = RewardConfig[rewardID];\n        let num = conf.num;\n        let itemdata = {};\n        let totoal=0;\n        let reward ={};\n        let max =0;\n        for (let i =1;i<7;i++){\n            if(conf['rate'+i] !=0){\n                totoal=conf['rate'+i];\n                if(i == 1){\n                    itemdata[i] = totoal;\n                    max = itemdata[i];\n                }else{\n                    itemdata[i] = itemdata[i-1] + totoal;\n                    max = itemdata[i];\n                }\n            }\n        }\n        for (let j=1;j<=num;j++){\n            let random= GameUtils.random(max);\n            for(let z =1;itemdata[z] != undefined;z++){\n                if(itemdata[z]<random){\n                    continue;\n                }\n                reward[j]=conf['item'+z];\n                break;\n            }\n        }\n        let gold =0;\n        let gem= 0;\n        let str =\"\";\n        for(let i=1; i<=num;i++){\n            if(reward[i] != undefined){\n                str+=reward[i]+\"--\";\n                if(reward[i].indexOf(\";\") != -1){\n                    let rewardarry = reward[i].split(\";\");\n                    if(rewardarry[0] == 1001){\n                        gold+=parseInt(rewardarry[1]);\n                    }else if(rewardarry[0] == 1002){\n                        gem+=parseInt(rewardarry[1]);\n                    }\n                }\n            }\n            this.createRewardItem(reward[i],i);\n            this.bgopenbox.node.active = true;\n        }\n        if(gold>0 || gem >0){\n            let golds = Global.gold+gold;\n            let gems = Global.gem+gem;\n            this.GameMenuController.updateDate({gold:golds,gem:gems});\n            Global.saveGold(golds);\n            Global.saveGem(gems );\n        }\n\n    },\n    initTreasure:function(){\n        let BoxID = StageConfig[Global.hard].box;\n        let BoxConf = BoxConfig[BoxID];\n        this.treasure.normalSprite = SpriteFrameCenter.getFrameFromAtlas(\"png/box\",BoxConf.icon+\".png\");\n        this.treasure.pressedSprite = SpriteFrameCenter.getFrameFromAtlas(\"png/box\",BoxConf.icon+\".png\");\n        this.treasure.hoverSprite = SpriteFrameCenter.getFrameFromAtlas(\"png/box\",BoxConf.icon+\".png\");\n        this.treasure.disabledSprite = SpriteFrameCenter.getFrameFromAtlas(\"png/box\",BoxConf.icon+\".png\");\n        let animation = BoxConf.animation;\n        SkeletonDataCenter.addSkeletonDataWait(animation,  this.boxSpine);\n        this.treasure.node.y = - GameHeight/2+ this.blockWidth+35 -20;\n        this.boxSpine.node.y = - GameHeight/2+ this.blockWidth+35 -20;\n\n    },\n    createRewardItem:function(reward,i){\n        if(this.rewardItem[i]){\n            this.rewardItem[i].destroy();\n            this.rewardItem[i]=null;\n        }\n        let start = -400 +i*200;\n\n        let node = RewardItemFactory.create(reward);\n        let location = this.treasure.node.position;\n        this.rewardItem[i]=(node);\n        node.position = location;\n        let action =cc.moveTo(0.5,cc.p(start,10));\n        let action2 = cc.callFunc(()=> {\n            node.getComponent(\"RewardItem\").setFinish();\n        },this);\n        // node.runAction(cc. moveTo(0.5,cc.p(start,-20)));\n        this.gameNode.addChild(node);\n        node.runAction(cc.sequence(action, action2));\n    },\n    onclickOtherBtn:function(){\n        let line = 2;\n        for(let row = 9; row>=0;row-- ) {\n            let location = this.hammerpos(line, row);\n            let texiao = this.getEffByBlock(line, row);\n            console.log(\"line:\",line,\"row:\",row,location);\n            ParticleSystemCenter.addParticleForNode(texiao, this.GameMenuController.node, location);\n        }\n    }\n});\n//"]}