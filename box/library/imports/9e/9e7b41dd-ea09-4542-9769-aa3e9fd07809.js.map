{"version":3,"sources":["../../../../../assets/src/view/assets/src/view/UpgradView.js"],"names":["Global","require","StageConfig","BoxConfig","RewardConfig","GameConfig","GameUtils","LevelConfig","EfficiencyConfig","LanguageConfig","cc","Class","extends","Component","properties","RewardLable","Label","TitleLable","DescLable","vediodesc","nextdesc","BoxController","language","onLoad","type","msg","onEnable","btnType","addlevel","jumpTimeReward","outlineReward","myinfo","level","needexp","exp","needgold","rewardcoin","addgold","saveLevel","saveExp","claim","string","formatNumMAX","GameMenuController","updateDate","desc","time","skipID","jumptime","formatHour","Math","floor","onNextBtn","golds","gold","saveGold","node","active","onVedioSureBtn","isFBInstantGame","loadingView","FBP","RewardedVideoAsync","seeAdCallBack"],"mappings":"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","file":"UpgradView.js","sourceRoot":"../../../../../assets/src/view","sourcesContent":["/*\n * Created by Ren on 2018/6/12.\n */\nlet Global = require('Global');\nlet StageConfig = require(\"StageConfig\");\nlet BoxConfig = require(\"BoxConfig\");\nlet RewardConfig = require(\"RewardConfig\");\nlet GameConfig = require(\"GameConfig\");\nlet GameUtils = require(\"GameUtils\");\nlet LevelConfig =require(\"LevelConfig\");\nlet EfficiencyConfig =require(\"EfficiencyConfig\");\nlet LanguageConfig = require(\"LanguageConfig\");\ncc.Class({\n\n    extends:cc.Component,\n    properties:{\n\n        RewardLable:cc.Label,\n        TitleLable:cc.Label,\n        DescLable:cc.Label,\n        vediodesc:cc.Label,\n        nextdesc:cc.Label,\n        BoxController:require('BoxController'),\n        language:'English'\n    },\n\n    onLoad:function () {\n        this.type;\n        this.msg={'uplevel':3,'skip':2,'outline':2};\n    },\n    onEnable:function(){\n        this.type= this.msg[Global.btnType];\n        if(Global.btnType == 'uplevel')\n        {\n            this.addlevel();\n\n        }\n        else if(Global.btnType == 'skip'){\n            this.jumpTimeReward();\n\n        }else{\n            this.outlineReward();\n        }\n\n\n    },\n    addlevel:function(){\n        let myinfo ={};\n        let level =Global.level;\n        let needexp = LevelConfig[ level].exp;\n        let needgold = LevelConfig[ level].rewardcoin;\n        Global.addgold = needgold;\n        myinfo.exp =Global.exp-needexp;\n        myinfo.level =Global.level+1;\n        Global.saveLevel( myinfo.level);\n        Global.saveExp( myinfo.exp);\n        let claim = LanguageConfig['10028'][Global.language];\n        this.TitleLable.string = LanguageConfig['10026'][Global.language];\n        this.DescLable.string = LanguageConfig['10027'][Global.language];\n        needgold = GameUtils.formatNumMAX(needgold);\n        this.RewardLable.string = \"x\"+needgold;\n        this.nextdesc.string = claim;\n        this.vediodesc.string = claim+'x'+this.type;\n        Global.addgold =needgold;\n        this.BoxController.GameMenuController.updateDate(myinfo);\n    },\n    //离线奖励\n    outlineReward:function(){\n\n        let claim = LanguageConfig['10028'][Global.language];\n        this.TitleLable.string = LanguageConfig['10033'][Global.language];\n        this.DescLable.string = LanguageConfig['10032'][Global.language];\n        let  needgold = GameUtils.formatNumMAX(Global.addgold);\n        this.RewardLable.string = \"x\"+needgold;\n        this.nextdesc.string = claim;\n        this.vediodesc.string = claim+'x'+this.type;\n\n    },\n    //跳过时间\n    jumpTimeReward:function(){\n        let claim = LanguageConfig['10028'][Global.language];\n        let desc= LanguageConfig['10031'][Global.language];\n        let time = EfficiencyConfig[Global.skipID].jumptime;\n        desc= GameUtils.formatHour(desc,time);\n        Global.addgold = Math.floor(Global.addgold);\n        this.TitleLable.string = LanguageConfig['10017'][Global.language];\n        this.DescLable.string =desc;\n        let  needgold = GameUtils.formatNumMAX(Global.addgold);\n        this.RewardLable.string = \"x\"+needgold;\n        this.nextdesc.string = claim;\n        this.vediodesc.string = claim+'x'+this.type;\n    },\n    onNextBtn:function(){\n\n        let golds = Global.gold+Global.addgold;\n        this.BoxController.GameMenuController.updateDate({gold:golds});\n        Global.saveGold(golds);\n        if(Global.addgold>0 ){\n            this.node.active = false;\n            Global.saveGold(golds);\n        }\n        Global.addgold =0;\n        this.node.active = false;\n\n    },\n    onVedioSureBtn:function() {\n\n\n        if (GameConfig.isFBInstantGame()) {\n            this.BoxController.loadingView.active = true;\n            let FBP = require(\"FBPlugin\");\n            FBP.RewardedVideoAsync(this.seeAdCallBack);\n        } else {\n            this.BoxController.loadingView.active = true;//[change]\n            this.seeAdCallBack();\n        }\n\n    },\n    seeAdCallBack:function(){\n        this.BoxController.loadingView.active= false;\n        let golds = Global.gold+Global.addgold *  this.type;\n        if(Global.addgold>0 ){\n            this.BoxController.GameMenuController.updateDate({gold:golds});\n            Global.saveGold(golds);\n        }\n        Global.addgold =0;\n        this.node.active = false;\n\n\n    },\n\n});"]}