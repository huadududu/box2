{"version":3,"sources":["../../../../../assets/src/model/assets/src/model/InviteItem.js"],"names":["Global","require","InviteConfig","RewardConfig","cc","Class","extends","Component","properties","coinLabel","Label","numLabel","btn","Node","doneNode","claimNode","index","onLoad","updateItem","inviteCon","num","rewardid","rewardCon","toString","coin","string","active","InviteCount","InviteClaim","inviteOK","contextId","FBP","updateCallBackFriendsAsync","now","Date","LocalStorage","key","getUTCFullYear","getUTCDate","getUTCDay","set","bind","errorCallBack","PopMsgController","GameConfig","showMsg","InviteSameTip","onInvite","chooseAsync","onClaim","Coins","syncPlayerInfoToFB"],"mappings":"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","file":"InviteItem.js","sourceRoot":"../../../../../assets/src/model","sourcesContent":["/**\n * Created by bing on 18/04/2018.\n */\n\n\n\nlet Global = require(\"Global\");\nlet InviteConfig = require(\"InviteConfig\");\nlet RewardConfig = require(\"RewardConfig1\");\n\ncc.Class({\n    extends:cc.Component,\n\n    properties:{\n        coinLabel:cc.Label,\n        numLabel:cc.Label,\n        btn:cc.Node,\n        doneNode:cc.Node,\n        claimNode:cc.Node,\n        index:0,\n    },\n\n    onLoad:function () {\n\n    },\n    \n    updateItem:function(index) {\n\n        let inviteCon = InviteConfig[\"invite\"][index];\n        let num = inviteCon['num'];\n        let rewardid = inviteCon['rewardid'];\n        let rewardCon = RewardConfig[rewardid.toString()];\n        let coin = rewardCon['coin'];\n\n        this.coinLabel.string =  \"+\" + coin.toString();\n        this.claimNode.active = false;\n        if(Global.InviteCount>=num){\n            this.numLabel.string =  num.toString() +\"/\" + num.toString();\n\n            this.btn.active = false;\n            if(Global.InviteClaim[index]){\n                this.claimNode.active = false;\n                this.doneNode.active = true;\n            }else{\n                this.doneNode.active = false;\n                this.claimNode.active = true;\n            }\n\n        }else{\n            this.numLabel.string =  Global.InviteCount.toString() +\"/\" + num.toString();\n            this.btn.active = true;\n            this.doneNode.active = false;\n        }\n    },\n\n    inviteOK:function (contextId) {\n        FBP.updateCallBackFriendsAsync(function () {\n            let now = new Date();\n            let Global = require(\"Global\");\n            let LocalStorage = require(\"LocalStorage\");\n            Global.InviteCount++;\n            let key = \"invaite\" + now.getUTCFullYear().toString() + '-'+now.getUTCDate().toString() +\"-\"+now.getUTCDay();\n            LocalStorage.set(key,Global.InviteCount);\n            this.btn.active = false;\n            this.claimNode.active = true;\n            this.doneNode.active = true;\n        }.bind(this))\n\n    },\n\n    errorCallBack:function(){\n        let PopMsgController = require(\"PopMsgController\");\n        let GameConfig = require(\"GameConfig\");\n        PopMsgController.showMsg(GameConfig.InviteSameTip);\n    },\n\n    onInvite:function () {\n        let FBP = require(\"FBPlugin\");\n        FBP.chooseAsync(this.inviteOK.bind(this),this.errorCallBack.bind(this));\n    },\n    \n    onClaim:function () {\n        this.btn.active = false;\n        this.claimNode.active = false;\n        this.doneNode.active = true;\n\n        let inviteCon = InviteConfig[\"invite\"][index];\n        let rewardid = inviteCon['rewardid'];\n        let rewardCon = RewardConfig[rewardid.toString()];\n        let coin = rewardCon['coin'];\n        Global.Coins+=coin;\n        Global.syncPlayerInfoToFB();\n\n    }\n});"]}