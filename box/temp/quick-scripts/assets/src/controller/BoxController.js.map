{"version":3,"sources":["BoxController.js"],"names":["StageConfig","require","BlockConfig","CycleConfig","ToolConfig","AttributeConfig","AcceleratorConfig","EfficiencyConfig","BoxConfig","RewardConfig","GameType","GameUtils","GameState","BlockBigFactory","BlockSmallFactory","RewardItemFactory","SpriteFrameCenter","ParticleSystemCenter","SkeletonDataCenter","Global","GameHeight","GameCenterY","BaseGame","cc","Class","extends","Component","properties","gameNode","Node","camera","Camera","BlockBig","Prefab","BlockSmall","MarginsBig","MarginsSmall","RewardItem","UIBottom","Sky","Bgbz","Underground","motionStreak","MotionStreak","boxSpine","sp","Skeleton","btnbox","Button","GameMenu","treasure","upgradView","openbox","language","visible","default","type","rowNum","blockWidth","blockBlank","moveNum","margins","curMaxLine","canTouch","previousPt","Hatting","HattingPos","accelerHammer","accelerGold","efficeGold","gameState","init","onLoad","winsize","winSize","BaseHeight","height","BaseWidth","width","hammerStart","hammerEnd","preLoadAtlas","initdata","bind","GameMenuController","find","getComponent","initInfo","blocks","marginlist","hammers","rewardItem","startPos","setCompleteListener","animationName1","trackEntry","animation","name","log","trackIndex","addItems","firstOpen","playBoxSpine","node","active","setAnimation","stopBoxSpine","playHammerSpine","hammerpos","playHammers","i","undefined","setSmPosition","stopHammerSpine","addHammer","id","hammer","addComponent","info","conf","attribute","addSkeletonData","addChild","animationName","checkCanHammer","smCallback","timescale","att","parseFloat","time","timeScale","changeHammerSpine","data","skeletonData","start","initEfficienyInfo","nodehammer","j","conf1","restart","hard","destroy","hatting","floorNum","layer","length","blockwidth","size","count","blank","addBlocks","cameraStartPosY","initTreasure","addUIBottom","resetMarginList","isValid","resetBlockList","lineinfo","addLines","getPngName","cycleID","push","topline","top","pngname","thisNum","factory","curX","curY","lineArray","left","createMargins","position","p","right","endpos","create","thisID","indexOf","cycleArry","split","getnum","randomInt","parseInt","neednumber","destroyBlock","line","row","location","texiao","getEffByBlock","console","addParticleForNode","removeFromParent","destroyUpdate","cameraCentPosY","checkCanDestroy","myinfo","exp","gold","updateDate","saveExp","saveGold","maxLineNum","max","totoalRowNum","maxline","move","oldY","getPositionY","newY","moveY","action1","moveTo","runAction","ralmovelength","action2","x","y","posbottom","totoal","skyposy","bzYbottom","other","setPositionY","realwidth","maxrow","range","geScreenRange","canclick","curline","num","getPngId","cameraPosY","min","maxPosY","canshowy","Math","floor","cameraY","gameY","realx","realy","hamX","hamY","updateTouch","point","touchStartCallBack","end","reset","touchCancelCallBack","location1","convertToNodeSpace","isTouching","touchEndCallBack","touchMoveCallBack","setPositionX","onClickTreasure","event","maxlinenum","touchEndPoint","getLocation","update","eventcallback","string","accleleratorChange","accleleratorrRecover","toolChange","efficiencyAdd","changeHammerSpeed","updateButtom","speedHammer","speedGold","speed","coin","changeGoldSpeed","bool","checkCanAdd","saveHammer","addAdTime","mess","costtype","cost","gem","next","confArry","unlock","openAdTimes","needlvl","level","inviteFriends","boxID","box","rewardID","reward","itemdata","random","z","str","rewardarry","createRewardItem","golds","gems","saveGem","BoxID","BoxConf","normalSprite","getFrameFromAtlas","icon","pressedSprite","hoverSprite","disabledSprite","addSkeletonDataWait","action","callFunc","setFinish","sequence","efficiencyChange","addgold","timestamp","Date","parse","efficiency","jumptime","attr","btnType","skipID","saveEfficiency","nowtime","paseTime","timestart","useTime","timeleft","outlineTime","addeff","onClickBtnaddGem","onClickBtnaddGold","onClickBtnsubGem","onClickBtnsubGold"],"mappings":"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","file":"BoxController.js","sourceRoot":"..\\..\\..\\..\\..\\assets\\src\\controller","sourcesContent":["/**\r\n * Created by bing on 20/04/2018.\r\n */\r\n\r\n//负责head展现和变换。\r\nlet StageConfig = require(\"StageConfig\");\r\nlet BlockConfig = require(\"BoxConfig1\");\r\nlet CycleConfig = require(\"CycleConfig\");\r\nlet ToolConfig = require(\"ToolConfig\");\r\nlet AttributeConfig = require(\"AttributeConfig\");\r\nlet AcceleratorConfig = require(\"AcceleratorConfig\");\r\nlet EfficiencyConfig = require(\"EfficiencyConfig\");\r\nlet BoxConfig = require(\"BoxConfig\");\r\nlet RewardConfig = require(\"RewardConfig\");\r\n\r\n\r\nlet GameType = require(\"GameType\");\r\nlet GameUtils = require(\"GameUtils\");\r\nlet GameState = require(\"GameState\");\r\nlet BlockBigFactory = require(\"BlockBigFactory\");\r\nlet BlockSmallFactory = require(\"BlockSmallFactory\");\r\nlet RewardItemFactory = require(\"RewardItemFactory\");\r\nlet SpriteFrameCenter = require(\"SpriteFrameCenter\");\r\nlet ParticleSystemCenter = require(\"ParticleSystemCenter\");\r\nlet SkeletonDataCenter = require(\"SkeletonDataCenter\");\r\n// let GameMenuController = require('GameMenuController');\r\n\r\nlet Global = require('Global');\r\n\r\nconst GameHeight = 514;\r\nconst GameCenterY = 0;\r\nconst BaseGame = GameHeight/2;\r\n\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        gameNode: cc.Node,\r\n        camera: cc.Camera,\r\n        BlockBig: cc.Prefab,\r\n        BlockSmall: cc.Prefab,\r\n        MarginsBig: cc.Prefab,\r\n        MarginsSmall: cc.Prefab,\r\n        RewardItem: cc.Prefab,\r\n        UIBottom: cc.Prefab,\r\n        Sky: cc.Node,\r\n        Bgbz: cc.Node,\r\n        Underground: cc.Node,\r\n        motionStreak: cc.MotionStreak,\r\n        // hammer: sp.Skeleton,\r\n        boxSpine: sp.Skeleton,\r\n        btnbox: cc.Button,\r\n        GameMenu: cc.Node,\r\n        treasure: cc.Button,\r\n        upgradView: cc.Node,\r\n        openbox: cc.Node,\r\n        // GameMenuController: GameMenuController,\r\n        language: {\r\n            visible: false,\r\n            default: \"English\"\r\n        },\r\n        type: {\r\n            visible: false,\r\n            default: 0\r\n        },\r\n        rowNum: {\r\n            visible: false,\r\n            default: 5\r\n        },\r\n        blockWidth: 100,\r\n        blockBlank: {\r\n            visible: false,\r\n            default: 0\r\n        },\r\n        moveNum: {\r\n            visible: false,\r\n            default: 0\r\n        },\r\n        margins: {\r\n            visible: false,\r\n            default: 0\r\n        },\r\n        curMaxLine: {\r\n            visible: false,\r\n            default: 0\r\n        },\r\n        canTouch: {\r\n            visible: false,\r\n            default: true\r\n        },\r\n        previousPt: {\r\n            visible: false,\r\n            default: null\r\n        },\r\n        Hatting: {\r\n            visible: false,\r\n            default: false\r\n        },\r\n        HattingPos: {\r\n            visible: false,\r\n            default: null\r\n        },\r\n        accelerHammer: {\r\n            visible: false,\r\n            default: 1\r\n        },\r\n        accelerGold: {\r\n            visible: false,\r\n            default: 1\r\n        },\r\n        efficeGold: 0,\r\n        gameState: GameState.init,//0 init 1 playing 2 rolling 3 end\r\n    },\r\n\r\n\r\n    onLoad: function () {\r\n        this.winsize = cc.winSize;\r\n        this.BaseHeight = this.winsize.height / 2;\r\n        this.BaseWidth = this.winsize.width / 2;\r\n        this.hammerStart = 1;//表示锤子的起始id\r\n        this.hammerEnd = 10;//表示锤子的最后一个id\r\n\r\n\r\n\r\n        SpriteFrameCenter.preLoadAtlas(\"png/box\", this.initdata.bind(this));\r\n        this.GameMenuController = cc.find(\"Canvas/GameMenu\").getComponent(\"GameMenuController\");\r\n        Global.initInfo();\r\n        this.blocks = [];\r\n        this.marginlist = [];\r\n        this.hammers = {};\r\n        this.rewardItem = [];\r\n        this.accelerHammer = 1;\r\n        this.accelerGold = 1;\r\n        this.startPos = -GameHeight / 2;\r\n        this.boxSpine.setCompleteListener(trackEntry => {\r\n            var animationName1 = trackEntry.animation ? trackEntry.animation.name : \"\";\r\n            cc.log(\"recordSpine [track %s][animation %s] end.\", trackEntry.trackIndex, animationName1);\r\n            // this.restart();\r\n            this.addItems();\r\n\r\n        });\r\n        this.firstOpen = true;\r\n    },\r\n    playBoxSpine: function () {\r\n        this.boxSpine.node.active = true;\r\n        this.boxSpine.setAnimation(0, \"newAnimation\", false);\r\n    },\r\n    stopBoxSpine: function () {\r\n        this.boxSpine.node.active = false;\r\n    },\r\n    playHammerSpine: function (hammerpos) {\r\n\r\n        this.hammers[hammerpos].node.active = true;\r\n        this.hammers[hammerpos].setAnimation(0, \"newAnimation\", true);\r\n    },\r\n    playHammers: function () {\r\n        for (var i = this.hammerStart; i <= this.hammerEnd; i++) {\r\n            if (this.hammers[i] != undefined) {\r\n                this.setSmPosition(i);\r\n            }\r\n        }\r\n    },\r\n    stopHammerSpine: function (hammerpos) {\r\n        this.hammers[hammerpos].node.active = false;\r\n    },\r\n    addHammer: function (id) {\r\n        let node = new cc.Node();\r\n        let hammer = node.addComponent(sp.Skeleton);\r\n        let info = ToolConfig[id];\r\n        let animation = info.animation;\r\n        let conf = AttributeConfig[info.attribute];\r\n\r\n        SkeletonDataCenter.addSkeletonData(animation, hammer);\r\n        this.GameMenu.addChild(node);\r\n        this.hammers[id] = hammer;\r\n        hammer.node.active = false;\r\n        hammer.setCompleteListener(trackEntry => {\r\n            var animationName = trackEntry.animation ? trackEntry.animation.name : \"\";\r\n            cc.log(\"HammerSpine [track %s][animation %s] end.\", trackEntry.trackIndex, animationName);\r\n            hammer.node.active = false;\r\n            if (this.checkCanHammer(id)) {\r\n                this.smCallback(id);\r\n            }\r\n        });\r\n        let timescale = 0.17 * conf.att / parseFloat(conf.time) * this.accelerHammer;\r\n        hammer.timeScale = timescale;\r\n    },\r\n    changeHammerSpine: function (data) {\r\n        this.hammer.skeletonData = data;\r\n    },\r\n    start: function () {\r\n        this.GameMenuController.initInfo();\r\n        this.hammers = {};\r\n        let timescale = 1;\r\n        let hammer = Global.hammer;\r\n        this.initEfficienyInfo();\r\n        for (var i = this.hammerStart; i <= this.hammerEnd; i++) {\r\n            if (hammer[i] == undefined)\r\n                continue;\r\n            let node = new cc.Node();\r\n            let nodehammer = node.addComponent(sp.Skeleton);\r\n            let info = ToolConfig[i];\r\n            let animation = info.animation;\r\n            SkeletonDataCenter.addSkeletonData(animation, nodehammer);\r\n            this.GameMenu.addChild(node);\r\n            this.hammers[hammer[i].id] = nodehammer;\r\n            nodehammer.node.active = false;\r\n            let j=i;\r\n            nodehammer.setCompleteListener(trackEntry => {\r\n                var animationName = trackEntry.animation ? trackEntry.animation.name : \"\";\r\n                cc.log(\"HammerSpine [track %s][animation %s] end.\", trackEntry.trackIndex, animationName);\r\n                nodehammer.node.active = false;\r\n                if (this.checkCanHammer(j)) {\r\n                    this.smCallback(j);\r\n                }\r\n            });\r\n            let attribute = Global.hammer[i].attribute;\r\n            let conf1 = AttributeConfig[attribute];\r\n            nodehammer.timeScale = 0.17 * conf1.att / parseFloat(conf1.time) * this.accelerHammer;\r\n        }\r\n\r\n    },\r\n    restart: function () {\r\n        if (Global.hard < 10) {\r\n            Global.hard++;\r\n        }\r\n        this.boxSpine.node.active = false;\r\n        for (let i = 1; i < 4; i++) {\r\n            // let node = this.rewardItem[i];\r\n            this.rewardItem[i].destroy();\r\n            // if(cc.isValid( node)){\r\n            //     node.destroy();\r\n            // }\r\n        }\r\n        this.rewardItem = [];\r\n        // this.addItems();\r\n        this.initdata();\r\n        this.gameState = GameState.hatting;\r\n\r\n    },\r\n    initdata: function () {\r\n        let floorNum = StageConfig[Global.hard].layer;\r\n        for (var i = 0; i < BlockConfig.length; i++) {\r\n            if (BlockConfig[i].blockwidth == StageConfig[Global.hard].size) {\r\n                this.type = BlockConfig[i].type;\r\n                break;\r\n            }\r\n        }\r\n        this.rowNum = BlockConfig[this.type].count;\r\n        this.blockWidth = BlockConfig[this.type].blockwidth;\r\n        this.blockBlank = BlockConfig[this.type].blank;\r\n        this.margins = BlockConfig[this.type].margins;\r\n\r\n        this.addBlocks();\r\n        this.cameraStartPosY();\r\n        this.btnbox.node.active = true;\r\n        this.playHammers();\r\n        this.initTreasure();\r\n        if (this.firstOpen) {\r\n            this.GameMenuController.addUIBottom();\r\n            this.firstOpen = false;\r\n        }\r\n\r\n    },\r\n    checkCanHammer: function (id) {\r\n        var hammer = Global.hammer;\r\n        if (hammer[id] != undefined && hammer[id].attribute != -1)\r\n            return true;\r\n        return false;\r\n    },\r\n    resetMarginList: function () {\r\n        if (this.marginlist.length > 0) {\r\n            for (let i = 0; i < this.marginlist.length; i++) {\r\n                let node = this.marginlist[i];\r\n                if (cc.isValid(node)) {\r\n                    node.destroy();\r\n                }\r\n            }\r\n        }\r\n        this.marginlist = [];\r\n    },\r\n    resetBlockList: function () {\r\n        if (this.blocks.length > 0) {\r\n            for (let i = 0; i < this.blocks.length; i++) {\r\n                for (let j = 0; j < this.blocks[i].length; j++) {\r\n                    let node = this.blocks[i][j];\r\n                    if (cc.isValid(node)) {\r\n                        node.destroy();\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        this.blocks = [];\r\n    },\r\n    //--------- block -----------------------\r\n    addBlocks: function () {\r\n\r\n        this.resetBlockList();\r\n        this.resetMarginList();\r\n        let floorNum = StageConfig[Global.hard].layer;\r\n        for (var i = 0; i < floorNum - 1; i++) {\r\n\r\n            var lineinfo = this.addLines(this.getPngName(StageConfig[Global.hard].cycleID, i), i);\r\n\r\n            this.blocks.push(lineinfo);\r\n            lineinfo = [];\r\n        }\r\n        let topline = this.addLines(StageConfig[Global.hard].top, i);\r\n        this.blocks.push(topline);\r\n    },\r\n    addLines: function (pngname, thisNum) {\r\n\r\n        let conf = BlockConfig[this.type];\r\n        let count = conf.count;\r\n        let factory = this.type == 0 ? BlockBigFactory : BlockSmallFactory;\r\n        let curX = conf.margins + conf.blank - this.BaseWidth;\r\n        let curY = thisNum * (this.blockWidth + conf.blank) + this.startPos;\r\n        let lineArray = [];\r\n        let left = factory.createMargins(pngname);\r\n\r\n        left.position = cc.p(conf.margins / 2 - this.BaseWidth, curY + this.blockWidth / 2);\r\n        this.gameNode.addChild(left);\r\n        this.marginlist.push(left);\r\n        let right = factory.createMargins(pngname);\r\n        let endpos = this.BaseWidth - conf.margins / 2;\r\n        right.position = cc.p(endpos, curY + this.blockWidth / 2);\r\n        this.gameNode.addChild(right);\r\n        this.marginlist.push(right);\r\n\r\n        for (var i = 0; i < count; i++) {\r\n            let node = factory.create(pngname);\r\n            node.position = cc.p(curX + this.blockWidth / 2, curY + this.blockWidth / 2);\r\n            curX += this.blockWidth + conf.blank;\r\n            this.gameNode.addChild(node);\r\n            lineArray.push(node);\r\n        }\r\n\r\n        return lineArray;\r\n    },\r\n\r\n    //根据 获得 图片的名字\r\n    getPngName(cycleID, thisNum) {\r\n        let thisID;\r\n        if (cycleID.indexOf(\";\") != -1) {\r\n            let cycleArry = cycleID.split(\";\");\r\n            let getnum = GameUtils.randomInt(0, cycleArry.length - 1);\r\n            thisID = cycleArry[getnum];\r\n        } else {\r\n            thisID = parseInt(cycleID);\r\n        }\r\n        let neednumber = 0;\r\n        for (var i = 1; i <= 10; i++) {\r\n            if (CycleConfig[thisID][\"num\" + i] == 0) {\r\n                i = 0;\r\n                continue;\r\n            }\r\n            neednumber += CycleConfig[thisID][\"num\" + i];\r\n            if (neednumber >= thisNum) {\r\n                return CycleConfig[thisID][\"block\" + i]\r\n            }\r\n            if (i == 10) {\r\n                i = 0;\r\n            }\r\n        }\r\n    },\r\n    //销毁砖块\r\n    destroyBlock: function (line, row) {\r\n\r\n        if (!this.blocks[line])\r\n            return;\r\n        let node = this.blocks[line][row];\r\n\r\n        if (node != null) {\r\n            let location = this.hammerpos(line, row);\r\n            let texiao = this.getEffByBlock(line, row);\r\n             console.log(\"destroylog:\", line, \":\", row, location);\r\n            ParticleSystemCenter.addParticleForNode(texiao + \".plist\", this.GameMenuController.node, location);\r\n            node.removeFromParent(true);\r\n            this.blocks[line][row] = null;\r\n            this.destroyUpdate();\r\n            this.cameraCentPosY();\r\n        }\r\n\r\n    },\r\n    checkCanDestroy: function (line, row) {\r\n        if (!this.blocks[line] || !this.blocks[line][row])\r\n            return false;\r\n        let floorNum = StageConfig[Global.hard].layer;\r\n        if (line >= floorNum - 1)\r\n            return true;\r\n        let node;\r\n        node = this.blocks[line + 1][row];\r\n        if (!cc.isValid(node)) {\r\n            return true;\r\n        }\r\n        if (line > 0) {\r\n            node = this.blocks[line - 1][row];\r\n            if (!cc.isValid(node)) {\r\n                return true;\r\n            }\r\n        }\r\n        if (row > 0 && row < this.rowNum - 1) {\r\n            node = this.blocks[line][row - 1];\r\n            if (!cc.isValid(node)) {\r\n                return true;\r\n            }\r\n            node = this.blocks[line][row + 1];\r\n            if (!cc.isValid(node)) {\r\n                return true;\r\n            }\r\n        } else if (row == 0) {\r\n            node = this.blocks[line][row + 1];\r\n            if (!cc.isValid(node)) {\r\n                return true;\r\n            }\r\n        } else if (row == this.rowNum - 1) {\r\n            node = this.blocks[line][row - 1];\r\n            if (!cc.isValid(node)) {\r\n                return true;\r\n            }\r\n        }\r\n        return false;\r\n    },\r\n    destroyUpdate: function () {\r\n\r\n        let myinfo = {};\r\n        myinfo.exp = Global.exp + 1;\r\n        myinfo.gold = Global.gold + 1 * (this.accelerGold) + this.efficeGold;\r\n        this.GameMenuController.updateDate(myinfo);\r\n        Global.saveExp(myinfo.exp);\r\n        Global.saveGold(myinfo.gold);\r\n    },\r\n    //--------- block -----------------------\r\n    maxLineNum: function () {\r\n        var max = 0;\r\n        let floorNum = StageConfig[Global.hard].layer;\r\n        for (var i = 0; i < floorNum; i++) {\r\n            for (var j = 0; j < this.rowNum; j++) {\r\n                if (this.blocks && this.blocks[i] && this.blocks[i][j]) {\r\n                    var node = this.blocks[i][j];\r\n                    if (!cc.isValid(node))\r\n                        continue;\r\n                    // sss\r\n                    if (i > max) {\r\n                        max = i;\r\n                    }\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n        return max;\r\n    },\r\n\r\n    totoalRowNum: function (line) {//line 行拥有点的数量\r\n        var max = 0;\r\n        for (var j = 0; j < this.rowNum; j++) {\r\n            var node = this.blocks[line][j];\r\n            if (!cc.isValid(node))\r\n                continue;\r\n            max++;\r\n        }\r\n        return max;\r\n    },\r\n\r\n    //************camera 相关设置 start **********************\r\n    cameraCentPosY: function () {\r\n\r\n        let maxline = this.maxLineNum();\r\n        if (this.curMaxLine <= maxline) {\r\n            return;\r\n        }\r\n        let move = this.curMaxLine - maxline;\r\n        this.curMaxLine = maxline;\r\n        let oldY = this.camera.node.getPositionY();\r\n        if (oldY <= 0) {\r\n            return;\r\n        }\r\n        let newY = oldY - this.blockWidth * move;\r\n        let moveY = 0;\r\n        if (newY >= 0) {\r\n            moveY = newY;\r\n        } else {\r\n            moveY = 0;\r\n        }\r\n        let location = cc.p(0, moveY);\r\n        let action1 = cc.moveTo(0.1, location);\r\n        this.camera.node.runAction(action1);\r\n        let ralmovelength = oldY - newY;\r\n        for (var i = this.hammerStart; i < this.hammerEnd; i++) {\r\n            if(this.hammers[i] != undefined){\r\n                let location=this.hammers[i].node.position;\r\n                let action2 = cc.moveTo(0.1,{x:location.x,y:location.y+ralmovelength})\r\n                this.hammers[i].node.runAction(action2);\r\n            }\r\n        }\r\n        // this.camera.node.setPositionY(moveY);\r\n\r\n\r\n    },\r\n\r\n    cameraStartPosY: function () {\r\n        let floorNum = StageConfig[Global.hard].layer;\r\n        let height = floorNum * (this.blockWidth + this.blockBlank);\r\n        //地下\r\n        this.Underground.height = height;\r\n        let posbottom = (height - GameHeight) / 2;\r\n        this.Underground.y = posbottom;\r\n        //地面\r\n        let totoal = this.Bgbz.height + height - 50;\r\n        let skyposy;\r\n        let bzYbottom;\r\n        let other = GameHeight - totoal;\r\n        bzYbottom = (totoal + height - GameHeight) / 2 - 25;\r\n        this.Bgbz.y = bzYbottom;\r\n        if (other > 0) {\r\n            this.Sky.active = true;\r\n            this.Sky.height = other + 10;\r\n            skyposy = (GameHeight - other) / 2;\r\n            this.Sky.y = skyposy;\r\n            this.camera.node.setPositionY(0);\r\n        } else {\r\n            this.Sky.active = false;\r\n            this.camera.node.setPositionY(-other);\r\n\r\n        }\r\n        this.curMaxLine = floorNum - 1;\r\n    },\r\n\r\n\r\n    //************camera 相关设置 end **********************\r\n    //*********** 锤子 相关设置  start***************\r\n    setSmPosition: function (hammerpos) {\r\n        let realwidth = this.blockWidth + this.blockBlank;\r\n        let maxline = this.curMaxLine;\r\n        let maxrow = this.totoalRowNum(0);\r\n        if (maxline == 0 && maxrow == 0) {\r\n            this.HattingPos = null;\r\n            // this.sm.node.visible = false;\r\n            this.hammers[hammerpos].node.active = false;\r\n            return;\r\n        }\r\n        let range = this.geScreenRange();\r\n        let line = this.curMaxLine;\r\n        let find = false;\r\n        let canclick = [];\r\n        let curline = line;\r\n        for (; curline >= 0; curline--) {\r\n            for (var i = 0; i < this.rowNum; i++) {//当前行可以删除的\r\n                if (this.blocks[curline] && this.checkCanDestroy(curline, i)) {\r\n                    let find = false;\r\n                    for (var j = this.hammerStart; j <= this.hammerEnd; j++) {\r\n                        if (this.HattingPos && this.HattingPos[j]) {\r\n                            if (this.HattingPos[j].x == curline && i == this.HattingPos[j].y) {\r\n                                find = true;\r\n                                break;\r\n                            }\r\n                        }\r\n                    }\r\n                    if (!find) {\r\n                        canclick.push(i);\r\n                    }\r\n                }\r\n            }\r\n            if (canclick.length > 0)\r\n                break;\r\n        }\r\n        if (canclick.length == 0) {\r\n            this.HattingPos[hammerpos] = null;\r\n            return;\r\n        }\r\n        let num = GameUtils.randomInt(0, canclick.length - 1);\r\n        let row = canclick[num];\r\n        let location = this.hammerpos(curline, row);\r\n        if (this.HattingPos == null) {\r\n            this.HattingPos = {};\r\n        }\r\n        this.HattingPos[hammerpos] = {x: curline, y: row};\r\n        console.log(\"choose:\",this.HattingPos[hammerpos]);\r\n        this.hammers[hammerpos].node.position = location;\r\n        this.hammers[hammerpos].node.active = true;\r\n        this.playHammerSpine(hammerpos);\r\n    },\r\n    //根据小块的位置 过的特效文件\r\n    getEffByBlock(line, row) {\r\n\r\n        let type = this.type == 0 ? \"BlockBig\" : \"BlockSmall\";\r\n        let node = this.blocks[line][row].getComponent(type);\r\n        return node.getPngId();\r\n    },\r\n    geScreenRange: function () {\r\n        let max = this.curMaxLine;\r\n        let cameraPosY = this.camera.node.getPositionY();\r\n        let min = 0;\r\n        let realwidth = this.blockWidth + this.blockBlank;\r\n        if (cameraPosY <= this.BaseHeight) {\r\n            min = 0;\r\n        } else {\r\n            let maxPosY = max * realwidth;\r\n            let canshowy = (maxPosY - cameraPosY + this.BaseHeight) / realwidth;\r\n            min = Math.floor(max - canshowy);\r\n        }\r\n        return {max: max, min: min};\r\n    },\r\n    //根据块的位置计算锤子的位置\r\n    hammerpos: function (line, row) {\r\n        let cameraY = this.camera.node.getPositionY();\r\n        let gameY = this.gameNode.y;\r\n        let realwidth = this.blockWidth + this.blockBlank;\r\n        let realx = row * realwidth + this.margins + this.blockBlank;\r\n        let realy = line * realwidth - cameraY ;\r\n        let hamX = realx - this.BaseWidth - 42 + this.blockWidth;\r\n        let hamY = realy - 42;\r\n        return cc.p(hamX, hamY);\r\n\r\n    },\r\n    smCallback: function (hammerpos) {\r\n        if (this.HattingPos != null && this.HattingPos[hammerpos] != null) {\r\n\r\n            let y = this.HattingPos[hammerpos].y;\r\n            let x = this.HattingPos[hammerpos].x;\r\n            console.log(\"hammer:\",x,y);\r\n            if (cc.isValid(this.blocks[x][y])) {\r\n                this.destroyBlock(x, y);\r\n            }\r\n\r\n            this.setSmPosition(hammerpos);\r\n\r\n        }\r\n    },\r\n    //*********** 锤子 相关设置  end*****************\r\n\r\n    updateTouch: function (point) {\r\n        let cameraY = this.camera.node.getPositionY();\r\n        let gameY = this.gameNode.y;\r\n        let realwidth = this.blockWidth + this.blockBlank;\r\n        var line = Math.floor((point.y + cameraY) / realwidth);\r\n        var row = Math.floor((point.x - this.margins - this.blockBlank) / realwidth);\r\n        let find = false;\r\n        if (this.checkCanDestroy(line, row)) {\r\n            for (var i = this.hammerStart; i <= this.hammerEnd; i++) {\r\n                if (this.HattingPos != null && this.HattingPos[i] != null && this.HattingPos[i] != undefined) {\r\n                    if (this.HattingPos[i].x == line && this.HattingPos[i].y == row) {\r\n                        this.hammers[i].node.active = false;\r\n                        // this.smCallback(i);\r\n\r\n                        this.destroyBlock(line, row);\r\n                        this.setSmPosition(i);\r\n                        find = true;\r\n                        break;\r\n                    }\r\n                }\r\n            }\r\n            if (!find) {\r\n                this.destroyBlock(line, row);\r\n            }\r\n        }\r\n    },\r\n    touchStartCallBack: function (location) {\r\n        if (!this.canTouch) {\r\n            return;\r\n        }\r\n        if (this.gameState == GameState.end) {\r\n            this.openbox.active = false;\r\n            this.restart();\r\n        }\r\n        if (location.x < this.margins || location.x > (2 * this.BaseWidth - this.margins)) {\r\n            // this.motionStreak.reset();\r\n            return;\r\n        }\r\n        console.log(\"touchStartCallBack\");\r\n        // this.previousPt = location;\r\n        // let motionpos = this.motionStreak.node.convertToNodeSpace(location);\r\n        // this.motionStreak.node.setPositionX(motionpos);\r\n        // this.motionStreak.node.setPositionY(motionpos);\r\n         this.motionStreak.reset();\r\n\r\n        // this.isTouching = false;\r\n    },\r\n\r\n    touchCancelCallBack: function (location1) {\r\n        let location= this.gameNode.convertToNodeSpace(location1);\r\n        this.updateTouch(location);\r\n        this.isTouching = false;\r\n         this.motionStreak.reset();\r\n    },\r\n\r\n    touchEndCallBack: function (location1) {\r\n        // this.touchPosition(location);\r\n        let location= this.gameNode.convertToNodeSpace(location1);\r\n        this.updateTouch(location);\r\n        this.isTouching = false;\r\n        console.log(\"touchEndCallBack\");\r\n        this.motionStreak.reset();\r\n    },\r\n    touchMoveCallBack: function (location1) {\r\n        let location= this.gameNode.convertToNodeSpace(location1);\r\n        if (!this.canTouch) {\r\n            return;\r\n        }\r\n        if (location.x < this.margins || location.x > (2 * this.BaseWidth - this.margins\r\n            || location.y < 216)) {\r\n            this.motionStreak.reset();\r\n            return;\r\n        }\r\n        this.updateTouch(location);\r\n        // this.previousPt = location;\r\n        this.motionStreak.node.setPositionX(location1.x - this.BaseWidth);\r\n        this.motionStreak.node.setPositionY(location1.y - this.BaseHeight);\r\n        // let motionpos = this.node.convertToNodeSpace(location1);\r\n        // this.motionStreak.node.position=motionpos;\r\n    },\r\n\r\n    onClickTreasure: function (event) {\r\n        var maxlinenum = this.maxLineNum();\r\n        var totoalRowNum = this.totoalRowNum(0);\r\n        if (maxlinenum != 0 || totoalRowNum != 0) {\r\n            this.touchEndPoint = event.getLocation();\r\n\r\n            this.updateTouch(this.touchEndPoint);\r\n            return;\r\n        }\r\n        this.btnbox.node.active = false;\r\n        this.gameState = GameState.end;\r\n        this.canTouch = false;\r\n        this.openbox.active= true;\r\n        this.playBoxSpine();\r\n    },\r\n    update: function () {\r\n        // this.cameraCentPosY();\r\n    },\r\n    eventcallback: function (type, id, string = null) {\r\n        // let node= this.itemList.indexOf(sender);\r\n        switch (type) {\r\n            case 0:\r\n                if (string == null)\r\n                    this.accleleratorChange(id);\r\n                else {\r\n                    if (string == 'finish') {\r\n                        this.accleleratorrRecover(id);\r\n                    }\r\n                }\r\n                break;\r\n            case 1:\r\n                this.toolChange(id);\r\n                break;\r\n            case 2:\r\n                this.efficiencyAdd(id);\r\n                break;\r\n        }\r\n    },\r\n    //广告加速开始\r\n    accleleratorChange: function (id) {\r\n        let conf = AcceleratorConfig[id];\r\n        Global['bar' + id] = conf.time;\r\n        this.changeHammerSpeed();\r\n        this.GameMenuController.updateButtom();\r\n\r\n    },\r\n    //广告加速结束\r\n    accleleratorrRecover: function (id) {\r\n        this.changeHammerSpeed();\r\n        this.GameMenuController.updateButtom();\r\n    },\r\n\r\n    changeHammerSpeed: function () {\r\n        let speedHammer = 0;\r\n        let speedGold = 0;\r\n        for (let i = 1; i <= 2; i++) {\r\n            if (Global['bar' + i] > 0) {\r\n                speedHammer += AcceleratorConfig[i].speed;\r\n                speedGold += AcceleratorConfig[i].coin;\r\n            }\r\n        }\r\n        if (speedHammer == 0) {\r\n            speedHammer = 1;\r\n        }\r\n        if (speedGold == 0) {\r\n            speedGold = 1;\r\n        }\r\n        this.accelerHammer = speedHammer;\r\n        this.accelerGold = speedGold;\r\n        for (var i = this.hammerStart; i <= this.hammerEnd; i++) {\r\n            if (this.hammers[i] != undefined) {\r\n                let conf1 = AttributeConfig[Global.hammer[i].attribute];\r\n                this.hammers[i].timeScale = 0.17 * (conf1.att / parseFloat(conf1.time)) * this.accelerHammer;\r\n            }\r\n        }\r\n    },\r\n    changeGoldSpeed: function () {\r\n\r\n    },\r\n    toolChange: function (id) {\r\n        let info = ToolConfig[id];\r\n\r\n        if (Global.hammer[id] == undefined) {\r\n            let bool = this.checkCanAdd(id);\r\n            if (bool) {\r\n                Global.hammer[id] = {id: id, attribute: info.attribute};\r\n                Global.saveHammer(Global.hammer);\r\n                this.addHammer(id);\r\n                this.setSmPosition(id);\r\n            } else {\r\n                this.addAdTime(id);\r\n            }\r\n            this.GameMenuController.updateButtom();\r\n        } else {\r\n\r\n            let conf = AttributeConfig[Global.hammer[id].attribute];\r\n            let mess = {};\r\n\r\n            if (conf.costtype = 1001) {\r\n                Global.gold -= conf.cost;\r\n                mess['gold'] = Global.gold;\r\n            } else if (conf.costtype = 1002) {\r\n                Global.gem -= conf.cost;\r\n                mess['gem'] = Global.gem;\r\n            }\r\n            if (conf.next != -1) {\r\n                Global.hammer[id].attribute = conf.next;\r\n                let conf1 = AttributeConfig[conf.next];\r\n                Global.saveHammer(Global.hammer);\r\n                this.hammers[id].timeScale = 0.17 * (conf1.att / parseFloat(conf1.time)) * this.accelerHammer;\r\n            }\r\n            this.GameMenuController.updateDate(mess);\r\n        }\r\n    },\r\n    checkCanAdd: function (id) {\r\n        let conf = ToolConfig[id];\r\n        let thisID;\r\n        let confArry;\r\n        if (\"unlock\" in conf) {\r\n            if (conf.unlock.indexOf(\";\") != -1) {\r\n                confArry = conf.unlock.split(\";\");\r\n                thisID = confArry[0];\r\n            } else {\r\n                thisID = parseInt(conf.unlock);\r\n            }\r\n            if (thisID == -1) {\r\n                return true;\r\n            }\r\n            if (thisID == 0) {//点击激活\r\n                return true;\r\n            } else if (thisID == 1) {//视频激励\r\n                return Global.openAdTimes > 0;\r\n            } else if (thisID == 2) {//等级激活\r\n                let needlvl = confArry[1];\r\n                if (Global.level < needlvl) {\r\n                    return false;\r\n                } else {\r\n                    return true;\r\n                }\r\n\r\n            } else if (thisID == 3) {//邀请好友\r\n                if (Global.inviteFriends < confArry[1])\r\n                    return false;\r\n                else\r\n                    return true;\r\n            }\r\n        }\r\n        return true;\r\n\r\n    },\r\n    addAdTime: function (id) {\r\n        let conf = ToolConfig[id];\r\n        let thisID;\r\n        let confArry;\r\n        if (\"unlock\" in conf) {\r\n            if (conf.unlock.indexOf(\";\") != -1) {\r\n                confArry = conf.unlock.split(\";\");\r\n                thisID = confArry[0];\r\n            } else {\r\n                thisID = parseInt(conf.unlock);\r\n            }\r\n            if (thisID == 1) {//视频激励\r\n                return Global.openAdTimes++;\r\n            } else if (thisID == 3) {//邀请好友\r\n                Global.inviteFriends++;\r\n            }\r\n        }\r\n    },\r\n    addItems: function () {\r\n\r\n        let hard = Global.hard;\r\n        let boxID = StageConfig[hard].box;\r\n        let rewardID = BoxConfig[boxID].reward;\r\n        let conf = RewardConfig[rewardID];\r\n        let num = conf.num;\r\n        let itemdata = {};\r\n        let totoal = 0;\r\n        let reward = {};\r\n        let max = 0;\r\n        for (let i = 1; i < 7; i++) {\r\n            if (conf['rate' + i] != 0) {\r\n                totoal = conf['rate' + i];\r\n                if (i == 1) {\r\n                    itemdata[i] = totoal;\r\n                    max = itemdata[i];\r\n                } else {\r\n                    itemdata[i] = itemdata[i - 1] + totoal;\r\n                    max = itemdata[i];\r\n                }\r\n            }\r\n        }\r\n        for (let j = 1; j <= num; j++) {\r\n            let random = GameUtils.random(max);\r\n            for (let z = 1; itemdata[z] != undefined; z++) {\r\n                if (itemdata[z] < random) {\r\n                    continue;\r\n                }\r\n                reward[j] = conf['item' + z];\r\n                break;\r\n            }\r\n        }\r\n        let gold = 0;\r\n        let gem = 0;\r\n        let str = \"\";\r\n        for (let i = 1; i <= num; i++) {\r\n            if (reward[i] != undefined) {\r\n                str += reward[i] + \"--\";\r\n                if (reward[i].indexOf(\";\") != -1) {\r\n                    let rewardarry = reward[i].split(\";\");\r\n                    if (rewardarry[0] == 1001) {\r\n                        gold += parseInt(rewardarry[1]);\r\n                    } else if (rewardarry[0] == 1002) {\r\n                        gem += parseInt(rewardarry[1]);\r\n                    }\r\n                }\r\n            }\r\n            this.createRewardItem(reward[i], i);\r\n            this.openbox.active = true;\r\n        }\r\n        if (gold > 0 || gem > 0) {\r\n            let golds = Global.gold + gold;\r\n            let gems = Global.gem + gem;\r\n            this.GameMenuController.updateDate({gold: golds, gem: gems});\r\n            Global.saveGold(golds);\r\n            Global.saveGem(gems);\r\n        }\r\n\r\n    },\r\n    initTreasure: function () {\r\n        let BoxID = StageConfig[Global.hard].box;\r\n        let BoxConf = BoxConfig[BoxID];\r\n        this.treasure.normalSprite = SpriteFrameCenter.getFrameFromAtlas(\"png/box\", BoxConf.icon + \".png\");\r\n        this.treasure.pressedSprite = SpriteFrameCenter.getFrameFromAtlas(\"png/box\", BoxConf.icon + \".png\");\r\n        this.treasure.hoverSprite = SpriteFrameCenter.getFrameFromAtlas(\"png/box\", BoxConf.icon + \".png\");\r\n        this.treasure.disabledSprite = SpriteFrameCenter.getFrameFromAtlas(\"png/box\", BoxConf.icon + \".png\");\r\n        let animation = BoxConf.animation;\r\n        SkeletonDataCenter.addSkeletonDataWait(animation, this.boxSpine);\r\n        this.treasure.node.y = -GameHeight / 2 + this.blockWidth + 35 - 20;\r\n        this.boxSpine.node.y = -GameHeight / 2 + this.blockWidth + 35 - 20;\r\n\r\n    },\r\n    createRewardItem: function (reward, i) {\r\n        if (this.rewardItem[i]) {\r\n            this.rewardItem[i].destroy();\r\n            this.rewardItem[i] = null;\r\n        }\r\n        let start = -400 + i * 200;\r\n\r\n        let node = RewardItemFactory.create(reward);\r\n        let location = this.treasure.node.position;\r\n        this.rewardItem[i] = (node);\r\n        node.position = location;\r\n        let action = cc.moveTo(0.5, cc.p(start, 10));\r\n        let action2 = cc.callFunc(() => {\r\n            node.getComponent(\"RewardItem\").setFinish();\r\n            this.canTouch = true;\r\n        }, this);\r\n        // node.runAction(cc. moveTo(0.5,cc.p(start,-20)));\r\n        this.openbox.addChild(node);\r\n        node.runAction(cc.sequence(action, action2));\r\n    },\r\n    efficiencyAdd: function (id,str = null) {\r\n        if(str != null){\r\n            this.efficiencyChange();\r\n            return;\r\n        }\r\n        let conf = EfficiencyConfig[id];\r\n        let gem = 0;\r\n        let addgold=0;\r\n        if (conf.costtype == 1002 && Global.gem >= conf.cost) {//enough gem\r\n            gem = Global.gem - conf.cost;\r\n            if (conf.coin > 0) {\r\n                // this.efficeGold += conf.coin - 1;\r\n                let timestamp = Date.parse( new Date())/1000;// 以秒为单位\r\n                Global.efficiency[id] = {'id':id,'timeleft':conf.time,'timestart':timestamp};\r\n                this.efficiencyChange();\r\n            }\r\n            let myinfo = {};\r\n            if (conf.jumptime > 0) {//jump time\r\n\r\n                for(let i=this.hammerStart;i<=this.hammerEnd; i++){\r\n                    if(Global.hammer[i] != undefined){\r\n                        let attr = AttributeConfig[Global.hammer[i].attribute];\r\n                        addgold+=conf.jumptime*60*60/attr.time* attr.att;\r\n                    }\r\n                }\r\n                Global.addgold = addgold;\r\n                Global.btnType = 'skip';\r\n                Global.skipID = id;\r\n                this.upgradView.active= true;\r\n            }\r\n        }\r\n        this.GameMenuController.updateDate({'gem': gem});\r\n        Global.saveGem(gem);\r\n        Global.saveEfficiency(Global.efficiency);\r\n        this.GameMenuController.updateButtom();\r\n    },\r\n    //进入游戏计算离线时间 并计算收益\r\n    initEfficienyInfo:function(){\r\n        let nowtime= Date.parse( new Date())/1000;// 以秒为单位;\r\n        let addgold = 0;\r\n        for (let id in Global.efficiency) {\r\n            if ( Global.efficiency[id] == null){\r\n                continue;\r\n            }\r\n            let paseTime = (nowtime - Global.efficiency[id].timestart);\r\n            let conf = EfficiencyConfig[id];\r\n            let useTime = conf.time - Global.efficiency[id].timeleft;\r\n            if(paseTime > conf.time) {\r\n                paseTime = conf.time;\r\n            }\r\n            let outlineTime= paseTime - useTime;\r\n            let timeleft = conf.time - outlineTime - useTime;\r\n            if(timeleft <=0){\r\n                Global.efficiency[id] = null;\r\n            }else{\r\n                Global.efficiency[id].timeleft = timeleft;\r\n                this.efficeGold += conf.coin - 1;\r\n            }\r\n            for(let i=this.hammerStart;i<=this.hammerEnd; i++){\r\n                if(Global.hammer[i] != undefined){\r\n                    let attr = AttributeConfig[Global.hammer[i].attribute];\r\n                    addgold+=conf.coin*outlineTime* attr.att/attr.time;\r\n                }\r\n            }\r\n        }\r\n        if(addgold >0) {\r\n            Global.addgold = addgold;\r\n            Global.btnType = 'outline';\r\n            this.upgradView.active = true;\r\n        }\r\n    },\r\n    //收益加速开始/结束\r\n    efficiencyChange: function () {\r\n        let addeff=0;\r\n\r\n        for( let id in Global.efficiency){\r\n            if(Global.efficiency[id] == null)\r\n                continue;\r\n            let conf = EfficiencyConfig[id];\r\n            addeff+=conf.coin - 1;\r\n        }\r\n        this.efficeGold = addeff;\r\n        this.GameMenuController.updateButtom();\r\n    },\r\n    onClickBtnaddGem() {\r\n\r\n        let gem = Global.gem + 100;\r\n        this.GameMenuController.updateDate({'gem': gem});\r\n        Global.saveGem(gem);\r\n        this.GameMenuController.updateButtom();\r\n    },\r\n    onClickBtnaddGold() {\r\n\r\n        let gold = Global.gold + 10;\r\n        this.GameMenuController.updateDate({'gold': gold});\r\n        Global.saveGold(gold);\r\n        this.GameMenuController.updateButtom();\r\n    },\r\n    onClickBtnsubGem() {\r\n\r\n        let gem = Global.gem - 10 > 0 ? Global.gem - 10 : 0;\r\n        this.GameMenuController.updateDate({'gem': gem});\r\n        Global.saveGem(gem);\r\n        this.GameMenuController.updateButtom();\r\n    },\r\n    onClickBtnsubGold() {\r\n\r\n        let gold = Global.gold - 10 > 0 ? Global.gold - 10 : 0;\r\n        this.GameMenuController.updateDate({'gold': gold});\r\n        Global.saveGold(gold);\r\n        this.GameMenuController.updateButtom();\r\n    }\r\n});\r\n//"]}