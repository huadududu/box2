{"version":3,"sources":["BoxController.js"],"names":["StageConfig","require","BlockConfig","CycleConfig","ToolConfig","AttributeConfig","AcceleratorConfig","EfficiencyConfig","BoxConfig","RewardConfig","GameType","GameUtils","GameState","BlockBigFactory","BlockSmallFactory","RewardItemFactory","UILeadFactory","SpriteFrameCenter","ParticleSystemCenter","SkeletonDataCenter","GameConfig","Global","GameHeight","GameCenterY","BaseGame","cc","Class","extends","Component","properties","gameNode","Node","camera","Camera","BlockBig","Prefab","BlockSmall","MarginsBig","MarginsSmall","RewardItem","UIBottom","uilead","inviteUI","inviteItem","Sky","Bgbz","Underground","motionStreak","MotionStreak","boxSpine","sp","Skeleton","btnbox","Button","GameMenu","treasure","upgradView","openbox","type","visible","default","blockWidth","blockBlank","moveNum","margins","curMaxLine","canTouch","previousPt","Hatting","HattingPos","accelerHammer","accelerGold","efficeGold","startClock","gameState","init","onLoad","winsize","winSize","BaseHeight","height","BaseWidth","width","hammerStart","hammerEnd","boxLeadNode","rowNum","startCameraY","blockLeadNode","blockPosNode","preLoadAtlas","initdata","bind","GameMenuController","find","getComponent","initInfo","blocks","marginlist","hammers","rewardItem","startPos","setCompleteListener","animationName1","trackEntry","animation","name","log","trackIndex","addItems","firstblock","firstOpen","start","timescale","hammer","initEfficienyInfo","i","undefined","node","nodehammer","addComponent","info","addSkeletonData","addChild","id","active","j","animationName","checkCanHammer","smCallback","attribute","conf1","timeScale","att","parseFloat","time","update","restart","hard","saveHard","deleteBoxLead","destroy","hatting","floorNum","layer","length","blockwidth","size","count","blank","addBlocks","cameraStartPosY","changeBlockLead","playHammers","initTreasure","addUIBottom","playHammerSpine","hammerpos","setAnimation","setSmPosition","stopHammerSpine","addHammer","conf","changeHammerSpine","data","skeletonData","startLine","x","startRow","y","position","console","realwidth","maxline","maxrow","totoalRowNum","range","geScreenRange","line","canclick","curline","checkCanDestroy","push","num","randomInt","row","location","getEffByBlock","getPngId","max","cameraPosY","getPositionY","min","maxPosY","canshowy","Math","floor","cameraY","gameY","realx","realy","hamX","hamY","p","isValid","destroyBlock","resetMarginList","resetBlockList","lineinfo","addLines","getPngName","cycleID","topline","top","pngname","thisNum","factory","curX","curY","lineArray","left","createMargins","right","endpos","create","thisID","indexOf","cycleArry","split","getnum","parseInt","neednumber","texiao","addParticleForNode","practice","removeFromParent","destroyUpdate","cameraCentPosY","bool","myinfo","exp","gold","updateDate","saveExp","saveGold","maxLineNum","move","oldY","newY","moveY","action1","moveTo","runAction","ralmovelength","action2","posbottom","totoal","skyposy","bzYbottom","other","movePos","setPositionY","playBoxSpine","stopBoxSpine","BoxID","box","BoxConf","normalSprite","getFrameFromAtlas","icon","pressedSprite","hoverSprite","disabledSprite","addSkeletonDataWait","boxID","rewardID","reward","itemdata","random","z","gem","str","rewardarry","createRewardItem","golds","gems","saveGem","locationX","locationY","action","callFunc","setFinish","sequence","onClickTreasure","event","maxlinenum","touchEndPoint","getLocation","updateTouch","end","addBoxLead","ratation","point","touchStartCallBack","location1","touchState","convertToNodeSpace","setPositionX","reset","touchCancelCallBack","isTouching","touchEndCallBack","touchMoveCallBack","multMoveCallBack","location01","location02","distance","pSub","origin","eventcallback","string","isFBInstantGame","FBP","self","RewardedVideoAsync","accleleratorChange","updateButtom","accleleratorrRecover","toolChange","efficiencyAdd","changeHammerSpeed","speedHammer","speedGold","speed","coin","changeGoldSpeed","checkCanAdd","saveHammer","addAdTime","mess","costtype","cost","next","confArry","unlock","openAdTimes","needlvl","level","inviteFriends","addFriendCallBack","friendId","freindsInfo","FBP1","chooseAsync","friendID","oldFriend","efficiencyChange","addgold","timestamp","Date","parse","efficiency","jumptime","attr","btnType","skipID","saveEfficiency","nowtime","paseTime","timestart","useTime","timeleft","outlineTime","offlinetime","addeff","onClickBtnaddGem","onClickBtnsubGem","onClickBtnaddGold","onClickBtnsubGold","onClickBtnaddExp"],"mappings":"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","file":"BoxController.js","sourceRoot":"..\\..\\..\\..\\..\\assets\\src\\controller","sourcesContent":["/**\r\n * Created by bing on 20/04/2018.\r\n */\r\n\r\n//负责head展现和变换。\r\nlet StageConfig = require(\"StageConfig\");\r\nlet BlockConfig = require(\"BoxConfig1\");\r\nlet CycleConfig = require(\"CycleConfig\");\r\nlet ToolConfig = require(\"ToolConfig\");\r\nlet AttributeConfig = require(\"AttributeConfig\");\r\nlet AcceleratorConfig = require(\"AcceleratorConfig\");\r\nlet EfficiencyConfig = require(\"EfficiencyConfig\");\r\nlet BoxConfig = require(\"BoxConfig\");\r\nlet RewardConfig = require(\"RewardConfig\");\r\n\r\n\r\nlet GameType = require(\"GameType\");\r\nlet GameUtils = require(\"GameUtils\");\r\nlet GameState = require(\"GameState\");\r\nlet BlockBigFactory = require(\"BlockBigFactory\");\r\nlet BlockSmallFactory = require(\"BlockSmallFactory\");\r\nlet RewardItemFactory = require(\"RewardItemFactory\");\r\nlet UILeadFactory = require(\"UILeadFactory\");\r\n\r\nlet SpriteFrameCenter = require(\"SpriteFrameCenter\");\r\nlet ParticleSystemCenter = require(\"ParticleSystemCenter\");\r\nlet SkeletonDataCenter = require(\"SkeletonDataCenter\");\r\nlet GameConfig = require(\"GameConfig\");\r\n// let GameMenuController = require('GameMenuController');\r\n\r\nlet Global = require('Global');\r\n\r\nconst GameHeight = 514;\r\nconst GameCenterY = 0;\r\nconst BaseGame = GameHeight/2;\r\n\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        gameNode: cc.Node,\r\n        camera: cc.Camera,\r\n        BlockBig: cc.Prefab,\r\n        BlockSmall: cc.Prefab,\r\n        MarginsBig: cc.Prefab,\r\n        MarginsSmall: cc.Prefab,\r\n        RewardItem: cc.Prefab,\r\n        UIBottom: cc.Prefab,\r\n        uilead: cc.Prefab,\r\n        inviteUI:cc.Prefab,\r\n        inviteItem:cc.Prefab,\r\n        Sky: cc.Node,\r\n        Bgbz: cc.Node,\r\n        Underground: cc.Node,\r\n        motionStreak: cc.MotionStreak,\r\n        // hammer: sp.Skeleton,\r\n        boxSpine: sp.Skeleton,\r\n        btnbox: cc.Button,\r\n        GameMenu: cc.Node,\r\n        treasure: cc.Button,\r\n        upgradView: cc.Node,\r\n        openbox: cc.Node,\r\n        type: {\r\n            visible: false,\r\n            default: 0\r\n        },\r\n        blockWidth: 100,\r\n        blockBlank: {\r\n            visible: false,\r\n            default: 0\r\n        },\r\n        moveNum: {\r\n            visible: false,\r\n            default: 0\r\n        },\r\n        margins: {\r\n            visible: false,\r\n            default: 0\r\n        },\r\n        curMaxLine: {\r\n            visible: false,\r\n            default: 0\r\n        },\r\n        canTouch: {\r\n            visible: false,\r\n            default: true\r\n        },\r\n        previousPt: {\r\n            visible: false,\r\n            default: null\r\n        },\r\n        Hatting: {\r\n            visible: false,\r\n            default: false\r\n        },\r\n        HattingPos: {\r\n            visible: false,\r\n            default: null\r\n        },\r\n        accelerHammer: {\r\n            visible: false,\r\n            default: 1\r\n        },\r\n        accelerGold: {\r\n            visible: false,\r\n            default: 1\r\n        },\r\n        efficeGold: 0,\r\n        startClock:3,\r\n        gameState: GameState.init,//0 init 1 playing 2 rolling 3 end\r\n    },\r\n\r\n\r\n    onLoad: function () {\r\n        this.winsize = cc.winSize;\r\n        this.BaseHeight = this.winsize.height / 2;\r\n        this.BaseWidth = this.winsize.width / 2;\r\n        this.hammerStart = 1;//表示锤子的起始id\r\n        this.hammerEnd = 10;//表示锤子的最后一个id\r\n        this.boxLeadNode = null;//box的引导节点\r\n        this.rowNum = 0;\r\n        this.startCameraY=0;\r\n        this.blockLeadNode = null;\r\n        this.blockPosNode = null;\r\n\r\n        SpriteFrameCenter.preLoadAtlas(\"png/box\", this.initdata.bind(this));\r\n        this.GameMenuController = cc.find(\"Canvas/GameMenu\").getComponent(\"GameMenuController\");\r\n        Global.initInfo();\r\n        this.blocks = [];\r\n        this.marginlist = [];\r\n        this.hammers = {};\r\n        this.rewardItem = [];\r\n        this.accelerHammer = 1;\r\n        this.accelerGold = 1;\r\n        this.startPos = -GameHeight / 2;\r\n        this.boxSpine.setCompleteListener(trackEntry => {\r\n            var animationName1 = trackEntry.animation ? trackEntry.animation.name : \"\";\r\n            cc.log(\"recordSpine [track %s][animation %s] end.\", trackEntry.trackIndex, animationName1);\r\n            // this.restart();\r\n            this.addItems();\r\n\r\n        });\r\n        this.firstblock= true;\r\n        this.firstOpen = true;\r\n    },\r\n    start: function () {\r\n        this.GameMenuController.initInfo();\r\n        this.hammers = {};\r\n        let timescale = 1;\r\n        let hammer = Global.hammer;\r\n        this.initEfficienyInfo();//[改 延迟执行]\r\n        for (var i = this.hammerStart; i <= this.hammerEnd; i++) {\r\n            if (hammer[i] == undefined)\r\n                continue;\r\n            let node = new cc.Node();\r\n            let nodehammer = node.addComponent(sp.Skeleton);\r\n            let info = ToolConfig[i];\r\n            let animation = info.animation;\r\n            SkeletonDataCenter.addSkeletonData(animation, nodehammer);\r\n            this.GameMenu.addChild(node);\r\n            this.hammers[hammer[i].id] = nodehammer;\r\n            nodehammer.node.active = false;\r\n            let j=i;\r\n            nodehammer.setCompleteListener(trackEntry => {\r\n                var animationName = trackEntry.animation ? trackEntry.animation.name : \"\";\r\n                cc.log(\"HammerSpine [track %s][animation %s] end.\", trackEntry.trackIndex, animationName);\r\n                nodehammer.node.active = false;\r\n                if (this.checkCanHammer(j)) {\r\n                    this.smCallback(j);\r\n                }\r\n            });\r\n            let attribute = Global.hammer[i].attribute;\r\n            let conf1 = AttributeConfig[attribute];\r\n            nodehammer.timeScale = 0.17 * conf1.att / parseFloat(conf1.time) * this.accelerHammer;\r\n        }\r\n\r\n    },\r\n    update: function () {\r\n        // this.cameraCentPosY();\r\n    },\r\n    restart: function () {\r\n\r\n        if (StageConfig[Global.hard+1] != null && StageConfig[Global.hard+1] != undefined) {\r\n            Global.hard++;\r\n            Global.saveHard(Global.hard);\r\n        }\r\n        this.deleteBoxLead();\r\n        this.boxSpine.node.active = false;\r\n        for (let i = 1; i < 4; i++) {\r\n            // let node = this.rewardItem[i];\r\n            this.rewardItem[i].destroy();\r\n            // if(cc.isValid( node)){\r\n            //     node.destroy();\r\n            // }\r\n        }\r\n        this.rewardItem = [];\r\n        // this.addItems();\r\n        this.initdata();\r\n        this.gameState = GameState.hatting;\r\n    },\r\n    initdata: function () {\r\n        let floorNum = StageConfig[Global.hard].layer;\r\n        for (var i = 0; i < BlockConfig.length; i++) {\r\n            if (BlockConfig[i].blockwidth == StageConfig[Global.hard].size) {\r\n                this.type = BlockConfig[i].type;\r\n                break;\r\n            }\r\n        }\r\n\r\n        this.rowNum = BlockConfig[this.type].count;\r\n        this.blockWidth = BlockConfig[this.type].blockwidth;\r\n        this.blockBlank = BlockConfig[this.type].blank;\r\n        this.margins = BlockConfig[this.type].margins;\r\n\r\n        this.addBlocks();\r\n        this.cameraStartPosY();\r\n        this.changeBlockLead();\r\n        this.btnbox.node.active = true;\r\n        this.playHammers();\r\n        this.initTreasure();\r\n        if (this.firstOpen) {\r\n            this.GameMenuController.addUIBottom();\r\n            this.firstOpen = false;\r\n        }\r\n\r\n\r\n    },\r\n    //-----------------------------锤子部分 start-------------------------\r\n    playHammerSpine: function (hammerpos) {\r\n\r\n        this.hammers[hammerpos].node.active = true;\r\n        this.hammers[hammerpos].setAnimation(0, \"newAnimation\", true);\r\n    },\r\n    playHammers: function () {\r\n        for (var i = this.hammerStart; i <= this.hammerEnd; i++) {\r\n            if (this.hammers[i] != undefined) {\r\n                this.setSmPosition(i);\r\n            }\r\n        }\r\n    },\r\n    stopHammerSpine: function (hammerpos) {\r\n        this.hammers[hammerpos].node.active = false;\r\n    },\r\n    addHammer: function (id) {\r\n        let node = new cc.Node();\r\n        let hammer = node.addComponent(sp.Skeleton);\r\n        let info = ToolConfig[id];\r\n        let animation = info.animation;\r\n        let conf = AttributeConfig[info.attribute];\r\n\r\n        SkeletonDataCenter.addSkeletonData(animation, hammer);\r\n        this.GameMenu.addChild(node);\r\n        this.hammers[id] = hammer;\r\n        hammer.node.active = false;\r\n        hammer.setCompleteListener(trackEntry => {\r\n            var animationName = trackEntry.animation ? trackEntry.animation.name : \"\";\r\n            cc.log(\"HammerSpine [track %s][animation %s] end.\", trackEntry.trackIndex, animationName);\r\n            hammer.node.active = false;\r\n            if (this.checkCanHammer(id)) {\r\n                    this.smCallback(id);\r\n            }\r\n        });\r\n        let timescale = 0.17 * conf.att / parseFloat(conf.time) * this.accelerHammer;\r\n        hammer.timeScale = timescale;\r\n    },\r\n    changeHammerSpine: function (data) {\r\n        this.hammer.skeletonData = data;\r\n    },\r\n\r\n\r\n    checkCanHammer: function (id) {\r\n        var hammer = Global.hammer;\r\n        if (hammer[id] != undefined && hammer[id].attribute != -1)\r\n            return true;\r\n        return false;\r\n    },\r\n    setSmPosition: function (hammerpos) {\r\n        if(this.blockPosNode !=null){\r\n            if (this.HattingPos == null) {\r\n                this.HattingPos = {};\r\n            }\r\n            let startLine = this.blockPosNode.x;\r\n            let startRow = this.blockPosNode.y;\r\n            this.HattingPos[hammerpos] = this.blockPosNode;\r\n            let position = this.hammerpos(startLine,startRow);\r\n            console.log(\"choose:\",this.HattingPos[hammerpos]);\r\n            this.hammers[hammerpos].node.position = position;\r\n            this.hammers[hammerpos].node.active = true;\r\n            this.playHammerSpine(hammerpos);\r\n            this.blockPosNode = null;\r\n            return;\r\n        }\r\n        let realwidth = this.blockWidth + this.blockBlank;\r\n        let maxline = this.curMaxLine;\r\n        let maxrow = this.totoalRowNum(0);\r\n        if (maxline == 0 && maxrow == 0) {\r\n            this.HattingPos = null;\r\n            // this.sm.node.visible = false;\r\n            this.hammers[hammerpos].node.active = false;\r\n            return;\r\n        }\r\n\r\n        let range = this.geScreenRange();\r\n        let line = this.curMaxLine;\r\n        let find = false;\r\n        let canclick = [];\r\n        let curline = line;\r\n        for (; curline >= 0; curline--) {\r\n            for (var i = 0; i < this.rowNum; i++) {//当前行可以删除的\r\n                if (this.blocks[curline] && this.checkCanDestroy(curline, i)) {\r\n                    let find = false;\r\n                    for (var j = this.hammerStart; j <= this.hammerEnd; j++) {\r\n                        if (this.HattingPos && this.HattingPos[j]) {\r\n                            if (this.HattingPos[j].x == curline && i == this.HattingPos[j].y) {\r\n                                find = true;\r\n                                break;\r\n                            }\r\n                        }\r\n                    }\r\n                    if (!find) {\r\n                        canclick.push(i);\r\n                    }\r\n                }\r\n            }\r\n            if (canclick.length > 0)\r\n                break;\r\n        }\r\n        if (canclick.length == 0) {\r\n            this.HattingPos[hammerpos] = null;\r\n            return;\r\n        }\r\n        let num = GameUtils.randomInt(0, canclick.length - 1);\r\n        let row = canclick[num];\r\n        let location = this.hammerpos(curline, row);\r\n        if (this.HattingPos == null) {\r\n            this.HattingPos = {};\r\n        }\r\n        this.HattingPos[hammerpos] = {x: curline, y: row};\r\n        console.log(\"choose:\",this.HattingPos[hammerpos]);\r\n        this.hammers[hammerpos].node.position = location;\r\n        this.hammers[hammerpos].node.active = true;\r\n        this.playHammerSpine(hammerpos);\r\n    },\r\n    //根据小块的位置 过的特效文件\r\n    getEffByBlock(line, row) {\r\n\r\n        let type = this.type == 0 ? \"BlockBig\" : \"BlockSmall\";\r\n        let node = this.blocks[line][row].getComponent(type);\r\n        return node.getPngId();\r\n    },\r\n    geScreenRange: function () {\r\n        let max = this.curMaxLine;\r\n        let cameraPosY = this.camera.node.getPositionY();\r\n        let min = 0;\r\n        let realwidth = this.blockWidth + this.blockBlank;\r\n        if (cameraPosY <= this.BaseHeight) {\r\n            min = 0;\r\n        } else {\r\n            let maxPosY = max * realwidth;\r\n            let canshowy = (maxPosY - cameraPosY + this.BaseHeight) / realwidth;\r\n            min = Math.floor(max - canshowy);\r\n        }\r\n        return {max: max, min: min};\r\n    },\r\n    //根据块的位置计算锤子的位置\r\n    hammerpos: function (line, row) {\r\n        let cameraY = this.camera.node.getPositionY();\r\n        let gameY = this.gameNode.y;\r\n        let realwidth = this.blockWidth + this.blockBlank;\r\n        let realx = row * realwidth + this.margins + this.blockBlank;\r\n        let realy = line * realwidth - cameraY ;\r\n        let hamX = realx - this.BaseWidth - 42 + this.blockWidth;\r\n        let hamY = realy - 42;\r\n        return cc.p(hamX, hamY);\r\n\r\n    },\r\n    smCallback: function (hammerpos) {\r\n        if (this.HattingPos != null && this.HattingPos[hammerpos] != null) {\r\n\r\n            let y = this.HattingPos[hammerpos].y;\r\n            let x = this.HattingPos[hammerpos].x;\r\n            console.log(\"hammer:\",x,y);\r\n            if (cc.isValid(this.blocks[x][y])) {\r\n                this.destroyBlock(x, y);\r\n            }\r\n            // this.changeBlockLead(true);\r\n            this.setSmPosition(hammerpos);\r\n\r\n\r\n        }\r\n    },\r\n    //-----------------------------锤子部分 end-------------------------\r\n    //-----------------------------block start-------------------------\r\n    resetMarginList: function () {\r\n        if (this.marginlist.length > 0) {\r\n            for (let i = 0; i < this.marginlist.length; i++) {\r\n                let node = this.marginlist[i];\r\n                if (cc.isValid(node)) {\r\n                    node.destroy();\r\n                }\r\n            }\r\n        }\r\n        this.marginlist = [];\r\n    },\r\n    resetBlockList: function () {\r\n        if (this.blocks.length > 0) {\r\n            for (let i = 0; i < this.blocks.length; i++) {\r\n                for (let j = 0; j < this.blocks[i].length; j++) {\r\n                    let node = this.blocks[i][j];\r\n                    if (cc.isValid(node)) {\r\n                        node.destroy();\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        this.blocks = [];\r\n    },\r\n    addBlocks: function () {\r\n\r\n        this.resetBlockList();\r\n        this.resetMarginList();\r\n        let floorNum = StageConfig[Global.hard].layer;\r\n        for (var i = 0; i < floorNum - 1; i++) {\r\n\r\n            var lineinfo = this.addLines(this.getPngName(StageConfig[Global.hard].cycleID, i), i);\r\n\r\n            this.blocks.push(lineinfo);\r\n            lineinfo = [];\r\n        }\r\n        let topline = this.addLines(StageConfig[Global.hard].top, i);\r\n        this.blocks.push(topline);\r\n    },\r\n    addLines: function (pngname, thisNum) {\r\n\r\n        let conf = BlockConfig[this.type];\r\n        let count = conf.count;\r\n        let factory = this.type == 0 ? BlockBigFactory : BlockSmallFactory;\r\n        let curX = conf.margins + conf.blank - this.BaseWidth;\r\n        let curY = thisNum * (this.blockWidth + conf.blank) + this.startPos;\r\n        let lineArray = [];\r\n        let left = factory.createMargins(pngname);\r\n\r\n        left.position = cc.p(conf.margins / 2 - this.BaseWidth, curY + this.blockWidth / 2);\r\n        this.gameNode.addChild(left);\r\n        this.marginlist.push(left);\r\n        let right = factory.createMargins(pngname);\r\n        let endpos = this.BaseWidth - conf.margins / 2;\r\n        right.position = cc.p(endpos, curY + this.blockWidth / 2);\r\n        this.gameNode.addChild(right);\r\n        this.marginlist.push(right);\r\n\r\n        for (var i = 0; i < count; i++) {\r\n            let node = factory.create(pngname);\r\n            node.position = cc.p(curX + this.blockWidth / 2, curY + this.blockWidth / 2);\r\n            curX += this.blockWidth + conf.blank;\r\n            this.gameNode.addChild(node);\r\n            lineArray.push(node);\r\n        }\r\n\r\n        return lineArray;\r\n    },\r\n\r\n    //根据 获得 图片的名字\r\n    getPngName(cycleID, thisNum) {\r\n        let thisID;\r\n        if (cycleID.indexOf(\";\") != -1) {\r\n            let cycleArry = cycleID.split(\";\");\r\n            let getnum = GameUtils.randomInt(0, cycleArry.length - 1);\r\n            thisID = cycleArry[getnum];\r\n        } else {\r\n            thisID = parseInt(cycleID);\r\n        }\r\n        let neednumber = 0;\r\n        for (var i = 1; i <= 10; i++) {\r\n            if (CycleConfig[thisID][\"num\" + i] == 0) {\r\n                i = 0;\r\n                continue;\r\n            }\r\n            neednumber += CycleConfig[thisID][\"num\" + i];\r\n            if (neednumber >= thisNum) {\r\n                return CycleConfig[thisID][\"block\" + i]\r\n            }\r\n            if (i == 10) {\r\n                i = 0;\r\n            }\r\n        }\r\n    },\r\n    //销毁砖块\r\n    destroyBlock: function (line, row) {\r\n\r\n        if (!this.blocks[line])\r\n            return;\r\n        let node = this.blocks[line][row];\r\n\r\n        if (node != null) {\r\n            let location = this.hammerpos(line, row);\r\n            let texiao = this.getEffByBlock(line, row);\r\n             console.log(\"destroylog:\", line, \":\", row, location);\r\n            ParticleSystemCenter.addParticleForNode(texiao + \".plist\", this.GameMenuController.practice, location);\r\n            node.removeFromParent(true);\r\n            this.blocks[line][row] = null;\r\n            this.destroyUpdate();\r\n            this.cameraCentPosY();\r\n        }\r\n        this.firstblock = false;\r\n        this.startClock--;\r\n        this.changeBlockLead();\r\n\r\n\r\n    },\r\n    changeBlockLead:function(){\r\n        let bool = this.startClock>0;\r\n        // if(this.startClock>0){\r\n        //     if(this.HattingPos && this.HattingPos[1]){\r\n        //         this.blockLead(bool,this.HattingPos[1].x,this.HattingPos[1].y);\r\n        //     }else{\r\n        //         this.blockLead(bool,2,2+this.startClock);\r\n        //     }\r\n        // }else{\r\n        //     this.blockLead(bool);\r\n        // }\r\n\r\n\r\n        if(Global.hard == 1 && bool){\r\n            if(!this.blockLeadNode){\r\n                var node = UILeadFactory.create();\r\n                this.blockLeadNode= node;\r\n                this.gameNode.addChild(node);\r\n            }\r\n            let row =3+this.startClock;\r\n            let line = 2;\r\n\r\n            let position = this.hammerpos(line,row);\r\n            position.y = position.y-216;\r\n            this.blockLeadNode.position = position;\r\n            this.blockPosNode = {x: line,y:row};\r\n        }else {\r\n            if (this.blockLeadNode) {\r\n                this.blockLeadNode.removeFromParent(true);\r\n                this.blockLeadNode = null;\r\n                this.blockPosNode = null;\r\n            }\r\n\r\n        }\r\n\r\n    },\r\n    checkCanDestroy: function (line, row) {\r\n        if (!this.blocks[line] || !this.blocks[line][row])\r\n            return false;\r\n        let floorNum = StageConfig[Global.hard].layer;\r\n        if (line >= floorNum - 1)\r\n            return true;\r\n        let node;\r\n        node = this.blocks[line + 1][row];\r\n        if (!cc.isValid(node)) {\r\n            return true;\r\n        }\r\n        if (line > 0) {\r\n            node = this.blocks[line - 1][row];\r\n            if (!cc.isValid(node)) {\r\n                return true;\r\n            }\r\n        }\r\n        if (row > 0 && row < this.rowNum - 1) {\r\n            node = this.blocks[line][row - 1];\r\n            if (!cc.isValid(node)) {\r\n                return true;\r\n            }\r\n            node = this.blocks[line][row + 1];\r\n            if (!cc.isValid(node)) {\r\n                return true;\r\n            }\r\n        } else if (row == 0) {\r\n            node = this.blocks[line][row + 1];\r\n            if (!cc.isValid(node)) {\r\n                return true;\r\n            }\r\n        } else if (row == this.rowNum - 1) {\r\n            node = this.blocks[line][row - 1];\r\n            if (!cc.isValid(node)) {\r\n                return true;\r\n            }\r\n        }\r\n        return false;\r\n    },\r\n    destroyUpdate: function () {\r\n\r\n        let myinfo = {};\r\n        myinfo.exp = Global.exp + 1;\r\n        myinfo.gold = Global.gold + 1 * (this.accelerGold) + this.efficeGold;\r\n        this.GameMenuController.updateDate(myinfo);\r\n        Global.saveExp(myinfo.exp);\r\n        Global.saveGold(myinfo.gold);\r\n\r\n    },\r\n    maxLineNum: function () {\r\n        var max = 0;\r\n        let floorNum = StageConfig[Global.hard].layer;\r\n        for (var i = 0; i < floorNum; i++) {\r\n            for (var j = 0; j < this.rowNum; j++) {\r\n                if (this.blocks && this.blocks[i] && this.blocks[i][j]) {\r\n                    var node = this.blocks[i][j];\r\n                    if (!cc.isValid(node))\r\n                        continue;\r\n                    if (i > max) {\r\n                        max = i;\r\n                    }\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n        return max;\r\n    },\r\n\r\n    totoalRowNum: function (line) {//line 行拥有点的数量\r\n        var max = 0;\r\n        for (var j = 0; j < this.rowNum; j++) {\r\n            var node = this.blocks[line][j];\r\n            if (!cc.isValid(node))\r\n                continue;\r\n            max++;\r\n        }\r\n        return max;\r\n    },\r\n    //-----------------------------block   end-------------------------\r\n    //-----------------------------camera   start-------------------------\r\n\r\n    cameraCentPosY: function () {\r\n\r\n        let maxline = this.maxLineNum();\r\n        if (this.curMaxLine <= maxline) {\r\n            return;\r\n        }\r\n        let move = this.curMaxLine - maxline;\r\n        this.curMaxLine = maxline;\r\n        let oldY = this.camera.node.getPositionY();\r\n        if (oldY <= 0) {\r\n            return;\r\n        }\r\n        let newY = oldY - this.blockWidth * move;\r\n        let moveY = 0;\r\n        if (newY >= 0) {\r\n            moveY = newY;\r\n        } else {\r\n            moveY = 0;\r\n        }\r\n        let location = cc.p(0, moveY);\r\n        let action1 = cc.moveTo(0.1, location);\r\n        this.camera.node.runAction(action1);\r\n        let ralmovelength = oldY - newY;\r\n        for (var i = this.hammerStart; i < this.hammerEnd; i++) {\r\n            if(this.hammers[i] != undefined){\r\n                let location=this.hammers[i].node.position;\r\n                let action2 = cc.moveTo(0.1,{x:location.x,y:location.y+ralmovelength})\r\n                this.hammers[i].node.runAction(action2);\r\n            }\r\n        }\r\n    },\r\n\r\n    cameraStartPosY: function () {\r\n        let floorNum = StageConfig[Global.hard].layer;\r\n        let height = floorNum * (this.blockWidth + this.blockBlank);\r\n        //地下\r\n        this.Underground.height = height;\r\n        let posbottom = (height - GameHeight) / 2;\r\n        this.Underground.y = posbottom;\r\n        //地面\r\n        let totoal = this.Bgbz.height + height - 50;\r\n        let skyposy;\r\n        let bzYbottom;\r\n        let other = GameHeight - totoal;\r\n        bzYbottom = (totoal + height - GameHeight) / 2 - 25;\r\n        this.Bgbz.y = bzYbottom;\r\n        let movePos = 0;\r\n        if (other > 0) {\r\n            this.Sky.active = true;\r\n            this.Sky.height = other + 10;\r\n            skyposy = (GameHeight - other) / 2;\r\n            this.Sky.y = skyposy;\r\n            // this.camera.node.setPositionY(0);\r\n            movePos = 0;\r\n        } else {\r\n            this.Sky.active = false;\r\n            // this.camera.node.setPositionY(-other);\r\n            movePos = -other;\r\n        }\r\n        this.camera.node.setPositionY(movePos);\r\n        this.startCameraY = movePos;\r\n        this.curMaxLine = floorNum - 1;\r\n    },\r\n    //-----------------------------camera   end-------------------------\r\n    //----------------------------- treasure start----------------------\r\n    playBoxSpine: function () {\r\n        this.boxSpine.node.active = true;\r\n        this.boxSpine.setAnimation(0, \"newAnimation\", false);\r\n    },\r\n    stopBoxSpine: function () {\r\n        this.boxSpine.node.active = false;\r\n    },\r\n    initTreasure: function () {\r\n        let BoxID = StageConfig[Global.hard].box;\r\n        let BoxConf = BoxConfig[BoxID];\r\n        this.treasure.normalSprite = SpriteFrameCenter.getFrameFromAtlas(\"png/box\", BoxConf.icon + \".png\");\r\n        this.treasure.pressedSprite = SpriteFrameCenter.getFrameFromAtlas(\"png/box\", BoxConf.icon + \".png\");\r\n        this.treasure.hoverSprite = SpriteFrameCenter.getFrameFromAtlas(\"png/box\", BoxConf.icon + \".png\");\r\n        this.treasure.disabledSprite = SpriteFrameCenter.getFrameFromAtlas(\"png/box\", BoxConf.icon + \".png\");\r\n        let animation = BoxConf.animation;\r\n        SkeletonDataCenter.addSkeletonDataWait(animation, this.boxSpine);\r\n        this.treasure.node.y = -GameHeight / 2 + this.blockWidth + 35 - 20;\r\n        this.boxSpine.node.y = -GameHeight / 2 + this.blockWidth + 35 - 20+103;\r\n        // let loction  = this.gameNode.convertToWorldSpace(this.treasure.node.position);\r\n        // let loction1 = this.openbox.convertToNodeSpace(loction);\r\n        // this.boxSpine.node = loction1;\r\n\r\n    },\r\n    addItems: function () {\r\n\r\n        let hard = Global.hard;\r\n        let boxID = StageConfig[hard].box;\r\n        let rewardID = BoxConfig[boxID].reward;\r\n        let conf = RewardConfig[rewardID];\r\n        let num = conf.num;\r\n        let itemdata = {};\r\n        let totoal = 0;\r\n        let reward = {};\r\n        let max = 0;\r\n        for (let i = 1; i < 7; i++) {\r\n            if (conf['rate' + i] != 0) {\r\n                totoal = conf['rate' + i];\r\n                if (i == 1) {\r\n                    itemdata[i] = totoal;\r\n                    max = itemdata[i];\r\n                } else {\r\n                    itemdata[i] = itemdata[i - 1] + totoal;\r\n                    max = itemdata[i];\r\n                }\r\n            }\r\n        }\r\n        for (let j = 1; j <= num; j++) {\r\n            let random = GameUtils.random(max);\r\n            for (let z = 1; itemdata[z] != undefined; z++) {\r\n                if (itemdata[z] < random) {\r\n                    continue;\r\n                }\r\n                reward[j] = conf['item' + z];\r\n                break;\r\n            }\r\n        }\r\n        let gold = 0;\r\n        let gem = 0;\r\n        let str = \"\";\r\n        for (let i = 1; i <= num; i++) {\r\n            if (reward[i] != undefined) {\r\n                str += reward[i] + \"--\";\r\n                if (reward[i].indexOf(\";\") != -1) {\r\n                    let rewardarry = reward[i].split(\";\");\r\n                    if (rewardarry[0] == 1001) {\r\n                        gold += parseInt(rewardarry[1]);\r\n                    } else if (rewardarry[0] == 1002) {\r\n                        gem += parseInt(rewardarry[1]);\r\n                    }\r\n                }\r\n            }\r\n            this.createRewardItem(reward[i], i);\r\n            this.openbox.active = true;\r\n        }\r\n        if (gold > 0 || gem > 0) {\r\n            let golds = Global.gold + gold;\r\n            let gems = Global.gem + gem;\r\n            this.GameMenuController.updateDate({gold: golds, gem: gems});\r\n            Global.saveGold(golds);\r\n            Global.saveGem(gems);\r\n        }\r\n\r\n    },\r\n    createRewardItem: function (reward, i) {\r\n        if (this.rewardItem[i]) {\r\n            this.rewardItem[i].destroy();\r\n            this.rewardItem[i] = null;\r\n        }\r\n        let start = -400 + i * 200;\r\n\r\n        let node = RewardItemFactory.create(reward);\r\n        let locationX = this.treasure.node.position.x;\r\n        let locationY = this.treasure.node.position.y+103;\r\n\r\n        this.rewardItem[i] = (node);\r\n        node.position = cc.p(locationX,locationY);\r\n        let action = cc.moveTo(0.5, cc.p(start, 100));\r\n        let action2 = cc.callFunc(() => {\r\n            node.getComponent(\"RewardItem\").setFinish();\r\n            this.canTouch = true;\r\n        }, this);\r\n        // node.runAction(cc. moveTo(0.5,cc.p(start,-20)));\r\n        this.openbox.addChild(node);\r\n        node.runAction(cc.sequence(action, action2));\r\n    },\r\n    onClickTreasure: function (event) {\r\n        var maxlinenum = this.maxLineNum();\r\n        var totoalRowNum = this.totoalRowNum(0);\r\n        if (maxlinenum != 0 || totoalRowNum != 0) {\r\n            this.touchEndPoint = event.getLocation();\r\n\r\n            this.updateTouch(this.touchEndPoint);\r\n            return;\r\n        }\r\n        this.btnbox.node.active = false;\r\n        this.gameState = GameState.end;\r\n        this.canTouch = false;\r\n        this.openbox.active= true;\r\n        this.playBoxSpine();\r\n    },\r\n    addBoxLead:function(){\r\n        if(Global.hard > 1)\r\n            return;\r\n        var maxlinenum = this.maxLineNum();\r\n        var totoalRowNum = this.totoalRowNum(0);\r\n        if (maxlinenum == 0 && totoalRowNum == 0) {\r\n            let node = UILeadFactory.create();\r\n            node.position= this.treasure.node.position;\r\n            node.ratation = 180;\r\n            this.boxLeadNode = node;\r\n            this.gameNode.addChild(node);\r\n        }\r\n    },\r\n    deleteBoxLead:function(){\r\n        if(this.boxLeadNode){\r\n            this.boxLeadNode.removeFromParent(true);\r\n            this.boxLeadNode= null;\r\n        }\r\n    },\r\n    //-----------------------------treasure end--------------------------\r\n    //-----------------------------touch   start-------------------------\r\n    updateTouch: function (point) {\r\n        let cameraY = this.camera.node.getPositionY();\r\n        let gameY = this.gameNode.y;\r\n        let realwidth = this.blockWidth + this.blockBlank;\r\n        var line = Math.floor((point.y + cameraY) / realwidth);\r\n        var row = Math.floor((point.x - this.margins - this.blockBlank) / realwidth);\r\n        let find = false;\r\n        if (this.checkCanDestroy(line, row)) {\r\n            for (var i = this.hammerStart; i <= this.hammerEnd; i++) {\r\n                if (this.HattingPos != null && this.HattingPos[i] != null && this.HattingPos[i] != undefined) {\r\n                    if (this.HattingPos[i].x == line && this.HattingPos[i].y == row) {\r\n                        this.hammers[i].node.active = false;\r\n                        // this.smCallback(i);\r\n\r\n                        this.destroyBlock(line, row);\r\n                        this.setSmPosition(i);\r\n                        find = true;\r\n                        break;\r\n                    }\r\n                }\r\n            }\r\n            if (!find) {\r\n                this.destroyBlock(line, row);\r\n            }\r\n        }\r\n        // this.changeBlockLead(true);\r\n    },\r\n    touchStartCallBack: function (location1) {\r\n\r\n        if (!this.canTouch) {\r\n            return;\r\n        }\r\n\r\n        console.log(\"touchStartCallBack\");\r\n\r\n        if (this.gameState == GameState.end) {\r\n            this.openbox.active = false;\r\n            this.restart();\r\n        }\r\n\r\n        if(this.touchState == undefined ||( this.touchState != 'start'  && this.touchState != 'move')){\r\n            this.touchState = 'start';\r\n        }else{\r\n            this.touchState = 'mult';\r\n        }\r\n        if(this.touchState == 'mult'){\r\n            console.log(\"藏起来\");\r\n            this.motionStreak.node.active = false;\r\n        }\r\n        let location= this.gameNode.convertToNodeSpace(location1);\r\n        this.motionStreak.node.setPositionX(location1.x - this.BaseWidth);\r\n        this.motionStreak.node.setPositionY(location1.y - this.BaseHeight);\r\n        this.motionStreak.reset();\r\n\r\n    },\r\n\r\n    touchCancelCallBack: function (location1) {\r\n        let location= this.gameNode.convertToNodeSpace(location1);\r\n        this.updateTouch(location);\r\n        this.isTouching = false;\r\n        this.motionStreak.reset();\r\n        this.motionStreak.node.active = true;\r\n    },\r\n\r\n    touchEndCallBack: function (location1) {\r\n        let location= this.gameNode.convertToNodeSpace(location1);\r\n        this.updateTouch(location);\r\n        this.isTouching = false;\r\n        console.log(\"touchEndCallBack\");\r\n        this.motionStreak.reset();\r\n        this.previousPt=null;\r\n        this.motionStreak.node.active = true;\r\n    },\r\n    touchMoveCallBack: function (location1) {\r\n        let location= this.gameNode.convertToNodeSpace(location1);\r\n        if (!this.canTouch) {\r\n            return;\r\n        }\r\n        this.touchState =\"move\";\r\n        console.log(\"touchMoveCallBack\");\r\n        this.motionStreak.node.setPositionX(location1.x - this.BaseWidth);\r\n        this.motionStreak.node.setPositionY(location1.y - this.BaseHeight);\r\n        if (location.x < this.margins || location.x > (2 * this.BaseWidth - this.margins\r\n            || location.y < 216)) {\r\n            this.motionStreak.reset();\r\n            return;\r\n        }\r\n        this.updateTouch(location);\r\n        // this.previousPt = location;\r\n        // let motionpos = this.node.convertToNodeSpace(location1);\r\n        // this.motionStreak.node.position=motionpos;\r\n    },\r\n    //多点触控\r\n    multMoveCallBack:function(location01,location02 = null){\r\n        this.touchState =\"mult\";\r\n        this.motionStreak.reset();\r\n        let location1 = this.gameNode.convertToNodeSpace(location01);\r\n        // let location2 = this.gameNode.convertToNodeSpace(location02);\r\n        // console.log(\"1\",location1);\r\n        // console.log(\"2\",location2);\r\n        if(this.previousPt == null){\r\n            this.previousPt={};\r\n            this.previousPt[0]= location1;\r\n            // this.previousPt[1]= location2;\r\n            return;\r\n        }\r\n        var distance = cc.pSub( this.previousPt[0],location1);\r\n        // console.log(\"distance\",distance);\r\n        if(distance.y != 0){\r\n            let origin = this.camera.node.getPositionY();\r\n            let endpos =( origin+distance.y)*0.5;\r\n            if(endpos <0 ){\r\n                endpos =0;\r\n            }\r\n            if(endpos >this.startCameraY){\r\n                endpos = this.startCameraY;\r\n            }\r\n            if(endpos== 0)\r\n                return;\r\n            let move = origin - endpos;\r\n            this.camera.node.setPositionY(endpos);\r\n            for (var i = this.hammerStart; i < this.hammerEnd; i++) {\r\n                if(this.hammers[i] != undefined){\r\n                    let location=this.hammers[i].node.position;\r\n                    // let action2 = cc.moveTo(0.1,{x:location.x,y:location.y+move})\r\n                     // this.hammers[i].node.runAction(action2);\r\n                    this.hammers[i].node.setPositionY(location.y+move);\r\n                }\r\n            }\r\n        }\r\n    },\r\n    //-----------------------------touch   end-------------------------\r\n    //-----------------------------bottom   start-------------------------\r\n\r\n\r\n\r\n    eventcallback: function (type, id, string = null) {\r\n        // let node= this.itemList.indexOf(sender);\r\n        switch (type) {\r\n            case 0:\r\n                if (string == null){\r\n                    //视频激励\r\n                    if(GameConfig.isFBInstantGame()){\r\n                        let FBP = require(\"FBPlugin\");\r\n                        self = this;\r\n                        FBP.RewardedVideoAsync(function(){\r\n                                self.accleleratorChange(id);\r\n                                self.GameMenuController.updateButtom();\r\n                            }\r\n                        );\r\n                    }else{\r\n                        this.accleleratorChange(id);\r\n                    }\r\n\r\n                }\r\n                else {\r\n                    if (string == 'finish') {\r\n                        this.accleleratorrRecover(id);\r\n                    }\r\n                }\r\n                break;\r\n            case 1:\r\n                this.toolChange(id);\r\n                break;\r\n            case 2:\r\n                this.efficiencyAdd(id,string);\r\n                break;\r\n        }\r\n    },\r\n    //广告加速开始\r\n    accleleratorChange: function (id) {\r\n        let conf = AcceleratorConfig[id];\r\n        Global['bar' + id] = conf.time;\r\n        this.changeHammerSpeed();\r\n        this.GameMenuController.updateButtom();\r\n\r\n    },\r\n    //广告加速结束\r\n    accleleratorrRecover: function (id) {\r\n        this.changeHammerSpeed();\r\n        this.GameMenuController.updateButtom();\r\n    },\r\n\r\n    changeHammerSpeed: function () {\r\n        let speedHammer = 0;\r\n        let speedGold = 0;\r\n        for (let i = 1; i <= 2; i++) {\r\n            if (Global['bar' + i] > 0) {\r\n                speedHammer += AcceleratorConfig[i].speed;\r\n                speedGold += AcceleratorConfig[i].coin;\r\n            }\r\n        }\r\n        if (speedHammer == 0) {\r\n            speedHammer = 1;\r\n        }\r\n        if (speedGold == 0) {\r\n            speedGold = 1;\r\n        }\r\n        this.accelerHammer = speedHammer;\r\n        this.accelerGold = speedGold;\r\n        for (var i = this.hammerStart; i <= this.hammerEnd; i++) {\r\n            if (this.hammers[i] != undefined) {\r\n                let conf1 = AttributeConfig[Global.hammer[i].attribute];\r\n                this.hammers[i].timeScale = 0.17 * (conf1.att / parseFloat(conf1.time)) * this.accelerHammer;\r\n            }\r\n        }\r\n    },\r\n    changeGoldSpeed: function () {\r\n\r\n    },\r\n    toolChange: function (id) {\r\n        let info = ToolConfig[id];\r\n\r\n        if (Global.hammer[id] == undefined) {//激活\r\n            let bool = this.checkCanAdd(id);\r\n            if (bool) {\r\n                Global.hammer[id] = {id: id, attribute: info.attribute};\r\n                Global.saveHammer(Global.hammer);\r\n                this.addHammer(id);\r\n                this.setSmPosition(id);\r\n            } else {\r\n                this.addAdTime(id);\r\n            }\r\n            this.GameMenuController.updateButtom();\r\n\r\n        } else {//升级\r\n            let conf = AttributeConfig[Global.hammer[id].attribute];\r\n            let mess = {};\r\n\r\n            if (conf.costtype = 1001) {\r\n                Global.gold -= conf.cost;\r\n                mess['gold'] = Global.gold;\r\n            } else if (conf.costtype = 1002) {\r\n                Global.gem -= conf.cost;\r\n                mess['gem'] = Global.gem;\r\n            }\r\n            if (conf.next != -1) {\r\n                Global.hammer[id].attribute = conf.next;\r\n                let conf1 = AttributeConfig[conf.next];\r\n                Global.saveHammer(Global.hammer);\r\n                this.hammers[id].timeScale = 0.17 * (conf1.att / parseFloat(conf1.time)) * this.accelerHammer;\r\n            }\r\n            this.GameMenuController.updateDate(mess);\r\n        }\r\n    },\r\n    checkCanAdd: function (id) {\r\n        let conf = ToolConfig[id];\r\n        let thisID;\r\n        let confArry;\r\n        if (\"unlock\" in conf) {\r\n            if (conf.unlock.indexOf(\";\") != -1) {\r\n                confArry = conf.unlock.split(\";\");\r\n                thisID = confArry[0];\r\n            } else {\r\n                thisID = parseInt(conf.unlock);\r\n            }\r\n            if (thisID == -1) {\r\n                return true;\r\n            }\r\n            if (thisID == 0) {//点击激活\r\n                return true;\r\n            } else if (thisID == 1) {//视频激励\r\n                return Global.openAdTimes > 0;\r\n            } else if (thisID == 2) {//等级激活\r\n                let needlvl = confArry[1];\r\n                if (Global.level < needlvl) {\r\n                    return false;\r\n                } else {\r\n                    return true;\r\n                }\r\n\r\n            } else if (thisID == 3) {//邀请好友\r\n                // if(Global.freindsInfo[id]&&Global.freindsInfo[id].length){\r\n                //     Global.inviteFriends = Global.freindsInfo[id].length;\r\n                // }else{\r\n                //     Global.inviteFriends=0;\r\n                // }\r\n                if(Global.inviteFriends<confArry[1]){\r\n                    return false;\r\n                }else{\r\n                    return true;\r\n                }\r\n            }\r\n        }\r\n        return false;\r\n    },\r\n    addFriendCallBack:function(friendId){\r\n        if(Global.freindsInfo== null){\r\n            Global.freindsInfo = {};\r\n        }\r\n\r\n    },\r\n    addAdTime: function (id) {\r\n        let conf = ToolConfig[id];\r\n        let thisID;\r\n        let confArry;\r\n        let self = this;\r\n        if (\"unlock\" in conf) {\r\n            if (conf.unlock.indexOf(\";\") != -1) {\r\n                confArry = conf.unlock.split(\";\");\r\n                thisID = confArry[0];\r\n            } else {\r\n                thisID = parseInt(conf.unlock);\r\n            }\r\n            if (thisID == 1) {//视频激励\r\n                if(GameConfig.isFBInstantGame()){\r\n                    let FBP = require(\"FBPlugin\");\r\n                    FBP.RewardedVideoAsync(function(){\r\n                            Global.openAdTimes++;\r\n                            self.GameMenuController.updateButtom();\r\n                        }\r\n                    );\r\n                }else{\r\n                    Global.openAdTimes++;\r\n                }\r\n            } else if (thisID == 3) {//邀请好友\r\n                let FBP1 = require(\"FBPlugin\");\r\n                let self = this;\r\n                if(GameConfig.isFBInstantGame()){\r\n                    FBP1.chooseAsync(function(friendID){\r\n                        if(Global.freindsInfo== null){\r\n                            Global.freindsInfo = {};\r\n                        }\r\n                        if( Global.freindsInfo[id] == null){\r\n                            Global.freindsInfo[id] =[];\r\n                        }\r\n                        var find = false;\r\n                        for(var i = 0;i<Global.freindsInfo[id].length;i++){\r\n                            let oldFriend = Global.freindsInfo[id];\r\n                            if(oldFriend ==friendID ){\r\n                                find= true;\r\n                                break;\r\n                            }\r\n                        }\r\n                        if(!find){\r\n                            Global.freindsInfo[id].push(friendID);\r\n                            Global.inviteFriends = Global.freindsInfo[id].length;\r\n                        }\r\n                        self.GameMenuController.updateButtom();\r\n                    });\r\n                }else{\r\n                    Global.inviteFriends++;\r\n                }\r\n            }\r\n        }\r\n    },\r\n\r\n    efficiencyAdd: function (id,str = null) {\r\n        if(str != null){\r\n            this.efficiencyChange();\r\n            return;\r\n        }\r\n        let conf = EfficiencyConfig[id];\r\n        let gem = 0;\r\n        let addgold=0;\r\n        if (conf.costtype == 1002 && Global.gem >= conf.cost) {//enough gem\r\n            gem = Global.gem - conf.cost;\r\n            if (conf.coin > 0) {\r\n                // this.efficeGold += conf.coin - 1;\r\n                let timestamp = Date.parse( new Date())/1000;// 以秒为单位\r\n                Global.efficiency[id] = {'id':id,'timeleft':conf.time,'timestart':timestamp};\r\n                this.efficiencyChange();\r\n            }\r\n            let myinfo = {};\r\n            if (conf.jumptime > 0) {//jump time\r\n\r\n                for(let i=this.hammerStart;i<=this.hammerEnd; i++){\r\n                    if(Global.hammer[i] != undefined){\r\n                        let attr = AttributeConfig[Global.hammer[i].attribute];\r\n                        addgold+=conf.jumptime*60*60/attr.time* attr.att;\r\n                    }\r\n                }\r\n                Global.addgold = addgold;\r\n                Global.btnType = 'skip';\r\n                Global.skipID = id;\r\n                this.upgradView.active= true;\r\n            }\r\n        }\r\n        this.GameMenuController.updateDate({'gem': gem});\r\n        Global.saveGem(gem);\r\n        Global.saveEfficiency(Global.efficiency);\r\n        this.GameMenuController.updateButtom();\r\n    },\r\n    //进入游戏计算离线时间 并计算收益\r\n    initEfficienyInfo:function(){\r\n        let nowtime= Date.parse( new Date())/1000;// 以秒为单位;\r\n        let addgold = 0;\r\n        for (let id in Global.efficiency) {\r\n            if ( Global.efficiency[id] == null){\r\n                continue;\r\n            }\r\n            let paseTime = (nowtime - Global.efficiency[id].timestart)/60;//以min\r\n            let conf = EfficiencyConfig[id];\r\n            let useTime = conf.time - Global.efficiency[id].timeleft;\r\n            if(paseTime > conf.time) {\r\n                paseTime = conf.time;\r\n            }\r\n            let outlineTime= paseTime - useTime;\r\n            let timeleft = conf.time - outlineTime - useTime;\r\n            if(timeleft <=0){\r\n                Global.efficiency[id] = null;\r\n            }else{\r\n                Global.efficiency[id].timeleft = parseInt(timeleft);\r\n                this.efficeGold += conf.coin - 1;\r\n            }\r\n            for(let i=this.hammerStart;i<=this.hammerEnd; i++){\r\n                if(Global.hammer[i] != undefined){\r\n                    let attr = AttributeConfig[Global.hammer[i].attribute];\r\n                    addgold+=conf.coin*outlineTime*60* attr.att/attr.time;\r\n                }\r\n            }\r\n            if(Global.offlinetime<outlineTime){\r\n                Global.offlinetime = outlineTime;\r\n            }\r\n        }\r\n        Global.saveEfficiency(Global.efficiency);\r\n        addgold  = parseInt(addgold);\r\n        if(addgold >0) {\r\n            Global.addgold = parseInt(addgold);\r\n            Global.btnType = 'outline';\r\n            this.upgradView.active = true;\r\n        }\r\n    },\r\n    //收益加速开始/结束\r\n    efficiencyChange: function () {\r\n        let addeff=0;\r\n\r\n        for( let id in Global.efficiency){\r\n            if(Global.efficiency[id] == null)\r\n                continue;\r\n            let conf = EfficiencyConfig[id];\r\n            addeff+=conf.coin - 1;\r\n        }\r\n        this.efficeGold = addeff;\r\n        this.GameMenuController.updateButtom();\r\n    },\r\n    //-----------------------------bottom   end----------------------------\r\n    //-----------------------------引导   start----------------------------\r\n\r\n\r\n\r\n    //-----------------------------引导   end----------------------------\r\n    //-----------------------------GM   part start-------------------------\r\n\r\n    onClickBtnaddGem() {\r\n\r\n        let gem = Global.gem + 100;\r\n        this.GameMenuController.updateDate({'gem': gem});\r\n        Global.saveGem(gem);\r\n        this.GameMenuController.updateButtom();\r\n    },\r\n\r\n    onClickBtnsubGem() {\r\n\r\n        let gem = Global.gem - 10 > 0 ? Global.gem - 10 : 0;\r\n        this.GameMenuController.updateDate({'gem': gem});\r\n        Global.saveGem(gem);\r\n        this.GameMenuController.updateButtom();\r\n    },\r\n    onClickBtnaddGold() {\r\n\r\n        let gold = Global.gold + 10;\r\n        this.GameMenuController.updateDate({'gold': gold});\r\n        Global.saveGold(gold);\r\n        this.GameMenuController.updateButtom();\r\n    },\r\n    onClickBtnsubGold() {\r\n\r\n        let gold = Global.gold - 10 > 0 ? Global.gold - 10 : 0;\r\n        this.GameMenuController.updateDate({'gold': gold});\r\n        Global.saveGold(gold);\r\n        this.GameMenuController.updateButtom();\r\n    },\r\n    onClickBtnaddExp() {\r\n\r\n        let exp = Global.exp +1000;\r\n        this.GameMenuController.updateDate({'exp': exp});\r\n        Global.saveExp(exp);\r\n        // this.GameMenuController.updateButtom();\r\n    }\r\n    //-----------------------------GM   part end-------------------------\r\n});\r\n//"]}