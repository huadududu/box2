{"version":3,"sources":["BoxController.js"],"names":["StageConfig","require","BlockConfig","CycleConfig","ToolConfig","AttributeConfig","AcceleratorConfig","EfficiencyConfig","BoxConfig","RewardConfig","LanguageConfig","GameType","GameUtils","GameState","BlockBigFactory","BlockSmallFactory","RewardItemFactory","UILeadFactory","SpriteFrameCenter","ParticleSystemCenter","SkeletonDataCenter","GameConfig","Global","cc","Class","extends","Component","properties","gameNode","Node","camera","Camera","BlockBig","Prefab","BlockSmall","MarginsBig","MarginsSmall","RewardItem","UIBottom","uilead","inviteUI","inviteItem","Sky","Bgbz","Underground","motionStreak","MotionStreak","boxSpine","sp","Skeleton","GameMenu","treasure","Button","upgradView","loadingView","hammerNode","blockNodes","onLoadPage","openbox","hardlvl","Label","type","visible","default","blockWidth","blockBlank","moveNum","margins","curMaxLine","canTouch","previousPt","Hatting","HattingPos","accelerHammer","accelerGold","efficeGold","startClock","gameState","init","loadstate","onLoad","winsize","winSize","BaseHeight","height","BaseWidth","width","GameHeight","hammerStart","hammerEnd","boxLeadNode","rowNum","startCameraY","blockLeadNode","blockPosNode","BoxID","openSecond","GameMenuController","find","getComponent","blocks","marginlist","hammers","rewardItem","startPos","setCompleteListener","animationName1","trackEntry","animation","name","log","trackIndex","addItems","firstOpen","onloadState","startSC","initdata","active","start","initInfo","timescale","hammer","initEfficienyInfo","i","undefined","node","nodehammer","addComponent","info","addSkeletonData","addChild","id","j","animationName","checkCanHammer","smCallback","attribute","conf1","timeScale","att","parseFloat","time","update","restart","hard","saveHard","deleteBoxLead","destroy","hatting","floorNum","layer","length","blockwidth","size","hardlvlFun","count","blank","addBlocks","cameraStartPosY","changeBlockLead","playHammers","initTreasure","addUIBottom","playHammerSpine","hammerpos","setAnimation","setSmPosition","startAddHammer","stopHammerSpine","addHammer","conf","changeHammerSpine","data","skeletonData","startLine","x","startRow","y","position","realwidth","maxline","maxrow","totoalRowNum","range","geScreenRange","line","canclick","curline","checkCanDestroy","push","num","randomInt","row","location","getEffByBlock","getPngId","max","cameraPosY","getPositionY","min","maxPosY","canshowy","Math","floor","hamX","hamY","p","isValid","destroyBlock","resetMarginList","resetBlockList","thisfloor","lineinfo","addLines","getPngName","cycleID","topline","top","pngname","thisNum","factory","curX","curY","lineArray","left","createMargins","right","endpos","create","thisID","indexOf","cycleArry","split","getnum","parseInt","neednumber","texiao","addParticleForNode","practice","removeFromParent","destroyUpdate","cameraCentPosY","firstblock","bool","myinfo","addexp","addgold","exp","gold","updateDate","broadcastShows","coin","saveExp","saveGold","maxlinenum","maxLineNum","addBoxLead","end","move","oldY","newY","moveY","action1","moveTo","runAction","ralmovelength","posbottom","totoal","skyposy","bzYbottom","other","movePos","setPositionY","playBoxSpine","stopBoxSpine","Boxstr","box","boxarr","BoxConf","normalSprite","getFrameFromAtlas","icon","pressedSprite","hoverSprite","disabledSprite","addSkeletonDataWait","rewardID","reward","itemdata","random","z","gem","rewardarry","valuestr","valueArr","startnum","level","createRewardItem","golds","gems","saveGem","locationX","locationY","action","action2","callFunc","setFinish","sequence","onClickTreasure","event","touchEndPoint","getLocation","updateTouch","ratation","point","cameraY","gameY","touchStartCallBack","location1","isFBInstantGame","FBP","InterstitialAdAsync","chooseAsync","createShortCut","touchState","convertToNodeSpace","setPositionX","reset","touchCancelCallBack","isTouching","touchEndCallBack","touchMoveCallBack","multMoveCallBack","location01","location02","distance","pSub","origin","eventcallback","string","type0deal","type1deal","type2deal","self","RewardedVideoAsync","accleleratorChange","accleleratorrRecover","changeHammerSpeed","updateButtom","speedHammer","speedGold","speed","changeGoldSpeed","checkCanAdd","saveHammer","addAdTime","mess","costtype","cost","next","confArry","unlock","openAdTimes","needlvl","inviteFriends","freindsInfo","adGame","FBP1","friendID","oldFriend","PopMsgController","showMsg","language","savefreindsInfo","str","efficiencyChange","timestamp","Date","parse","efficiency","jumptime","attr","btnType","skipID","saveEfficiency","nowtime","paseTime","timestart","useTime","timeleft","outlineTime","offlinetime","addeff","onClickBtnaddGem","onClickBtnsubGem","onClickBtnaddGold","onClickBtnsubGold","onClickBtnaddExp","onClickUnlockAll"],"mappings":"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","file":"BoxController.js","sourceRoot":"../../../../../assets/src/controller","sourcesContent":["/**\n * Created by bing on 20/04/2018.\n */\n\n//负责head展现和变换。\nlet StageConfig = require(\"StageConfig\");\nlet BlockConfig = require(\"BoxConfig1\");\nlet CycleConfig = require(\"CycleConfig\");\nlet ToolConfig = require(\"ToolConfig\");\nlet AttributeConfig = require(\"AttributeConfig\");\nlet AcceleratorConfig = require(\"AcceleratorConfig\");\nlet EfficiencyConfig = require(\"EfficiencyConfig\");\nlet BoxConfig = require(\"BoxConfig\");\nlet RewardConfig = require(\"RewardConfig\");\nlet LanguageConfig = require(\"LanguageConfig\");\n\n\n\nlet GameType = require(\"GameType\");\nlet GameUtils = require(\"GameUtils\");\nlet GameState = require(\"GameState\");\nlet BlockBigFactory = require(\"BlockBigFactory\");\nlet BlockSmallFactory = require(\"BlockSmallFactory\");\nlet RewardItemFactory = require(\"RewardItemFactory\");\nlet UILeadFactory = require(\"UILeadFactory\");\n\nlet SpriteFrameCenter = require(\"SpriteFrameCenter\");\nlet ParticleSystemCenter = require(\"ParticleSystemCenter\");\nlet SkeletonDataCenter = require(\"SkeletonDataCenter\");\nlet GameConfig = require(\"GameConfig\");\n// let GameMenuController = require('GameMenuController');\n\nlet Global = require('Global');\n\n\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        gameNode: cc.Node,\n        camera: cc.Camera,\n        BlockBig: cc.Prefab,\n        BlockSmall: cc.Prefab,\n        MarginsBig: cc.Prefab,\n        MarginsSmall: cc.Prefab,\n        RewardItem: cc.Prefab,\n        UIBottom: cc.Prefab,\n        uilead: cc.Prefab,\n        inviteUI:cc.Prefab,\n        inviteItem:cc.Prefab,\n        Sky: cc.Node,\n        Bgbz: cc.Node,\n        Underground: cc.Node,\n        motionStreak: cc.MotionStreak,\n        // hammer: sp.Skeleton,\n        boxSpine: sp.Skeleton,\n        GameMenu:cc.Node,\n        treasure: cc.Button,\n        upgradView: cc.Node,\n        loadingView:cc.Node,\n        hammerNode:cc.Node,\n        blockNodes:cc.Node,\n        onLoadPage:cc.Node,\n        openbox: cc.Node,\n        hardlvl:cc.Label,\n        type: {\n            visible: false,\n            default: 0\n        },\n        blockWidth: 100,\n        blockBlank: {\n            visible: false,\n            default: 0\n        },\n        moveNum: {\n            visible: false,\n            default: 0\n        },\n        margins: {\n            visible: false,\n            default: 0\n        },\n        curMaxLine: {\n            visible: false,\n            default: 0\n        },\n        canTouch: {\n            visible: false,\n            default: true\n        },\n        previousPt: {\n            visible: false,\n            default: null\n        },\n        Hatting: {\n            visible: false,\n            default: false\n        },\n        HattingPos: {\n            visible: false,\n            default: null\n        },\n        accelerHammer: {\n            visible: false,\n            default: 1\n        },\n        accelerGold: {\n            visible: false,\n            default: 1\n        },\n        efficeGold: 0,\n        startClock:3,\n        gameState: GameState.init,//0 init 1 playing 2 rolling 3 end,\n        loadstate:2,\n\n    },\n\n\n    onLoad: function () {\n        this.winsize = cc.winSize;\n        this.BaseHeight = this.winsize.height / 2;\n        this.BaseWidth = this.winsize.width / 2;\n        this.GameHeight = this.winsize.height - 206;\n        this.hammerStart = 1;//表示锤子的起始id\n        this.hammerEnd = 10;//表示锤子的最后一个id\n        this.boxLeadNode = null;//box的引导节点\n        this.rowNum = 0;\n        this.startCameraY=0;\n        this.blockLeadNode = null;\n        this.blockPosNode = null;\n        this.BoxID = 0;\n        this.openSecond =0;\n        this.GameMenuController = cc.find(\"Canvas/GameMenu\").getComponent(\"GameMenuController\");\n        // this.  loadingView = cc.find(\"Canvas/loading\").getComponent(\"loadingView\");\n        // Global.initInfo();\n        this.blocks = [];\n        this.marginlist = [];\n        this.hammers = {};\n        this.rewardItem = [];\n        this.accelerHammer = 1;\n        this.accelerGold = 1;\n        this.startPos = -this.GameHeight / 2;\n        this.boxSpine.setCompleteListener(trackEntry => {\n            var animationName1 = trackEntry.animation ? trackEntry.animation.name : \"\";\n            cc.log(\"recordSpine [track %s][animation %s] end.\", trackEntry.trackIndex, animationName1);\n            // this.restart();\n            this.addItems();\n\n        });\n\n        this.firstOpen = true;\n\n    },\n    onloadState:function(){\n            this.startSC();\n            this.initdata();\n             this.onLoadPage.active = false;\n    },\n    start: function () {\n        Global.loadstate--;\n        if(Global.loadstate<=0) {\n            this.onloadState();\n        }\n    },\n    startSC: function () {\n        this.GameMenuController.initInfo();\n        this.hammers = {};\n        let timescale = 1;\n        let hammer = Global.hammer;\n        this.initEfficienyInfo();//[改 延迟执行]\n        // SpriteFrameCenter.preLoadAtlas(\"png/box\", this.initdata.bind(this));\n        for (var i = this.hammerStart; i <= this.hammerEnd; i++) {\n            if (hammer[i] == undefined)\n                continue;\n            let node = new cc.Node();\n            let nodehammer = node.addComponent(sp.Skeleton);\n            let info = ToolConfig[i];\n            let animation = info.animation;\n            SkeletonDataCenter.addSkeletonData(animation, nodehammer);\n            this.hammerNode.addChild(node);\n            this.hammers[hammer[i].id] = nodehammer;\n            nodehammer.node.active = false;\n            let j=i;\n            nodehammer.setCompleteListener(trackEntry => {\n                var animationName = trackEntry.animation ? trackEntry.animation.name : \"\";\n                // cc.log(\"HammerSpine [track %s][animation %s] end.\", trackEntry.trackIndex, animationName);\n                nodehammer.node.active = false;\n                if (this.checkCanHammer(j)) {\n                    this.smCallback(j);\n                }\n            });\n            let attribute = Global.hammer[i].attribute;\n            let conf1 = AttributeConfig[attribute];\n            nodehammer.timeScale = 0.17 * conf1.att / parseFloat(conf1.time) * this.accelerHammer;\n            // nodehammer.timeScale =  conf1.att / parseFloat(conf1.time) * this.accelerHammer;\n        }\n\n    },\n    update: function () {\n        // this.cameraCentPosY();\n    },\n    restart: function () {\n        this.openbox.active = false;\n        if (StageConfig[Global.hard+1] != null && StageConfig[Global.hard+1] != undefined) {\n            Global.hard++;\n            Global.saveHard(Global.hard);\n        }\n        this.deleteBoxLead();\n        this.boxSpine.node.active = false;\n        for (let i = 1; i < 4; i++) {\n            // let node = this.rewardItem[i];\n            this.rewardItem[i].destroy();\n            // if(cc.isValid( node)){\n            //     node.destroy();\n            // }\n        }\n        this.rewardItem = [];\n        // this.addItems();\n        this.initdata();\n        this.gameState = GameState.hatting;\n    },\n    initdata: function () {\n        this.openSecond++;\n        let floorNum = StageConfig[Global.hard].layer;\n        for (var i = 0; i < BlockConfig.length; i++) {\n            if (BlockConfig[i].blockwidth == StageConfig[Global.hard].size) {\n                this.type = BlockConfig[i].type;\n                break;\n            }\n        }\n        this.hardlvlFun();\n        this.rowNum = BlockConfig[this.type].count;\n        this.blockWidth = BlockConfig[this.type].blockwidth;\n        this.blockBlank = BlockConfig[this.type].blank;\n        this.margins = BlockConfig[this.type].margins;\n\n        this.addBlocks();\n        this.cameraStartPosY();\n        this.changeBlockLead();\n        this.treasure.node.active = true;\n        this.playHammers();\n        this.initTreasure();\n        if(this.firstOpen) {\n            this.GameMenuController.addUIBottom();\n            this.firstOpen = false;\n        }\n\n\n    },\n    //-----------------------------锤子部分 start-------------------------\n    playHammerSpine: function (hammerpos) {\n\n        this.hammers[hammerpos].node.active = true;\n        this.hammers[hammerpos].setAnimation(0, \"newAnimation\", true);\n    },\n    playHammers: function () {\n        for (var i = this.hammerStart; i <= this.hammerEnd; i++) {\n            if (this.hammers[i] != undefined) {\n                this.setSmPosition(i);\n            }\n        }\n    },\n    startAddHammer:function(){\n\n    },\n    stopHammerSpine: function (hammerpos) {\n        this.hammers[hammerpos].node.active = false;\n    },\n    addHammer: function (id) {\n        let node = new cc.Node();\n        let hammer = node.addComponent(sp.Skeleton);\n        let info = ToolConfig[id];\n        let animation = info.animation;\n        let conf = AttributeConfig[info.attribute];\n\n        SkeletonDataCenter.addSkeletonData(animation, hammer);\n        this.hammerNode.addChild(node);\n        this.hammers[id] = hammer;\n        hammer.node.active = false;\n        hammer.setCompleteListener(trackEntry => {\n            var animationName = trackEntry.animation ? trackEntry.animation.name : \"\";\n            // cc.log(\"HammerSpine [track %s][animation %s] end.\", trackEntry.trackIndex, animationName);\n            hammer.node.active = false;\n            if (this.checkCanHammer(id)) {\n                    this.smCallback(id);\n            }\n        });\n        let timescale = 0.17 * conf.att / parseFloat(conf.time) * this.accelerHammer;\n        // let timescale =  conf.att / parseFloat(conf.time) * this.accelerHammer;\n        hammer.timeScale = timescale;\n    },\n    changeHammerSpine: function (data) {\n        this.hammer.skeletonData = data;\n    },\n\n\n    checkCanHammer: function (id) {\n        var hammer = Global.hammer;\n        if (hammer[id] != undefined && hammer[id].attribute != -1)\n            return true;\n        return false;\n    },\n    setSmPosition: function (hammerpos) {\n        if(this.blockPosNode !=null){\n            if (this.HattingPos == null) {\n                this.HattingPos = {};\n            }\n            let startLine = this.blockPosNode.x;\n            let startRow = this.blockPosNode.y;\n            this.HattingPos[hammerpos] = this.blockPosNode;\n            let position = this.hammerpos(startLine,startRow);\n            // console.log(\"choose:\",this.HattingPos[hammerpos]);\n            this.hammers[hammerpos].node.position = position;\n            this.hammers[hammerpos].node.active = true;\n            this.playHammerSpine(hammerpos);\n            this.blockPosNode = null;\n            return;\n        }\n        let realwidth = this.blockWidth + this.blockBlank;\n        let maxline = this.curMaxLine;\n        let maxrow = this.totoalRowNum(0);\n        if (maxline == 0 && maxrow == 0) {\n            this.HattingPos = null;\n            // this.sm.node.visible = false;\n            this.hammers[hammerpos].node.active = false;\n            return;\n        }\n\n        let range = this.geScreenRange();\n        let line = this.curMaxLine;\n        let find = false;\n        let canclick = [];\n        let curline = line;\n        for (; curline >= 0; curline--) {\n            for (var i = 0; i < this.rowNum; i++) {//当前行可以删除的\n                if (this.blocks[curline] && this.checkCanDestroy(curline, i)) {\n                    let find = false;\n                    for (var j = this.hammerStart; j <= this.hammerEnd; j++) {\n                        if (this.HattingPos && this.HattingPos[j]) {\n                            if (this.HattingPos[j].x == curline && i == this.HattingPos[j].y) {\n                                find = true;\n                                break;\n                            }\n                        }\n                    }\n                    if (!find) {\n                        canclick.push(i);\n                    }\n                }\n            }\n            if (canclick.length > 0)\n                break;\n        }\n        if (canclick.length == 0) {\n            this.HattingPos[hammerpos] = null;\n            return;\n        }\n        let num = GameUtils.randomInt(0, canclick.length - 1);\n        let row = canclick[num];\n        let location = this.hammerpos(curline, row);\n        if (this.HattingPos == null) {\n            this.HattingPos = {};\n        }\n        this.HattingPos[hammerpos] = {x: curline, y: row};\n        // console.log(\"choose:\",this.HattingPos[hammerpos]);\n        this.hammers[hammerpos].node.position = location;\n        this.hammers[hammerpos].node.active = true;\n        this.playHammerSpine(hammerpos);\n    },\n    //根据小块的位置 过的特效文件\n    getEffByBlock(line, row) {\n\n        let type = this.type == 0 ? \"BlockBig\" : \"BlockSmall\";\n        let node = this.blocks[line][row].getComponent(type);\n        return node.getPngId();\n    },\n    geScreenRange: function () {\n        let max = this.curMaxLine;\n        let cameraPosY = this.camera.node.getPositionY();\n        let min = 0;\n        let realwidth = this.blockWidth + this.blockBlank;\n        if (cameraPosY <= this.BaseHeight) {\n            min = 0;\n        } else {\n            let maxPosY = max * realwidth;\n            let canshowy = (maxPosY - cameraPosY + this.BaseHeight) / realwidth;\n            min = Math.floor(max - canshowy);\n        }\n        return {max: max, min: min};\n    },\n    //根据块的位置计算锤子的位置\n    hammerpos: function (line, row) {\n        // let cameraY = this.camera.node.getPositionY();\n        // let gameY = this.gameNode.y;\n        let realwidth = this.blockWidth + this.blockBlank;\n        // let realx = row * realwidth + this.margins + this.blockBlank;\n        // let realy = line * realwidth - cameraY ;\n        // let hamX = realx - this.BaseWidth  + this.blockWidth - 50;\n        // let hamY = realy + this.blockWidth -140;\n        // return cc.p(hamX, hamY);\n        let hamX = row * realwidth + this.margins + this.blockBlank -  this.BaseWidth + 50;\n        let hamY = line * realwidth - this.GameHeight/2+this.blockWidth;\n        return cc.p(hamX, hamY)\n\n\n    },\n    smCallback: function (hammerpos) {\n        if (this.HattingPos != null && this.HattingPos[hammerpos] != null) {\n\n            let y = this.HattingPos[hammerpos].y;\n            let x = this.HattingPos[hammerpos].x;\n            // console.log(\"hammer:\",x,y);\n            if (cc.isValid(this.blocks[x][y])) {\n                this.destroyBlock(x, y);\n            }\n            // this.changeBlockLead(true);\n            this.setSmPosition(hammerpos);\n\n\n        }\n    },\n    //-----------------------------锤子部分 end-------------------------\n    //-----------------------------block start-------------------------\n\n    resetMarginList: function () {\n        if (this.marginlist && this.marginlist.length > 0) {\n            for (let i = 0; i < this.marginlist.length; i++) {\n                let node = this.marginlist[i];\n                if (cc.isValid(node)) {\n                    node.destroy();\n                }\n            }\n        }\n        this.marginlist = [];\n    },\n    resetBlockList: function () {\n        if (this.blocks && this.blocks.length > 0) {\n            for (let i = 0; i < this.blocks.length; i++) {\n                for (let j = 0; j < this.blocks[i].length; j++) {\n                    let node = this.blocks[i][j];\n                    if (cc.isValid(node)) {\n                        node.destroy();\n                    }\n                }\n            }\n        }\n        this.blocks = [];\n    },\n    addBlocks: function () {\n\n        this.resetBlockList();\n        this.resetMarginList();\n        let floorNum = StageConfig[Global.hard].layer;\n        let thisfloor = floorNum-2;\n        for (var i = 0; i <floorNum - 1 ; i++) {\n\n            var lineinfo = this.addLines(this.getPngName(StageConfig[Global.hard].cycleID, thisfloor), i);\n\n            this.blocks.push(lineinfo);\n            lineinfo = [];\n            thisfloor--;\n        }\n        let topline = this.addLines(StageConfig[Global.hard].top, floorNum-1);\n        this.blocks.push(topline);\n    },\n    addLines: function (pngname, thisNum) {\n\n        let conf = BlockConfig[this.type];\n        let count = conf.count;\n        let factory = this.type == 0 ? BlockBigFactory : BlockSmallFactory;\n        let curX = conf.margins + conf.blank - this.BaseWidth;\n        let curY = thisNum * (this.blockWidth + conf.blank) + this.startPos;\n        let lineArray = [];\n        let left = factory.createMargins(pngname);\n\n        left.position = cc.p(conf.margins / 2 - this.BaseWidth, curY + this.blockWidth / 2);\n        this.blockNodes.addChild(left);\n        this.marginlist.push(left);\n        let right = factory.createMargins(pngname);\n        let endpos = this.BaseWidth - conf.margins / 2;\n        right.position = cc.p(endpos, curY + this.blockWidth / 2);\n        this.blockNodes.addChild(right);\n        this.marginlist.push(right);\n\n        for (var i = 0; i < count; i++) {\n            let node = factory.create(pngname);\n            node.position = cc.p(curX + this.blockWidth / 2, curY + this.blockWidth / 2);\n            curX += this.blockWidth + conf.blank;\n            this.blockNodes.addChild(node);\n            lineArray.push(node);\n        }\n\n        return lineArray;\n    },\n\n    //根据 获得 图片的名字\n    getPngName(cycleID, thisNum) {\n        let thisID;\n        if (cycleID.indexOf(\";\") != -1) {\n            let cycleArry = cycleID.split(\";\");\n            let getnum = GameUtils.randomInt(0, cycleArry.length - 1);\n            thisID = cycleArry[getnum];\n        } else {\n            thisID = parseInt(cycleID);\n        }\n        let neednumber = 0;\n        for (var i = 1; i <= 10; i++) {\n            if (CycleConfig[thisID][\"num\" + i] == 0) {\n                i = 0;\n                continue;\n            }\n            neednumber += CycleConfig[thisID][\"num\" + i];\n            if (neednumber >= thisNum) {\n                return CycleConfig[thisID][\"block\" + i]\n            }\n            if (i == 10) {\n                i = 0;\n            }\n        }\n    },\n    //销毁砖块\n    destroyBlock: function (line, row) {\n\n        if (!this.blocks[line])\n            return;\n        let node = this.blocks[line][row];\n\n        if (node != null) {\n            let location = this.hammerpos(line, row);\n            let texiao = this.getEffByBlock(line, row);\n             // console.log(\"destroylog:\", line, \":\", row, location);\n            ParticleSystemCenter.addParticleForNode(texiao + \".plist\", this.GameMenuController.practice, location);\n            node.removeFromParent(true);\n            this.blocks[line][row] = null;\n            this.destroyUpdate();\n            this.cameraCentPosY();\n        }\n        this.firstblock = false;\n        this.startClock--;\n        this.changeBlockLead();\n    },\n    changeBlockLead:function(){\n        let bool = this.startClock>0;\n        if(Global.hard == 1 && bool){\n            if(!this.blockLeadNode){\n                var node = UILeadFactory.create();\n                this.blockLeadNode= node;\n                this.hammerNode.addChild(node);\n            }\n            let row =3+this.startClock;\n            let line = 2;\n\n            let position = this.hammerpos(line,row);\n            position.y = position.y - 50;\n            position.x = position.x;\n            this.blockLeadNode.position = position;\n            this.blockPosNode = {x: line,y:row};\n        }else {\n            if (this.blockLeadNode) {\n                this.blockLeadNode.removeFromParent(true);\n                this.blockLeadNode = null;\n                this.blockPosNode = null;\n            }\n\n        }\n\n    },\n    checkCanDestroy: function (line, row) {\n        if (!this.blocks[line] || !this.blocks[line][row])\n            return false;\n        let floorNum = StageConfig[Global.hard].layer;\n        if (line >= floorNum - 1)\n            return true;\n        let node;\n        node = this.blocks[line + 1][row];\n        if (!cc.isValid(node)) {\n            return true;\n        }\n        if (line > 0) {\n            node = this.blocks[line - 1][row];\n            if (!cc.isValid(node)) {\n                return true;\n            }\n        }\n        if (row > 0 && row < this.rowNum - 1) {\n            node = this.blocks[line][row - 1];\n            if (!cc.isValid(node)) {\n                return true;\n            }\n            node = this.blocks[line][row + 1];\n            if (!cc.isValid(node)) {\n                return true;\n            }\n        } else if (row == 0) {\n            node = this.blocks[line][row + 1];\n            if (!cc.isValid(node)) {\n                return true;\n            }\n        } else if (row == this.rowNum - 1) {\n            node = this.blocks[line][row - 1];\n            if (!cc.isValid(node)) {\n                return true;\n            }\n        }\n        return false;\n    },\n    destroyUpdate: function () {\n\n        let myinfo = {};\n        let addexp =1;\n        let addgold = 1 * (this.accelerGold) + this.efficeGold;\n        myinfo.exp = Global.exp + addexp;\n        myinfo.gold = Global.gold + addgold;\n        this.GameMenuController.updateDate(myinfo);\n        this.GameMenuController.broadcastShows({exp:addexp,coin:addgold});\n        Global.saveExp(myinfo.exp);\n        Global.saveGold(myinfo.gold);\n\n        // ssssss\n        var maxlinenum = this.maxLineNum();\n\n        if(maxlinenum == 0){\n            var totoalRowNum = this.totoalRowNum(0);\n            if(totoalRowNum == 0){\n                this.addBoxLead();\n                this.GameMenuController.broadcastShows('finish');\n                this.GameState = GameState.end;\n            }\n        }\n\n\n    },\n    maxLineNum: function () {\n        var max = 0;\n        let floorNum = StageConfig[Global.hard].layer;\n        for (var i = 0; i < floorNum; i++) {\n            for (var j = 0; j < this.rowNum; j++) {\n                if (this.blocks && this.blocks[i] && this.blocks[i][j]) {\n                    var node = this.blocks[i][j];\n                    if (!cc.isValid(node))\n                        continue;\n                    if (i > max) {\n                        max = i;\n                    }\n                    break;\n                }\n            }\n        }\n        return max;\n    },\n\n    totoalRowNum: function (line) {//line 行拥有点的数量\n        var max = 0;\n        for (var j = 0; j < this.rowNum; j++) {\n            var node = this.blocks[line][j];\n            if (!cc.isValid(node))\n                continue;\n            max++;\n        }\n        return max;\n    },\n    //-----------------------------block   end-------------------------\n    //-----------------------------camera   start-------------------------\n\n    cameraCentPosY: function () {\n\n        let maxline = this.maxLineNum();\n        if (this.curMaxLine <= maxline) {\n            return;\n        }\n        let move = this.curMaxLine - maxline;\n        this.curMaxLine = maxline;\n        let oldY = this.camera.node.getPositionY();\n        if (oldY <= 0) {\n            return;\n        }\n        let newY = oldY - this.blockWidth * move;\n        let moveY = 0;\n        if (newY >= 0) {\n            moveY = newY;\n        } else {\n            moveY = 0;\n        }\n        let location = cc.p(0, moveY);\n        let action1 = cc.moveTo(0.1, location);\n        this.camera.node.runAction(action1);\n        let ralmovelength = oldY - newY;\n        // for (var i = this.hammerStart; i < this.hammerEnd; i++) {\n        //     if(this.hammers[i] != undefined){\n        //         let location=this.hammers[i].node.position;\n        //         let action2 = cc.moveTo(0.1,{x:location.x,y:location.y+ralmovelength})\n        //         this.hammers[i].node.runAction(action2);\n        //     }\n        // }\n    },\n\n    cameraStartPosY: function () {\n        let floorNum = StageConfig[Global.hard].layer;\n        let height = floorNum * (this.blockWidth + this.blockBlank);\n        //地下\n        this.Underground.height = height;\n        let posbottom = (height - this.GameHeight) / 2;\n        this.Underground.y = posbottom;\n        //地面\n        let totoal = this.Bgbz.height + height - 50;\n        let skyposy;\n        let bzYbottom;\n        let other = this.GameHeight - totoal;\n        bzYbottom = (totoal + height - this.GameHeight) / 2 - 25;\n        this.Bgbz.y = bzYbottom;\n        let movePos = 0;\n        if (other > 0) {\n            this.Sky.active = true;\n            this.Sky.height = other + 10;\n            skyposy = (this.GameHeight - other) / 2;\n            this.Sky.y = skyposy;\n            // this.camera.node.setPositionY(0);\n            movePos = 0;\n        } else {\n            this.Sky.active = false;\n            // this.camera.node.setPositionY(-other);\n            movePos = -other;\n        }\n        this.camera.node.setPositionY(movePos);\n        this.startCameraY = movePos;\n        this.curMaxLine = floorNum - 1;\n    },\n    //-----------------------------camera   end-------------------------\n    //----------------------------- treasure start----------------------\n    playBoxSpine: function () {\n        this.boxSpine.node.active = true;\n        this.boxSpine.setAnimation(0, \"newAnimation\", false);\n    },\n    stopBoxSpine: function () {\n        this.boxSpine.node.active = false;\n    },\n    initTreasure: function () {\n        let BoxID;\n        let Boxstr = StageConfig[Global.hard].box;\n        if(Boxstr.indexOf(\";\") != -1){\n            let boxarr = Boxstr.split(\";\");\n            let num = GameUtils.randomInt(0, boxarr.length - 1);\n            BoxID= boxarr[num];\n        }else{\n            BoxID= parseInt(Boxstr);\n        }\n\n        this.BoxID = BoxID;\n        let BoxConf = BoxConfig[BoxID];\n        this.treasure.normalSprite = SpriteFrameCenter.getFrameFromAtlas(\"png/box\", BoxConf.icon + \".png\");\n        this.treasure.pressedSprite = SpriteFrameCenter.getFrameFromAtlas(\"png/box\", BoxConf.icon + \".png\");\n        this.treasure.hoverSprite = SpriteFrameCenter.getFrameFromAtlas(\"png/box\", BoxConf.icon + \".png\");\n        this.treasure.disabledSprite = SpriteFrameCenter.getFrameFromAtlas(\"png/box\", BoxConf.icon + \".png\");\n        let animation = BoxConf.animation;\n        SkeletonDataCenter.addSkeletonDataWait(animation, this.boxSpine);\n        this.treasure.node.y = -this.GameHeight / 2 + this.blockWidth + 35 - 20;\n        this.boxSpine.node.y = -this.GameHeight / 2 + this.blockWidth + 35 - 20+103;\n        // let loction  = this.gameNode.convertToWorldSpace(this.treasure.node.position);\n        // let loction1 = this.openbox.convertToNodeSpace(loction);\n        // this.boxSpine.node = loction1;\n\n    },\n    addItems: function () {\n\n        let hard = Global.hard;\n        let rewardID = BoxConfig[this.BoxID].reward;\n        let conf = RewardConfig[rewardID];\n        let num = conf.num;\n        let itemdata = {};\n        let totoal = 0;\n        let reward = {};\n        let max = 0;\n        for (let i = 1; i < 7; i++) {\n            if (conf['rate' + i] != 0) {\n                totoal = conf['rate' + i];\n                if (i == 1) {\n                    itemdata[i] = totoal;\n                    max = itemdata[i];\n                } else {\n                    itemdata[i] = itemdata[i - 1] + totoal;\n                    max = itemdata[i];\n                }\n            }\n        }\n        for (let j = 1; j <= num; j++) {\n            let random = GameUtils.random(max);\n            for (let z = 1; itemdata[z] != undefined; z++) {\n                if (itemdata[z] < random) {\n                    continue;\n                }\n                reward[j] = conf['item' + z];\n                break;\n            }\n        }\n        let gold = 0;\n        let gem = 0;\n        for (let i = 1; i <= num; i++) {\n            if (reward[i] != undefined) {\n                if (reward[i].indexOf(\";\") != -1) {\n                    let rewardarry = reward[i].split(\";\");\n                    let valuestr = rewardarry[1];\n                    let valueArr;\n                    let startnum=0;\n                    if(valuestr.indexOf('*') != -1){\n                        valueArr = valuestr.split(\"*\");\n                        startnum = valueArr[0];\n                        for(let i = 1;i<valueArr.length;i++){\n                            if(valueArr[i] == \"lv\"){\n                                startnum*=Global.level;\n                            }\n                        }\n                    }else{\n                        startnum = parseInt(valuestr);\n                    }\n                    if (rewardarry[0] == 1001) {\n                        gold += startnum;\n                    } else if (rewardarry[0] == 1002) {\n                        gem += startnum;\n                    }\n                }\n            }\n            this.createRewardItem(reward[i], i);\n            this.openbox.active = true;\n        }\n        if (gold > 0 || gem > 0) {\n            let golds = Global.gold + gold;\n            let gems = Global.gem + gem;\n            this.GameMenuController.updateDate({gold: golds, gem: gems});\n            Global.saveGold(golds);\n            Global.saveGem(gems);\n        }\n\n    },\n    createRewardItem: function (reward, i) {\n        if (this.rewardItem[i]) {\n            this.rewardItem[i].destroy();\n            this.rewardItem[i] = null;\n        }\n        let start = -400 + i * 200;\n\n        let node = RewardItemFactory.create(reward);\n        let locationX = this.treasure.node.position.x;\n        let locationY = this.treasure.node.position.y+103;\n\n        this.rewardItem[i] = (node);\n        node.position = cc.p(locationX,locationY);\n        let action = cc.moveTo(0.5, cc.p(start, 100));\n        let action2 = cc.callFunc(() => {\n            node.getComponent(\"RewardItem\").setFinish();\n            this.canTouch = true;\n        }, this);\n        // node.runAction(cc. moveTo(0.5,cc.p(start,-20)));\n        this.openbox.addChild(node);\n        node.runAction(cc.sequence(action, action2));\n    },\n    onClickTreasure: function (event) {\n        var maxlinenum = this.maxLineNum();\n        var totoalRowNum = this.totoalRowNum(0);\n        if (maxlinenum != 0 || totoalRowNum != 0) {\n            this.touchEndPoint = event.getLocation();\n\n            this.updateTouch(this.touchEndPoint);\n            return;\n        }\n        this.treasure.node.active = false;\n        this.gameState = GameState.end;\n        this.canTouch = false;\n        this.openbox.active= true;\n        this.playBoxSpine();\n    },\n    addBoxLead:function(){\n        if(Global.hard > 1)\n            return;\n        var maxlinenum = this.maxLineNum();\n        var totoalRowNum = this.totoalRowNum(0);\n        if (maxlinenum == 0 && totoalRowNum == 0) {\n            let node = UILeadFactory.create();\n            node.position= this.treasure.node.position;\n            node.ratation = 180;\n            this.boxLeadNode = node;\n            this.gameNode.addChild(node);\n        }\n    },\n    deleteBoxLead:function(){\n        if(this.boxLeadNode){\n            this.boxLeadNode.removeFromParent(true);\n            this.boxLeadNode= null;\n        }\n    },\n    //-----------------------------treasure end--------------------------\n    //-----------------------------touch   start-------------------------\n    updateTouch: function (point) {\n        let cameraY = this.camera.node.getPositionY();\n        let gameY = this.gameNode.y;\n        let realwidth = this.blockWidth + this.blockBlank;\n        var line = Math.floor((point.y + cameraY) / realwidth);\n        var row = Math.floor((point.x - this.margins - this.blockBlank) / realwidth);\n        let find = false;\n        if (this.checkCanDestroy(line, row)) {\n            for (var i = this.hammerStart; i <= this.hammerEnd; i++) {\n                if (this.HattingPos != null && this.HattingPos[i] != null && this.HattingPos[i] != undefined) {\n                    if (this.HattingPos[i].x == line && this.HattingPos[i].y == row) {\n                        this.hammers[i].node.active = false;\n                        // this.smCallback(i);\n\n                        this.destroyBlock(line, row);\n                        this.setSmPosition(i);\n                        find = true;\n                        break;\n                    }\n                }\n            }\n            if (!find) {\n                this.destroyBlock(line, row);\n            }\n        }\n        // this.changeBlockLead(true);\n    },\n    touchStartCallBack: function (location1) {\n\n        if (!this.canTouch) {\n            return;\n        }\n\n        // console.log(\"touchStartCallBack\");\n\n        if (this.gameState == GameState.end) {\n\n            //每打开3次弹出一个插屏广告\n            if(GameConfig.isFBInstantGame()) {\n                if( this.openSecond%3 ==0){\n                    let FBP = require(\"FBPlugin\");\n                    FBP.InterstitialAdAsync();\n                }else if(this.openSecond ==4){//第4个弹出创建icon\n                    let FBP = require(\"FBPlugin\");\n                    FBP.chooseAsync();\n                    this.restart();\n                }else{\n                    let FBP = require(\"FBPlugin\");\n                    let  num = GameUtils.randomInt(0,100);\n                    if(num<70){\n                        FBP.createShortCut();\n                    }\n                }\n\n            }\n            this.restart();\n        }\n\n        if(this.touchState == undefined ||( this.touchState != 'start'  && this.touchState != 'move')){\n            this.touchState = 'start';\n        }else{\n            this.touchState = 'mult';\n        }\n        if(this.touchState == 'mult'){\n            this.motionStreak.node.active = false;\n        }\n        let location= this.gameNode.convertToNodeSpace(location1);\n        this.motionStreak.node.setPositionX(location1.x - this.BaseWidth);\n        this.motionStreak.node.setPositionY(location1.y - this.BaseHeight);\n        this.motionStreak.reset();\n\n    },\n\n    touchCancelCallBack: function (location1) {\n        this.touchState = 'cancle';\n        let location= this.gameNode.convertToNodeSpace(location1);\n        this.updateTouch(location);\n        this.isTouching = false;\n        this.motionStreak.reset();\n        this.motionStreak.node.active = true;\n\n    },\n\n    touchEndCallBack: function (location1) {\n        this.touchState = 'end';\n        let location= this.gameNode.convertToNodeSpace(location1);\n        this.updateTouch(location);\n        this.isTouching = false;\n        // console.log(\"touchEndCallBack\");\n        this.motionStreak.reset();\n        this.previousPt=null;\n        this.motionStreak.node.active = true;\n\n    },\n    touchMoveCallBack: function (location1) {\n        let location= this.gameNode.convertToNodeSpace(location1);\n        if (!this.canTouch) {\n            return;\n        }\n        this.touchState =\"move\";\n        // console.log(\"touchMoveCallBack\");\n        this.motionStreak.node.setPositionX(location1.x - this.BaseWidth);\n        this.motionStreak.node.setPositionY(location1.y - this.BaseHeight);\n        if (location.x < this.margins || location.x > (2 * this.BaseWidth - this.margins\n            || location.y < 216)) {\n            this.motionStreak.reset();\n            return;\n        }\n        this.updateTouch(location);\n        // this.previousPt = location;\n        // let motionpos = this.node.convertToNodeSpace(location1);\n        // this.motionStreak.node.position=motionpos;\n    },\n    //多点触控\n    multMoveCallBack:function(location01,location02 = null){\n        this.touchState =\"mult\";\n        this.motionStreak.reset();\n        let location1 = this.gameNode.convertToNodeSpace(location01);\n        // let location2 = this.gameNode.convertToNodeSpace(location02);\n        // console.log(\"1\",location1);\n        // console.log(\"2\",location2);\n        if(this.previousPt == null){\n            this.previousPt={};\n            this.previousPt[0]= location1;\n            // this.previousPt[1]= location2;\n            return;\n        }\n        var distance = cc.pSub( this.previousPt[0],location1);\n        if(distance.y != 0){\n            let origin = this.camera.node.getPositionY();\n            let endpos =( origin+distance.y)*0.5;\n            if(endpos <0 ){\n                endpos =0;\n            }\n            if(endpos >this.startCameraY){\n                endpos = this.startCameraY;\n            }\n            if(endpos== 0)\n                return;\n            let move = origin - endpos;\n            this.camera.node.setPositionY(endpos);\n        }\n    },\n    //-----------------------------touch   end-------------------------\n    //-----------------------------bottom   start-------------------------\n\n\n\n    eventcallback: function (type, id, string = null) {\n        // let node= this.itemList.indexOf(sender);\n        switch (type) {\n            case 0:\n                this.type0deal(id,string);\n                break;\n            case 1:\n                this.type1deal(id);\n                break;\n            case 2:\n                this.type2deal(id,string);\n                break;\n        }\n    },\n    //----------------- efficiency tools config start----------------------\n\n    type0deal:function(id,string=null){\n        if (string == null){\n            //视频激励\n            if(GameConfig.isFBInstantGame() ){\n                if(id == 1){\n                    this.loadingView.active  = true;\n                    let self = this;\n                    let FBP = require(\"FBPlugin\");\n                    FBP.RewardedVideoAsync(function(){\n                            // let FBP = require(\"FBPlugin\");\n                            // self.adGame();\n                            self.loadingView.active  = false;\n                            self.accleleratorChange(id);\n                        }\n                    );\n                }else{\n                    let FBP = require(\"FBPlugin\");\n                    FBP.chooseAsync(function(){\n                            self.loadingView.active  = false;\n                            self.accleleratorChange(id);\n                        }\n                    );\n\n                }\n            }else{\n                this.accleleratorChange(id);\n            }\n\n        }\n        else {\n            if (string == 'finish') {\n                this.accleleratorrRecover(id);\n            }\n        }\n    },\n\n    //广告加速开始\n    accleleratorChange: function (id) {\n        let conf = AcceleratorConfig[id];\n        Global['bar' + id] = conf.time;\n        this.changeHammerSpeed();\n        this.GameMenuController.updateButtom();\n\n    },\n    //广告加速结束\n    accleleratorrRecover: function (id) {\n        this.changeHammerSpeed();\n        this.GameMenuController.updateButtom();\n    },\n    //----------------- efficiency tools config end----------------------\n    //----------------- hammers tools config start----------------------\n\n    changeHammerSpeed: function () {\n        let speedHammer = 0;\n        let speedGold = 0;\n        for (let i = 1; i <= 2; i++) {\n            if (Global['bar' + i] > 0) {\n                speedHammer += AcceleratorConfig[i].speed;\n                speedGold += AcceleratorConfig[i].coin;\n            }\n        }\n        if (speedHammer == 0) {\n            speedHammer = 1;\n        }\n        if (speedGold == 0) {\n            speedGold = 1;\n        }\n        this.accelerHammer = speedHammer;\n        this.accelerGold = speedGold;\n        for (var i = this.hammerStart; i <= this.hammerEnd; i++) {\n            if (this.hammers[i] != undefined) {\n                let conf1 = AttributeConfig[Global.hammer[i].attribute];\n                this.hammers[i].timeScale = 0.17 * (conf1.att / parseFloat(conf1.time)) * this.accelerHammer;\n                // this.hammers[i].timeScale =  (conf1.att / parseFloat(conf1.time)) * this.accelerHammer;\n            }\n        }\n    },\n    changeGoldSpeed: function () {\n\n    },\n    type1deal: function (id) {\n        let info = ToolConfig[id];\n\n        if (Global.hammer[id] == undefined) {//激活\n            let bool = this.checkCanAdd(id);\n            if (bool) {\n                Global.hammer[id] = {id: id, attribute: info.attribute};\n                Global.saveHammer(Global.hammer);\n                this.addHammer(id);\n                this.setSmPosition(id);\n            } else {\n                this.addAdTime(id);\n            }\n            this.GameMenuController.updateButtom();\n\n        } else {//升级\n            let conf = AttributeConfig[Global.hammer[id].attribute];\n            let mess = {};\n\n            if (conf.costtype = 1001) {\n                Global.gold -= conf.cost;\n                mess['gold'] = Global.gold;\n            } else if (conf.costtype = 1002) {\n                Global.gem -= conf.cost;\n                mess['gem'] = Global.gem;\n            }\n            if (conf.next != -1) {\n                Global.hammer[id].attribute = conf.next;\n                let conf1 = AttributeConfig[conf.next];\n                Global.saveHammer(Global.hammer);\n                this.hammers[id].timeScale = 0.17 * (conf1.att / parseFloat(conf1.time)) * this.accelerHammer;\n                // this.hammers[id].timeScale = (conf1.att / parseFloat(conf1.time)) * this.accelerHammer;\n            }\n            this.GameMenuController.updateDate(mess);\n        }\n    },\n    checkCanAdd: function (id) {\n        let conf = ToolConfig[id];\n        let thisID;\n        let confArry;\n        if (\"unlock\" in conf) {\n            if (conf.unlock.indexOf(\";\") != -1) {\n                confArry = conf.unlock.split(\";\");\n                thisID = confArry[0];\n            } else {\n                thisID = parseInt(conf.unlock);\n            }\n            if (thisID == -1) {\n                return true;\n            }\n            if (thisID == 0) {//点击激活\n                return true;\n            } else if (thisID == 1) {//视频激励\n                return Global.openAdTimes > 0;\n            } else if (thisID == 2) {//等级激活\n                let needlvl = confArry[1];\n                if (Global.level < needlvl) {\n                    return false;\n                } else {\n                    return true;\n                }\n            } else if (thisID == 3) {//邀请好友\n                let inviteFriends;\n                if(GameConfig.isFBInstantGame()){\n                    if(Global.freindsInfo == null || Global.freindsInfo[id] == null){\n                        inviteFriends = 0\n                    }\n                    else{\n                        inviteFriends = Global.freindsInfo[id].length;\n                    }\n                }else{\n                    if(Global.freindsInfo == null || Global.freindsInfo[id] == null){\n                        inviteFriends = 0\n                    }\n                    else{\n                        inviteFriends = Global.freindsInfo[id].length;\n                    }\n                    // inviteFriends = Global.inviteFriends;\n                }\n                if(inviteFriends<confArry[1]){\n                    return false;\n                }else{\n                    return true;\n                }\n\n            }\n        }\n        return false;\n    },\n\n    addAdTime: function (id) {\n        let conf = ToolConfig[id];\n        let thisID;\n        let confArry;\n        let self = this;\n        if (\"unlock\" in conf) {\n            if (conf.unlock.indexOf(\";\") != -1) {\n                confArry = conf.unlock.split(\";\");\n                thisID = confArry[0];\n            } else {\n                thisID = parseInt(conf.unlock);\n            }\n            if (thisID == 1) {//视频激励\n\n                if(GameConfig.isFBInstantGame()){\n                    this.loadingView.active  = true;\n                    let FBP = require(\"FBPlugin\");\n                    FBP.RewardedVideoAsync(function(){\n                        let FBP = require(\"FBPlugin\");\n                            Global.openAdTimes++;\n                            self.adGame();\n                            self.GameMenuController.updateButtom();\n                        }\n                    );\n                }else{\n                    Global.openAdTimes++;\n                    this.loadingView.active  = true;//[change]\n                }\n            } else if (thisID == 3) {//邀请好友\n                let FBP1 = require(\"FBPlugin\");\n                let self = this;\n                if(GameConfig.isFBInstantGame()){\n                    FBP1.chooseAsync(function(friendID){\n                        if(Global.freindsInfo== null){\n                            Global.freindsInfo = {};\n                        }\n                        if( Global.freindsInfo[id] == null){\n                            Global.freindsInfo[id] =[];\n                        }\n                        var find = false;\n                        for(var i = 0;i<Global.freindsInfo[id].length;i++){\n                            let oldFriend = Global.freindsInfo[id];\n                            if(oldFriend ==friendID ){\n                                find= true;\n                                let PopMsgController = require(\"PopMsgController\");\n                                PopMsgController.showMsg(LanguageConfig['10039'][Global.language]);\n                                break;\n                            }\n                        }\n                        if(!find){\n                            Global.freindsInfo[id].push(friendID);\n                            Global.savefreindsInfo(Global.freindsInfo);\n                            // Global.inviteFriends = Global.freindsInfo[id].length;\n                        }\n                        self.GameMenuController.updateButtom();\n                    });\n                }else{\n                    // Global.inviteFriends++;\n                    if(Global.freindsInfo== null){\n                        Global.freindsInfo = {};\n                    }\n                    if( Global.freindsInfo[id] == null){\n                        Global.freindsInfo[id] =[];\n                    }\n                    let friendID = Global.freindsInfo[id].length+1;\n\n                    Global.freindsInfo[id].push(friendID);\n                    Global.savefreindsInfo(Global.freindsInfo);\n                    self.GameMenuController.updateButtom();\n                }\n            }\n        }\n    },\n    //----------------- hammers tools config end----------------------\n    //----------------- accelerate  tools config start----------------------\n\n\n    type2deal: function (id,str = null) {\n        if(str != null){\n            this.efficiencyChange();\n            return;\n        }\n        let conf = EfficiencyConfig[id];\n        let gem = 0;\n        let addgold=0;\n        if (conf.costtype == 1002 && Global.gem >= conf.cost) {//enough gem\n            gem = Global.gem - conf.cost;\n            if (conf.coin > 0) {\n                // this.efficeGold += conf.coin - 1;\n                let timestamp = Date.parse( new Date())/1000;// 以秒为单位\n                Global.efficiency[id] = {'id':id,'timeleft':conf.time,'timestart':timestamp};\n                this.efficiencyChange();\n            }\n            let myinfo = {};\n            if (conf.jumptime > 0) {//jump time\n\n                for(let i=this.hammerStart;i<=this.hammerEnd; i++){\n                    if(Global.hammer[i] != undefined){\n                        let attr = AttributeConfig[Global.hammer[i].attribute];\n                        addgold+=conf.jumptime*60*60/attr.time* attr.att;\n                    }\n                }\n                Global.addgold = addgold;\n                Global.btnType = 'skip';\n                Global.skipID = id;\n                this.upgradView.active= true;\n            }\n        }\n        this.GameMenuController.updateDate({'gem': gem});\n        Global.saveGem(gem);\n        Global.saveEfficiency(Global.efficiency);\n        this.GameMenuController.updateButtom();\n    },\n    //进入游戏计算离线时间 并计算收益\n    initEfficienyInfo:function(){\n        let nowtime= Date.parse( new Date())/1000;// 以秒为单位;\n        let addgold = 0;\n        for (let id in Global.efficiency) {\n            if ( Global.efficiency[id] == null){\n                continue;\n            }\n            let paseTime = (nowtime - Global.efficiency[id].timestart)/60;//以min\n            let conf = EfficiencyConfig[id];\n            let useTime = conf.time - Global.efficiency[id].timeleft;\n            if(paseTime > conf.time) {\n                paseTime = conf.time;\n            }\n            let outlineTime= paseTime - useTime;\n            let timeleft = conf.time - outlineTime - useTime;\n            if(timeleft <=0){\n                Global.efficiency[id] = null;\n            }else{\n                Global.efficiency[id].timeleft = parseInt(timeleft);\n                this.efficeGold += conf.coin - 1;\n            }\n            for(let i=this.hammerStart;i<=this.hammerEnd; i++){\n                if(Global.hammer[i] != undefined){\n                    let attr = AttributeConfig[Global.hammer[i].attribute];\n                    addgold+=conf.coin*outlineTime*60* attr.att/attr.time;\n                }\n            }\n            if(Global.offlinetime<outlineTime){\n                Global.offlinetime = outlineTime;\n            }\n        }\n        Global.saveEfficiency(Global.efficiency);\n        addgold  = parseInt(addgold);\n        if(addgold >0) {\n            Global.addgold = parseInt(addgold);\n            Global.btnType = 'outline';\n            this.upgradView.active = true;\n        }\n    },\n    //收益加速开始/结束\n    efficiencyChange: function () {\n        let addeff=0;\n\n        for( let id in Global.efficiency){\n            if(Global.efficiency[id] == null)\n                continue;\n            let conf = EfficiencyConfig[id];\n            addeff+=conf.coin - 1;\n        }\n        this.efficeGold = addeff;\n        this.GameMenuController.updateButtom();\n    },\n    //----------------- accelerate  tools config start----------------------\n    //-----------------------------bottom   end----------------------------\n    //-----------------------------loading   start----------------------------\n\n    adGame:function () {\n        this.loadingView.active  = false;\n    },\n    //-----------------------------loading   end----------------------------\n    //-----------------------------GM   part start-------------------------\n\n    onClickBtnaddGem() {\n\n        let gem = Global.gem + 100;\n        this.GameMenuController.updateDate({'gem': gem});\n        Global.saveGem(gem);\n        this.GameMenuController.updateButtom();\n    },\n\n    onClickBtnsubGem() {\n\n        let gem = Global.gem - 10 > 0 ? Global.gem - 10 : 0;\n        this.GameMenuController.updateDate({'gem': gem});\n        Global.saveGem(gem);\n        this.GameMenuController.updateButtom();\n    },\n    onClickBtnaddGold() {\n\n        let gold = Global.gold + 100000;\n        this.GameMenuController.updateDate({'gold': gold});\n        Global.saveGold(gold);\n        this.GameMenuController.updateButtom();\n    },\n    onClickBtnsubGold() {\n\n        // let localStorage = require(\"LocalStorage\");\n        // localStorage.get('gold',0,function (data) {\n        //     console.log(\"fb data\",data);\n        // });\n        // return;\n\n        let gold = Global.gold - 10000 > 0 ? Global.gold - 10000 : 0;\n        this.GameMenuController.updateDate({'gold': gold});\n        Global.saveGold(gold);\n        this.GameMenuController.updateButtom();\n    },\n    onClickBtnaddExp() {\n\n\n        // let localStorage = require(\"LocalStorage\");\n        // localStorage.set('gold',1);\n        // return;\n\n        let exp = Global.exp +500000;\n        this.GameMenuController.updateDate({'exp': exp});\n        Global.saveExp(exp);\n        // this.GameMenuController.updateButtom();\n    }\n    ,\n    onClickUnlockAll(){\n        for (var id = this.hammerStart; id <=this.hammerEnd; id++) {\n            let info = ToolConfig[id];\n            if(Global.hammer[id] == undefined){\n                Global.hammer[id] = {id: id, attribute: info.attribute};\n                Global.saveHammer(Global.hammer);\n                this.addHammer(id);\n                this.setSmPosition(id);\n            }\n        }\n    },\n    hardlvlFun:function(){\n        this.hardlvl.string= Global.hard;\n\n    }\n    //-----------------------------GM   part end-------------------------\n});\n//"]}