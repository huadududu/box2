{"version":3,"sources":["InviteItem.js"],"names":["Global","require","InviteConfig","RewardConfig","cc","Class","extends","Component","properties","coinLabel","Label","numLabel","btn","Node","doneNode","claimNode","index","onLoad","updateItem","inviteCon","num","rewardid","rewardCon","toString","coin","string","active","InviteCount","InviteClaim","inviteOK","contextId","FBP","updateCallBackFriendsAsync","now","Date","LocalStorage","key","getUTCFullYear","getUTCDate","getUTCDay","set","bind","errorCallBack","PopMsgController","GameConfig","showMsg","InviteSameTip","onInvite","chooseAsync","onClaim","Coins","syncPlayerInfoToFB"],"mappings":"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","file":"InviteItem.js","sourceRoot":"..\\..\\..\\..\\..\\assets\\src\\model","sourcesContent":["/**\r\n * Created by bing on 18/04/2018.\r\n */\r\n\r\n\r\n\r\nlet Global = require(\"Global\");\r\nlet InviteConfig = require(\"InviteConfig\");\r\nlet RewardConfig = require(\"RewardConfig1\");\r\n\r\ncc.Class({\r\n    extends:cc.Component,\r\n\r\n    properties:{\r\n        coinLabel:cc.Label,\r\n        numLabel:cc.Label,\r\n        btn:cc.Node,\r\n        doneNode:cc.Node,\r\n        claimNode:cc.Node,\r\n        index:0,\r\n    },\r\n\r\n    onLoad:function () {\r\n\r\n    },\r\n    \r\n    updateItem:function(index) {\r\n\r\n        let inviteCon = InviteConfig[\"invite\"][index];\r\n        let num = inviteCon['num'];\r\n        let rewardid = inviteCon['rewardid'];\r\n        let rewardCon = RewardConfig[rewardid.toString()];\r\n        let coin = rewardCon['coin'];\r\n\r\n        this.coinLabel.string =  \"+\" + coin.toString();\r\n        this.claimNode.active = false;\r\n        if(Global.InviteCount>=num){\r\n            this.numLabel.string =  num.toString() +\"/\" + num.toString();\r\n\r\n            this.btn.active = false;\r\n            if(Global.InviteClaim[index]){\r\n                this.claimNode.active = false;\r\n                this.doneNode.active = true;\r\n            }else{\r\n                this.doneNode.active = false;\r\n                this.claimNode.active = true;\r\n            }\r\n\r\n        }else{\r\n            this.numLabel.string =  Global.InviteCount.toString() +\"/\" + num.toString();\r\n            this.btn.active = true;\r\n            this.doneNode.active = false;\r\n        }\r\n    },\r\n\r\n    inviteOK:function (contextId) {\r\n        FBP.updateCallBackFriendsAsync(function () {\r\n            let now = new Date();\r\n            let Global = require(\"Global\");\r\n            let LocalStorage = require(\"LocalStorage\");\r\n            Global.InviteCount++;\r\n            let key = \"invaite\" + now.getUTCFullYear().toString() + '-'+now.getUTCDate().toString() +\"-\"+now.getUTCDay();\r\n            LocalStorage.set(key,Global.InviteCount);\r\n            this.btn.active = false;\r\n            this.claimNode.active = true;\r\n            this.doneNode.active = true;\r\n        }.bind(this))\r\n\r\n    },\r\n\r\n    errorCallBack:function(){\r\n        let PopMsgController = require(\"PopMsgController\");\r\n        let GameConfig = require(\"GameConfig\");\r\n        PopMsgController.showMsg(GameConfig.InviteSameTip);\r\n    },\r\n\r\n    onInvite:function () {\r\n        let FBP = require(\"FBPlugin\");\r\n        FBP.chooseAsync(this.inviteOK.bind(this),this.errorCallBack.bind(this));\r\n    },\r\n    \r\n    onClaim:function () {\r\n        this.btn.active = false;\r\n        this.claimNode.active = false;\r\n        this.doneNode.active = true;\r\n\r\n        let inviteCon = InviteConfig[\"invite\"][index];\r\n        let rewardid = inviteCon['rewardid'];\r\n        let rewardCon = RewardConfig[rewardid.toString()];\r\n        let coin = rewardCon['coin'];\r\n        Global.Coins+=coin;\r\n        Global.syncPlayerInfoToFB();\r\n\r\n    }\r\n});"]}