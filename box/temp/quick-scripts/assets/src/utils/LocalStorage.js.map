{"version":3,"sources":["LocalStorage.js"],"names":["GameConfig","require","module","exports","LC","cc","Class","extends","Object","get","k","defaultv","callback","isFBInstantGame","FBInstant","player","getDataAsync","then","data","v","sys","localStorage","getItem","getMore","moreKeys","defaultData","console","log","set","setDataAsync","setItem","delete","removeItem","instance"],"mappings":";;;;;;AAAA;;;;AAIA,IAAIA,aAAaC,QAAQ,YAAR,CAAjB;;AAGAC,OAAOC,OAAP,GAAmB,YAAY;;AAE3B,QAAIC,KAAKC,GAAGC,KAAH,CAAS;AACdC,iBAAQF,GAAGG,MADG;;AAGdC,aAAK,aAAUC,CAAV,EAAqC;AAAA,gBAAxBC,QAAwB,uEAAb,EAAa;AAAA,gBAAVC,QAAU;;;AAEtC,gBAAGZ,WAAWa,eAAX,EAAH,EAAgC;AAC5BC,0BAAUC,MAAV,CAAiBC,YAAjB,CAA8B,CAACN,CAAD,CAA9B,EACKO,IADL,CACU,UAASC,IAAT,EAAc;AAChB,wBAAI,OAAOA,KAAKR,CAAL,CAAP,KAAmB,WAAvB,EAAoC;AAChCE,iCAASM,KAAKR,CAAL,CAAT;AACH;AACJ,iBALL;AAMH,aAPD,MAOK;;AAED,oBAAIS,IAAId,GAAGe,GAAH,CAAOC,YAAP,CAAoBC,OAApB,CAA4BZ,CAA5B,CAAR;AACA,oBAAG,CAACS,CAAJ,EAAM;AACFA,wBAAIR,QAAJ;AACH;AACD;AACAC,yBAASO,CAAT;AACH;AACJ,SArBa;AAsBdI,iBAAS,iBAAUC,QAAV,EAA4C;AAAA,gBAAxBb,QAAwB,uEAAb,EAAa;AAAA,gBAAVC,QAAU;;AACjD,gBAAGZ,WAAWa,eAAX,EAAH,EAAgC;AAC5B,oBAAIY,cAAgBd,QAApB;AACAe,wBAAQC,GAAR,CAAY,MAAZ,EAAmB,CAACjB,CAAD,CAAnB;AACAI,0BAAUC,MAAV,CAAiBC,YAAjB,CAA8BQ,QAA9B,EACKP,IADL,CACU,UAASC,IAAT,EAAc;AAChBQ,4BAAQC,GAAR,CAAY,aAAZ,EAA0BT,IAA1B;AACA,wBAAGN,QAAH,EAAY;AACR,4BAAI,OAAOM,IAAP,IAAc,WAAlB,EAA+B;AAC3BN,qCAASM,KAAKR,CAAL,CAAT;AACH,yBAFD,MAEK;AACDE,qCAASa,WAAT;AACH;AACJ;AAEJ,iBAXL;AAYH;AACJ,SAvCa;AAwCdG,aAAK,aAAUlB,CAAV,EAAYS,CAAZ,EAAe;;AAEhB,gBAAGnB,WAAWa,eAAX,EAAH,EAAgC;AAC5BC,0BAAUC,MAAV,CAAiBc,YAAjB,CAA8B;AAC1BnB,uBAAES;AADwB,iBAA9B;AAGH,aAJD,MAIK;AACDd,mBAAGe,GAAH,CAAOC,YAAP,CAAoBS,OAApB,CAA4BpB,CAA5B,EAA8BS,CAA9B;AACH;AACJ,SAjDa;;AAmDdY,gBAAO,iBAAUrB,CAAV,EAAa;AACjBL,eAAGe,GAAH,CAAOC,YAAP,CAAoBW,UAApB,CAA+BtB,CAA/B;AACF;;AArDa,KAAT,CAAT;;AA2DA,QAAIuB,WAAW,IAAI7B,EAAJ,EAAf;AACA,WAAO6B,QAAP;AACH,CA/DkB,EAAnB","file":"LocalStorage.js","sourceRoot":"..\\..\\..\\..\\..\\assets\\src\\utils","sourcesContent":["/**\r\n * Created by bing on 02/05/2018.\r\n */\r\n\r\nlet GameConfig = require(\"GameConfig\");\r\n\r\n\r\nmodule.exports  =  function () {\r\n\r\n    let LC = cc.Class({\r\n        extends:cc.Object,\r\n\r\n        get: function (k, defaultv = '',callback) {\r\n\r\n            if(GameConfig.isFBInstantGame()){\r\n                FBInstant.player.getDataAsync([k])\r\n                    .then(function(data){\r\n                        if (typeof data[k] !== 'undefined') {\r\n                            callback(data[k]);\r\n                        }\r\n                    });\r\n            }else{\r\n\r\n                let v = cc.sys.localStorage.getItem(k);\r\n                if(!v){\r\n                    v = defaultv;\r\n                }\r\n                // return v;\r\n                callback(v);\r\n            }\r\n        },\r\n        getMore: function (moreKeys, defaultv = '',callback) {\r\n            if(GameConfig.isFBInstantGame()){\r\n                let defaultData  =  defaultv;\r\n                console.log(\"get \",[k]);\r\n                FBInstant.player.getDataAsync(moreKeys)\r\n                    .then(function(data){\r\n                        console.log('data is get',data);\r\n                        if(callback){\r\n                            if (typeof data!= 'undefined') {\r\n                                callback(data[k]);\r\n                            }else{\r\n                                callback(defaultData);\r\n                            }\r\n                        }\r\n\r\n                    });\r\n            }\r\n        },\r\n        set: function (k,v) {\r\n\r\n            if(GameConfig.isFBInstantGame()){\r\n                FBInstant.player.setDataAsync({\r\n                    k:v\r\n                });\r\n            }else{\r\n                cc.sys.localStorage.setItem(k,v);\r\n            }\r\n        },\r\n       \r\n        delete:function (k) {\r\n           cc.sys.localStorage.removeItem(k);\r\n        }\r\n        \r\n        \r\n    });\r\n\r\n\r\n    let instance = new LC();\r\n    return instance;\r\n}();\r\n\r\n\r\n\r\n"]}