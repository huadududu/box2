{"version":3,"sources":["LocalStorage.js"],"names":["GameConfig","require","module","exports","LC","cc","Class","extends","Object","get","k","defaultv","callback","isFBInstantGame","defaultData","console","log","FBInstant","player","getDataAsync","then","data","v","sys","localStorage","getItem","sc","getMore","moreKeys","backdata","i","length","set","setDataAsync","setItem","delete","removeItem","instance"],"mappings":"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","file":"LocalStorage.js","sourceRoot":"../../../../../assets/src/utils","sourcesContent":["/**\n * Created by bing on 02/05/2018.\n */\n\nlet GameConfig = require(\"GameConfig\");\n\n\nmodule.exports  =  function () {\n\n    let LC = cc.Class({\n        extends:cc.Object,\n\n        get: function (k, defaultv = '',callback) {\n            if(GameConfig.isFBInstantGame()){\n                let defaultData  =  defaultv;\n                console.log(\"get \",[k]);\n                FBInstant.player.getDataAsync([k])\n                    .then(function(data){\n                        console.log('data is get',data);\n                        if(callback){\n                            if (typeof data[k] != 'undefined') {\n                                callback(data[k]);\n                            }else{\n                                callback(defaultData);\n                            }\n                        }\n\n                    });\n            }else{\n\n                let v = cc.sys.localStorage.getItem(k);\n                if( v == null ){\n                    v = defaultv;\n                }\n                this.sc\n                if(callback){\n                    callback(v);\n                }\n                return v;\n            }\n        },\n\n        getMore: function (moreKeys, defaultv = '',callback) {\n            if(GameConfig.isFBInstantGame()){\n                let defaultData  =  defaultv;\n                console.log(\"get moreKeys \",moreKeys);\n                FBInstant.player.getDataAsync(moreKeys)\n                    .then(function(data){\n                        console.log('data is get',data);\n                        if(callback){\n                            if (typeof data!= 'undefined') {\n                                callback(data);\n                            }else{\n                                callback(defaultv);\n                            }\n                        }\n\n                    });\n            }else{\n                var backdata={};\n                for ( let i=0;i< moreKeys.length;i++){\n                    let v = cc.sys.localStorage.getItem(moreKeys[i]);\n                    if(v != null){\n                        backdata[moreKeys[i]] = v;\n                    }\n\n                }\n                callback(backdata);\n            }\n        },\n\n        set: function (k,v) {\n\n            if(GameConfig.isFBInstantGame()){\n                let data = {};\n                data[k] = v;\n                FBInstant.player.setDataAsync(data).then(function() {\n                    console.log('data is set');\n                });\n            }else{\n                cc.sys.localStorage.setItem(k,v);\n            }\n        },\n\n        delete:function (k) {\n            cc.sys.localStorage.removeItem(k);\n        }\n\n\n    });\n\n    let instance = new LC();\n    return instance;\n}();\n\n\n\n"]}